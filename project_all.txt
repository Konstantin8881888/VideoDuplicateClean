__init__.py




__main__.py

"""
VideoDuplicate Cleaner - Main Entry Point
"""
import sys
import os

# Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ Ñ‚ĞµĞºÑƒÑ‰ÑƒÑ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ² Ğ¿ÑƒÑ‚ÑŒ Ğ´Ğ»Ñ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¾Ğ²
sys.path.insert(0, os.path.dirname(__file__))

from core.file_scanner import FileScanner
from core.frame_extractor import FrameExtractor
from core.video_comparator import VideoComparator


def main():
    print("VideoDuplicate Cleaner - ĞšĞ¾Ğ½ÑĞ¾Ğ»ÑŒĞ½Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ")
    print("=" * 50)

    scanner = FileScanner()
    extractor = FrameExtractor()
    comparator = VideoComparator()

    while True:
        print("\nĞ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ:")
        print("1 - ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ² Ğ¿Ğ°Ğ¿ĞºĞµ")
        print("2 - Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ñ‚ÑŒ Ğ´Ğ²Ğ° Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ°")
        print("3 - ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ¿Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ğµ Ğ²Ğ¸Ğ´ĞµĞ¾ Ğ² Ğ¿Ğ°Ğ¿ĞºĞµ")
        print("q - Ğ’Ñ‹Ñ…Ğ¾Ğ´")

        choice = input("Ğ’Ğ°Ñˆ Ğ²Ñ‹Ğ±Ğ¾Ñ€: ").strip()

        if choice == '1':
            folder = input("Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿ÑƒÑ‚ÑŒ Ğº Ğ¿Ğ°Ğ¿ĞºĞµ: ").strip('"\'')
            if os.path.exists(folder):
                videos = scanner.find_video_files(folder)
                print(f"ĞĞ°Ğ¹Ğ´ĞµĞ½Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²: {len(videos)}")
                for video in videos:
                    print(f"  - {video}")
            else:
                print("ĞŸĞ°Ğ¿ĞºĞ° Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ°!")

        elif choice == '2':
            video1 = input("Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿ÑƒÑ‚ÑŒ Ğº Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¼Ñƒ Ğ²Ğ¸Ğ´ĞµĞ¾: ").strip('"\'')
            video2 = input("Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿ÑƒÑ‚ÑŒ ĞºĞ¾ Ğ²Ñ‚Ğ¾Ñ€Ğ¾Ğ¼Ñƒ Ğ²Ğ¸Ğ´ĞµĞ¾: ").strip('"\'')

            if os.path.exists(video1) and os.path.exists(video2):
                result = comparator.compare_videos(video1, video2)
                print(f"Ğ¡Ñ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ: {result['similarity']:.2%}")
            else:
                print("ĞĞ´Ğ¸Ğ½ Ğ¸Ğ· Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½!")

        elif choice == '3':
            folder = input("Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿ÑƒÑ‚ÑŒ Ğº Ğ¿Ğ°Ğ¿ĞºĞµ: ").strip('"\'')
            threshold = float(input("ĞŸĞ¾Ñ€Ğ¾Ğ³ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸ (0.1-1.0): ") or "0.7")

            if os.path.exists(folder):
                videos = scanner.find_video_files(folder)
                similar_pairs = comparator.find_similar_videos(videos, threshold)

                print(f"ĞĞ°Ğ¹Ğ´ĞµĞ½Ğ¾ Ğ¿Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ñ… Ğ¿Ğ°Ñ€: {len(similar_pairs)}")
                for video1, video2, similarity, _ in similar_pairs:
                    print(f"  {os.path.basename(video1)} <-> {os.path.basename(video2)}: {similarity:.2%}")
            else:
                print("ĞŸĞ°Ğ¿ĞºĞ° Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ°!")

        elif choice.lower() == 'q':
            print("Ğ”Ğ¾ ÑĞ²Ğ¸Ğ´Ğ°Ğ½Ğ¸Ñ!")
            break
        else:
            print("ĞĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€!")


if __name__ == "__main__":
    main()


main.py

import sys
import os
import time
from PyQt6.QtWidgets import (
    QApplication, QMainWindow, QPushButton, QVBoxLayout, QWidget, QLabel,
    QFileDialog, QTextEdit, QProgressBar, QTabWidget, QHBoxLayout,
    QLineEdit, QMessageBox
)
from PyQt6.QtCore import QThread, pyqtSignal, QUrl

# Ğ˜Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ñ‹ Ğ½Ğ°ÑˆĞ¸Ñ… Ğ¼Ğ¾Ğ´ÑƒĞ»ĞµĞ¹
from core.file_scanner import FileScanner
from core.frame_extractor import FrameExtractor
from core.optimized_comparator import OptimizedVideoComparator


# =============================================================================
# ĞšĞ›ĞĞ¡Ğ¡Ğ« Ğ”Ğ›Ğ¯ ĞœĞĞĞ“ĞĞŸĞĞ¢ĞĞ§ĞĞĞ¡Ğ¢Ğ˜
# =============================================================================

class OptimizedScanThread(QThread):
    """ĞŸĞ¾Ñ‚Ğ¾Ğº Ğ´Ğ»Ñ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ°Ğ¿ĞºĞ¸"""

    # Ğ¡Ğ¸Ğ³Ğ½Ğ°Ğ»Ñ‹ Ğ´Ğ»Ñ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ UI Ğ¸Ğ· Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ°
    progress_signal = pyqtSignal(int, str)  # Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ (Ğ¿Ñ€Ğ¾Ñ†ĞµĞ½Ñ‚Ñ‹, ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ)
    result_signal = pyqtSignal(list)  # Ñ„Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹
    finished_signal = pyqtSignal()  # Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹

    def __init__(self, comparator, folder_path, similarity_threshold=0.7):
        super().__init__()
        self.comparator = comparator
        self.folder_path = folder_path
        self.similarity_threshold = similarity_threshold
        self.scanner = FileScanner()

    def run(self):
        """ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ÑÑ Ğ² Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞµ"""
        try:
            self.progress_signal.emit(0, "ĞŸĞ¾Ğ¸ÑĞº Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²...")

            # ĞĞ°Ñ…Ğ¾Ğ´Ğ¸Ğ¼ Ğ²ÑĞµ Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ñ‹
            video_files = self.scanner.find_video_files(self.folder_path)

            if not video_files:
                self.result_signal.emit([])
                return

            self.progress_signal.emit(10, f"ĞĞ°Ğ¹Ğ´ĞµĞ½Ğ¾ {len(video_files)} Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²")

            # Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº Ğ¿Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ñ… Ğ²Ğ¸Ğ´ĞµĞ¾
            similar_pairs = self.comparator.find_similar_videos_optimized(
                video_files,
                self.similarity_threshold
            )

            # ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµĞ¼ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ² Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ğ¿Ğ¾Ñ‚Ğ¾Ğº
            self.result_signal.emit(similar_pairs)

        except Exception as e:
            print(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ² Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞµ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ: {e}")
        finally:
            self.finished_signal.emit()


class CompareThread(QThread):
    """ĞŸĞ¾Ñ‚Ğ¾Ğº Ğ´Ğ»Ñ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ğ´Ğ²ÑƒÑ… ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ñ‹Ñ… Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²"""

    result_signal = pyqtSignal(dict)

    def __init__(self, comparator, video1_path, video2_path):
        super().__init__()
        self.comparator = comparator
        self.video1_path = video1_path
        self.video2_path = video2_path

    def run(self):
        result = self.comparator.compare_videos(self.video1_path, self.video2_path)
        self.result_signal.emit(result)


# =============================================================================
# Ğ“Ğ›ĞĞ’ĞĞĞ• ĞĞšĞĞ ĞŸĞ Ğ˜Ğ›ĞĞ–Ğ•ĞĞ˜Ğ¯
# =============================================================================

class MainWindow(QMainWindow):
    def __init__(self):
        super().__init__()
        self.setWindowTitle("VideoDuplicate Cleaner")
        self.setGeometry(100, 100, 900, 700)

        # Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ²
        self.scanner = FileScanner()
        self.frame_extractor = FrameExtractor()
        self.comparator = OptimizedVideoComparator()  # Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½ÑƒÑ Ğ²ĞµÑ€ÑĞ¸Ñ

        # ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ
        self.selected_folder = ""
        self.video1_path = ""
        self.video2_path = ""
        self.current_groups = []
        self.optimized_scan_thread = None
        self.compare_thread = None

        # Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ
        self.setup_ui()

    def setup_ui(self):
        """Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ Ğ²ĞµÑÑŒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ"""
        # Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ²ĞºĞ»Ğ°Ğ´ĞºĞ¸
        self.tabs = QTabWidget()
        self.setCentralWidget(self.tabs)

        # Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ¸ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ Ğ²ĞºĞ»Ğ°Ğ´ĞºĞ¸
        self.scan_tab = self.create_scan_tab()
        self.compare_tab = self.create_compare_tab()

        self.tabs.addTab(self.scan_tab, "ğŸ“ Ğ¡ĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ°Ğ¿ĞºĞ¸")
        self.tabs.addTab(self.compare_tab, "ğŸ” Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ²Ğ¸Ğ´ĞµĞ¾")

    def create_scan_tab(self):
        """Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ Ğ²ĞºĞ»Ğ°Ğ´ĞºÑƒ Ğ´Ğ»Ñ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ°Ğ¿ĞºĞ¸"""
        widget = QWidget()
        layout = QVBoxLayout()
        widget.setLayout(layout)

        # Ğ—Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº
        title_label = QLabel("ĞŸĞ¾Ğ¸ÑĞº Ğ¿Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ñ… Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ² Ğ¿Ğ°Ğ¿ĞºĞµ")
        title_label.setStyleSheet("font-size: 14pt; font-weight: bold;")
        layout.addWidget(title_label)

        # Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ¿Ğ°Ğ¿ĞºĞ¸
        folder_layout = QHBoxLayout()
        self.select_button = QPushButton("Ğ’Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ¿Ğ°Ğ¿ĞºÑƒ Ğ´Ğ»Ñ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ")
        self.select_button.clicked.connect(self.select_folder)
        folder_layout.addWidget(self.select_button)

        self.selected_folder_label = QLabel("ĞŸĞ°Ğ¿ĞºĞ° Ğ½Ğµ Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ°")
        folder_layout.addWidget(self.selected_folder_label)
        layout.addLayout(folder_layout)

        # ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
        settings_layout = QHBoxLayout()

        settings_layout.addWidget(QLabel("ĞŸĞ¾Ñ€Ğ¾Ğ³ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸:"))
        self.similarity_threshold_input = QLineEdit("0.7")
        self.similarity_threshold_input.setMaximumWidth(50)
        settings_layout.addWidget(self.similarity_threshold_input)

        settings_layout.addWidget(QLabel("(0.1 - 1.0, Ğ³Ğ´Ğµ 1.0 = Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ‡Ğ½Ñ‹Ğµ)"))
        settings_layout.addStretch()
        layout.addLayout(settings_layout)

        # ĞšĞ½Ğ¾Ğ¿ĞºĞ° Ğ·Ğ°Ğ¿ÑƒÑĞºĞ° ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
        self.scan_button = QPushButton("ğŸš€ ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğµ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ")
        self.scan_button.clicked.connect(self.start_optimized_scan)
        self.scan_button.setStyleSheet("QPushButton { font-weight: bold; padding: 8px; }")
        layout.addWidget(self.scan_button)

        # ĞŸÑ€Ğ¾Ğ³Ñ€ĞµÑÑ-Ğ±Ğ°Ñ€
        self.progress_bar = QProgressBar()
        self.progress_bar.setVisible(False)
        layout.addWidget(self.progress_bar)

        # ĞŸĞ¾Ğ»Ğµ Ğ´Ğ»Ñ Ğ»Ğ¾Ğ³Ğ¾Ğ² Ğ¸ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²
        self.log_text = QTextEdit()
        self.log_text.setPlaceholderText(
            "Ğ—Ğ´ĞµÑÑŒ Ğ±ÑƒĞ´ÑƒÑ‚ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶Ğ°Ñ‚ÑŒÑÑ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¸ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹...\n\n"
            "ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼:\n"
            "â€¢ Ğ¡Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğ¸Ñ‰ĞµÑ‚ Ñ‚Ğ¾Ñ‡Ğ½Ñ‹Ğµ Ğ´ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ‚Ñ‹ Ğ¿Ğ¾ Ñ…ÑÑˆĞ°Ğ¼\n"
            "â€¢ Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ÑƒĞµÑ‚ Ğ¿Ğ¾ Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼ (Ñ€Ğ°Ğ·Ğ¼ĞµÑ€, Ğ´Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ)\n"
            "â€¢ Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ·Ğ°Ñ‚ĞµĞ¼ Ğ´ĞµĞ»Ğ°ĞµÑ‚ Ğ³Ğ»ÑƒĞ±Ğ¾ĞºĞ¸Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· ĞºĞ°Ğ´Ñ€Ğ¾Ğ²"
        )
        self.log_text.setReadOnly(True)
        layout.addWidget(self.log_text)

        # ĞšĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ´Ğ»Ñ Ğ³Ñ€ÑƒĞ¿Ğ¿ (Ğ±ÑƒĞ´ĞµĞ¼ ÑĞ¾Ğ·Ğ´Ğ°Ğ²Ğ°Ñ‚ÑŒ Ğ´Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¸)
        self.groups_layout = QVBoxLayout()
        layout.addLayout(self.groups_layout)

        # Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑĞ½Ğ°Ñ ÑÑ‚Ñ€Ğ¾ĞºĞ°
        self.status_label = QLabel("Ğ“Ğ¾Ñ‚Ğ¾Ğ² Ğº Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğµ")
        layout.addWidget(self.status_label)

        return widget

    def create_compare_tab(self):
        """Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ Ğ²ĞºĞ»Ğ°Ğ´ĞºÑƒ Ğ´Ğ»Ñ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ğ´Ğ²ÑƒÑ… Ğ²Ğ¸Ğ´ĞµĞ¾"""
        widget = QWidget()
        layout = QVBoxLayout()
        widget.setLayout(layout)

        # Ğ—Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº
        title_label = QLabel("Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ´Ğ²ÑƒÑ… Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²")
        title_label.setStyleSheet("font-size: 14pt; font-weight: bold;")
        layout.addWidget(title_label)

        # Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾
        video1_layout = QHBoxLayout()
        self.select_video1_btn = QPushButton("Ğ’Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ¿ĞµÑ€Ğ²Ğ¾Ğµ Ğ²Ğ¸Ğ´ĞµĞ¾")
        self.select_video1_btn.clicked.connect(lambda: self.select_video_for_comparison(1))
        video1_layout.addWidget(self.select_video1_btn)

        self.video1_label = QLabel("Ğ’Ğ¸Ğ´ĞµĞ¾ Ğ½Ğµ Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ¾")
        video1_layout.addWidget(self.video1_label)
        layout.addLayout(video1_layout)

        # Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ²Ñ‚Ğ¾Ñ€Ğ¾Ğ³Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾
        video2_layout = QHBoxLayout()
        self.select_video2_btn = QPushButton("Ğ’Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ²Ñ‚Ğ¾Ñ€Ğ¾Ğµ Ğ²Ğ¸Ğ´ĞµĞ¾")
        self.select_video2_btn.clicked.connect(lambda: self.select_video_for_comparison(2))
        video2_layout.addWidget(self.select_video2_btn)

        self.video2_label = QLabel("Ğ’Ğ¸Ğ´ĞµĞ¾ Ğ½Ğµ Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ¾")
        video2_layout.addWidget(self.video2_label)
        layout.addLayout(video2_layout)

        # ĞšĞ½Ğ¾Ğ¿ĞºĞ° ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ
        self.compare_btn = QPushButton("ğŸ” Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ñ‚ÑŒ Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ²Ğ¸Ğ´ĞµĞ¾")
        self.compare_btn.clicked.connect(self.compare_selected_videos)
        layout.addWidget(self.compare_btn)

        # Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ
        self.compare_results = QTextEdit()
        self.compare_results.setPlaceholderText("Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾ÑĞ²ÑÑ‚ÑÑ Ğ·Ğ´ĞµÑÑŒ...")
        self.compare_results.setReadOnly(True)
        layout.addWidget(self.compare_results)

        return widget

    # =============================================================================
    # ĞœĞ•Ğ¢ĞĞ”Ğ« Ğ”Ğ›Ğ¯ Ğ’ĞšĞ›ĞĞ”ĞšĞ˜ Ğ¡ĞšĞĞĞ˜Ğ ĞĞ’ĞĞĞ˜Ğ¯
    # =============================================================================

    def select_folder(self):
        """Ğ’Ñ‹Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ Ğ¿Ğ°Ğ¿ĞºÑƒ Ğ´Ğ»Ñ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ"""
        folder = QFileDialog.getExistingDirectory(self, "Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¿Ğ°Ğ¿ĞºÑƒ Ğ´Ğ»Ñ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ")
        if folder:
            self.selected_folder = folder
            self.selected_folder_label.setText(f"Ğ’Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ°: {os.path.basename(folder)}")
            self.log_text.append(f"ğŸ“ Ğ’Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ° Ğ¿Ğ°Ğ¿ĞºĞ°: {folder}")

    def start_optimized_scan(self):
        """Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğµ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ°Ğ¿ĞºĞ¸"""
        if not self.selected_folder:
            self.show_warning("Ğ¡Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¿Ğ°Ğ¿ĞºÑƒ Ğ´Ğ»Ñ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ!")
            return

        # ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ¸ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ğ¿Ğ¾Ñ€Ğ¾Ğ³ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸
        try:
            threshold = float(self.similarity_threshold_input.text())
            if not (0.1 <= threshold <= 1.0):
                raise ValueError("ĞŸĞ¾Ñ€Ğ¾Ğ³ Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ±Ñ‹Ñ‚ÑŒ Ğ¼ĞµĞ¶Ğ´Ñƒ 0.1 Ğ¸ 1.0")
        except ValueError as e:
            self.show_warning(f"ĞĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ñ€Ğ¾Ğ³ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸: {e}")
            return

        # Ğ‘Ğ»Ğ¾ĞºĞ¸Ñ€ÑƒĞµĞ¼ UI Ğ½Ğ° Ğ²Ñ€ĞµĞ¼Ñ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
        self.set_scan_ui_enabled(False)
        self.progress_bar.setVisible(True)
        self.progress_bar.setValue(0)

        # ĞÑ‡Ğ¸Ñ‰Ğ°ĞµĞ¼ Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰Ğ¸Ğµ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ³Ñ€ÑƒĞ¿Ğ¿
        self.clear_group_buttons()

        self.log_text.clear()
        self.log_text.append("ğŸš€ Ğ—ĞĞŸĞ£Ğ¡Ğš ĞĞŸĞ¢Ğ˜ĞœĞ˜Ğ—Ğ˜Ğ ĞĞ’ĞĞĞĞĞ“Ğ Ğ¡ĞšĞĞĞ˜Ğ ĞĞ’ĞĞĞ˜Ğ¯")
        self.log_text.append(f"ğŸ“ ĞŸĞ°Ğ¿ĞºĞ°: {self.selected_folder}")
        self.log_text.append(f"ğŸ¯ ĞŸĞ¾Ñ€Ğ¾Ğ³ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸: {threshold:.0%}")
        self.log_text.append("â”€" * 50)

        # Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ğ¾Ğ¼ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞµ
        self.optimized_scan_thread = OptimizedScanThread(
            self.comparator,
            self.selected_folder,
            threshold
        )
        self.optimized_scan_thread.progress_signal.connect(self.update_optimized_progress)
        self.optimized_scan_thread.result_signal.connect(self.optimized_scan_finished)
        self.optimized_scan_thread.finished_signal.connect(self.scan_thread_finished)
        self.optimized_scan_thread.start()

    def update_optimized_progress(self, value: int, message: str):
        """ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ"""
        self.progress_bar.setValue(value)
        self.status_label.setText(message)
        self.log_text.append(f"âš¡ {message}")

    def optimized_scan_finished(self, results: list):
        """ĞĞ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ"""
        self.log_text.append("\n" + "â•" * 50)
        self.log_text.append("âœ… Ğ¡ĞšĞĞĞ˜Ğ ĞĞ’ĞĞĞ˜Ğ• Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•ĞĞ!")

        if not results:
            self.log_text.append("âŒ ĞŸĞ¾Ñ…Ğ¾Ğ¶Ğ¸Ñ… Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾")
            self.status_label.setText("ĞŸĞ¾Ñ…Ğ¾Ğ¶Ğ¸Ğµ Ğ²Ğ¸Ğ´ĞµĞ¾ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ñ‹")
            return

        # Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€ÑƒĞµĞ¼ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ´Ğ»Ñ ÑƒĞ´Ğ¾Ğ±Ğ½Ğ¾Ğ³Ğ¾ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ
        groups = self._group_similar_videos(results)

        self.log_text.append(f"ğŸ“Š ĞĞ°Ğ¹Ğ´ĞµĞ½Ğ¾ Ğ³Ñ€ÑƒĞ¿Ğ¿ Ğ¿Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ñ… Ğ²Ğ¸Ğ´ĞµĞ¾: {len(groups)}")
        self.log_text.append(f"ğŸ“ˆ Ğ’ÑĞµĞ³Ğ¾ Ğ¿Ğ°Ñ€: {len(results)}")
        self.status_label.setText(f"ĞĞ°Ğ¹Ğ´ĞµĞ½Ğ¾ {len(groups)} Ğ³Ñ€ÑƒĞ¿Ğ¿ Ğ¿Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ñ… Ğ²Ğ¸Ğ´ĞµĞ¾")

        # Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ Ğ³Ñ€ÑƒĞ¿Ğ¿Ñ‹ Ğ´Ğ»Ñ Ğ¿Ğ¾ÑĞ»ĞµĞ´ÑƒÑÑ‰ĞµĞ³Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
        self.current_groups = groups

        # ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ³Ñ€ÑƒĞ¿Ğ¿Ñ‹ Ñ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸ĞµĞ¼ ÑÑ€ĞµĞ´Ğ½ĞµĞ¹ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸
        for i, group in enumerate(groups, 1):
            # Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ÑĞµĞ¼ ÑÑ€ĞµĞ´Ğ½ÑÑ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ Ğ´Ğ»Ñ Ğ³Ñ€ÑƒĞ¿Ğ¿Ñ‹
            total_similarity = 0
            for video_path, similarity in group:
                total_similarity += similarity
            avg_similarity = total_similarity / len(group) if group else 0

            self.log_text.append(f"\nğŸ¬ Ğ“Ğ Ğ£ĞŸĞŸĞ {i} ({len(group)} Ğ²Ğ¸Ğ´ĞµĞ¾, ÑÑ€ĞµĞ´Ğ½ÑÑ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ: {avg_similarity:.1%}):")

            for video_path, similarity in group:
                file_size = os.path.getsize(video_path) / (1024 * 1024)  # Ğ² MB
                self.log_text.append(
                    f"   ğŸ“¹ {os.path.basename(video_path)} ({file_size:.1f} MB, ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ: {similarity:.1%})")

        # Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ´Ğ»Ñ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ğ³Ñ€ÑƒĞ¿Ğ¿ Ñ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ¸ĞµĞ¼ ÑÑ€ĞµĞ´Ğ½ĞµĞ¹ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸
        self.create_group_buttons(groups)

    def create_group_buttons(self, groups):
        """Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ´Ğ»Ñ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ğ³Ñ€ÑƒĞ¿Ğ¿ Ñ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ¸ĞµĞ¼ Ğ¿Ñ€Ğ¾Ñ†ĞµĞ½Ñ‚Ğ° ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸"""
        for i, group in enumerate(groups, 1):
            # Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ÑĞµĞ¼ ÑÑ€ĞµĞ´Ğ½ÑÑ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ Ğ´Ğ»Ñ Ğ³Ñ€ÑƒĞ¿Ğ¿Ñ‹
            total_similarity = 0
            for video_path, similarity in group:
                total_similarity += similarity
            avg_similarity = total_similarity / len(group) if group else 0

            compare_btn = QPushButton(f"ğŸ” Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ñ‚ÑŒ Ğ³Ñ€ÑƒĞ¿Ğ¿Ñƒ {i} (ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ: {avg_similarity:.1%})")
            compare_btn.clicked.connect(lambda checked, idx=i - 1: self.open_group_comparison(idx))
            self.groups_layout.addWidget(compare_btn)

    def clear_group_buttons(self):
        """ĞÑ‡Ğ¸Ñ‰Ğ°ĞµÑ‚ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ³Ñ€ÑƒĞ¿Ğ¿"""
        # Ğ£Ğ´Ğ°Ğ»ÑĞµĞ¼ Ğ²ÑĞµ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ¸Ğ· layout
        for i in reversed(range(self.groups_layout.count())):
            widget = self.groups_layout.itemAt(i).widget()
            if widget is not None:
                widget.deleteLater()

    def open_group_comparison(self, group_index):
        """ĞÑ‚ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ´Ğ»Ñ Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ğ³Ñ€ÑƒĞ¿Ğ¿Ñ‹"""
        if 0 <= group_index < len(self.current_groups):
            group = self.current_groups[group_index]
            video_paths = [video_path for video_path, similarity in group]

            if len(video_paths) >= 2:
                self.open_comparison_dialog(video_paths)
            else:
                self.show_warning("Ğ’ Ğ³Ñ€ÑƒĞ¿Ğ¿Ğµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ ĞºĞ°Ğº Ğ¼Ğ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ 2 Ğ²Ğ¸Ğ´ĞµĞ¾ Ğ´Ğ»Ñ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ")
        else:
            self.show_warning("Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ° Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ°")

    def open_comparison_dialog(self, video_paths):
        """ĞÑ‚ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³ Ğ´Ğ»Ñ side-by-side ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ğ²Ğ¸Ğ´ĞµĞ¾"""
        if len(video_paths) < 2:
            self.show_warning("Ğ”Ğ»Ñ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ğ½ÑƒĞ¶Ğ½Ğ¾ ĞºĞ°Ğº Ğ¼Ğ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ 2 Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ°!")
            return

        try:
            # ĞŸÑ€Ğ¾Ğ±ÑƒĞµĞ¼ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ¿Ğ¾Ğ»Ğ½ÑƒÑ Ğ²ĞµÑ€ÑĞ¸Ñ
            from src.gui.comparison_dialog import ComparisonDialog
            dialog = ComparisonDialog(video_paths, self)
            dialog.exec()
        except Exception as e:
            print(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ğ¸Ğ¸ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ¹ Ğ²ĞµÑ€ÑĞ¸Ğ¸ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ: {e}")
            # Ğ•ÑĞ»Ğ¸ Ğ¿Ğ¾Ğ»Ğ½Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ Ğ½Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚, Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½ÑƒÑ
            try:
                from src.gui.safe_comparison_dialog import SafeComparisonDialog
                self.log_text.append("âš ï¸ Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ñ‹Ğ¹ Ñ€ĞµĞ¶Ğ¸Ğ¼ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ")
                dialog = SafeComparisonDialog(video_paths, self)
                dialog.exec()
            except Exception as e2:
                self.show_warning(f"ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚ÑŒ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ: {e2}")

    def show_simple_comparison(self, video_paths):
        """ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ ÑƒĞ¿Ñ€Ğ¾Ñ‰ĞµĞ½Ğ½Ğ¾Ğµ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ ĞµÑĞ»Ğ¸ Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³ Ğ½Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚"""
        info = "Side-by-Side ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ\n\n"
        info += "Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹:\n"
        for i, path in enumerate(video_paths[:2]):  # Ğ‘ĞµÑ€ĞµĞ¼ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¿ĞµÑ€Ğ²Ñ‹Ğµ 2
            if os.path.exists(path):
                size = os.path.getsize(path) / (1024 * 1024)
                info += f"\n{i + 1}. {os.path.basename(path)}\n"
                info += f"   Ğ Ğ°Ğ·Ğ¼ĞµÑ€: {size:.2f} MB\n"
                info += f"   ĞŸÑƒÑ‚ÑŒ: {path}\n"
            else:
                info += f"\n{i + 1}. Ğ¤ĞĞ™Ğ› ĞĞ• ĞĞĞ™Ğ”Ğ•Ğ: {path}\n"

        self.log_text.append(f"\nğŸ” Ğ¡Ğ ĞĞ’ĞĞ•ĞĞ˜Ğ• Ğ“Ğ Ğ£ĞŸĞŸĞ«:\n{info}")

    def scan_thread_finished(self):
        """Ğ’Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ ĞºĞ¾Ğ³Ğ´Ğ° Ğ¿Ğ¾Ñ‚Ğ¾Ğº ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ğ» Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñƒ"""
        self.set_scan_ui_enabled(True)
        self.progress_bar.setVisible(False)

    def _group_similar_videos(self, results: list) -> list:
        """Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¿Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ğµ Ğ²Ğ¸Ğ´ĞµĞ¾ Ğ² Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ³Ñ€ÑƒĞ¿Ğ¿Ñ‹"""
        groups = []
        used_videos = set()

        for video1, video2, similarity, _ in results:
            # Ğ•ÑĞ»Ğ¸ Ğ¾Ğ±Ğ° Ğ²Ğ¸Ğ´ĞµĞ¾ ÑƒĞ¶Ğµ Ğ² Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ°Ñ…, Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞºĞ°ĞµĞ¼
            if video1 in used_videos and video2 in used_videos:
                continue

            # Ğ˜Ñ‰ĞµĞ¼ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ÑƒÑ Ğ³Ñ€ÑƒĞ¿Ğ¿Ñƒ Ğ´Ğ»Ñ Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ğ¸Ğ· Ğ²Ğ¸Ğ´ĞµĞ¾
            found_group = None
            for group in groups:
                group_videos = [v[0] for v in group]
                if video1 in group_videos or video2 in group_videos:
                    found_group = group
                    break

            # Ğ•ÑĞ»Ğ¸ Ğ³Ñ€ÑƒĞ¿Ğ¿Ñ‹ Ğ½ĞµÑ‚, ÑĞ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ½Ğ¾Ğ²ÑƒÑ
            if found_group is None:
                found_group = []
                groups.append(found_group)

            # Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ Ğ²Ğ¸Ğ´ĞµĞ¾ Ğ² Ğ³Ñ€ÑƒĞ¿Ğ¿Ñƒ ĞµÑĞ»Ğ¸ Ğ¸Ñ… Ñ‚Ğ°Ğ¼ ĞµÑ‰Ğµ Ğ½ĞµÑ‚
            if video1 not in used_videos:
                found_group.append((video1, similarity))
                used_videos.add(video1)

            if video2 not in used_videos:
                found_group.append((video2, similarity))
                used_videos.add(video2)

        return groups

    # =============================================================================
    # ĞœĞ•Ğ¢ĞĞ”Ğ« Ğ”Ğ›Ğ¯ Ğ’ĞšĞ›ĞĞ”ĞšĞ˜ Ğ¡Ğ ĞĞ’ĞĞ•ĞĞ˜Ğ¯
    # =============================================================================

    def select_video_for_comparison(self, video_num: int):
        """Ğ’Ñ‹Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ» Ğ´Ğ»Ñ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ"""
        file_path, _ = QFileDialog.getOpenFileName(
            self,
            f"Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ²Ğ¸Ğ´ĞµĞ¾ Ñ„Ğ°Ğ¹Ğ» #{video_num}",
            "",
            "Video Files (*.mp4 *.avi *.mov *.mkv *.wmv)"
        )

        if file_path:
            if video_num == 1:
                self.video1_path = file_path
                self.video1_label.setText(f"Ğ’Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ¾: {os.path.basename(file_path)}")
            else:
                self.video2_path = file_path
                self.video2_label.setText(f"Ğ’Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ¾: {os.path.basename(file_path)}")

    def compare_selected_videos(self):
        """Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ´Ğ²Ğ° Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ°"""
        if not self.video1_path or not self.video2_path:
            self.show_warning("Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¾Ğ±Ğ° Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ° Ğ´Ğ»Ñ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ!")
            return

        self.compare_results.clear()
        self.compare_results.append("ğŸ”„ ĞĞ°Ñ‡Ğ¸Ğ½Ğ°ĞµĞ¼ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ...")

        # Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ² Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ğ¾Ğ¼ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞµ
        self.compare_thread = CompareThread(self.comparator, self.video1_path, self.video2_path)
        self.compare_thread.result_signal.connect(self.show_comparison_result)
        self.compare_thread.start()

    def show_comparison_result(self, result: dict):
        """ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ğ´Ğ²ÑƒÑ… Ğ²Ğ¸Ğ´ĞµĞ¾"""
        self.compare_results.append("\nğŸ“Š Ğ Ğ•Ğ—Ğ£Ğ›Ğ¬Ğ¢ĞĞ¢Ğ« Ğ¡Ğ ĞĞ’ĞĞ•ĞĞ˜Ğ¯:")
        self.compare_results.append(f"ğŸ¯ ĞĞ±Ñ‰Ğ°Ñ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ: {result['similarity']:.2%}")

        if 'error' in result:
            self.compare_results.append(f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ°: {result['error']}")
            return

        # ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ´ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ¿Ğ¾ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼Ñƒ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²
        for i, comparison in enumerate(result['frame_comparisons'], 1):
            self.compare_results.append(f"\nğŸ” Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ ĞºĞ°Ğ´Ñ€Ğ¾Ğ² #{i}:")
            self.compare_results.append(f"   ĞĞ±Ñ‰Ğ°Ñ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ: {comparison['similarity']:.2%}")

            # Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ¿Ğ¾ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼Ñƒ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ñƒ
            for algo_name, algo_score in comparison['algorithm_details'].items():
                if algo_name != 'overall':
                    self.compare_results.append(f"   - {algo_name}: {algo_score:.2%}")

    # =============================================================================
    # Ğ’Ğ¡ĞŸĞĞœĞĞ“ĞĞ¢Ğ•Ğ›Ğ¬ĞĞ«Ğ• ĞœĞ•Ğ¢ĞĞ”Ğ«
    # =============================================================================

    def set_scan_ui_enabled(self, enabled: bool):
        """Ğ’ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚/Ğ²Ñ‹ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹ UI Ğ²Ğ¾ Ğ²Ñ€ĞµĞ¼Ñ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ"""
        self.scan_button.setEnabled(enabled)
        self.select_button.setEnabled(enabled)
        self.similarity_threshold_input.setEnabled(enabled)

    def show_warning(self, message: str):
        """ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ¿Ñ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´Ğ°ÑÑ‰ĞµĞµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ"""
        QMessageBox.warning(self, "Ğ’Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ", message)

    def refresh_file_list(self):
        """ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ ÑĞ¿Ğ¸ÑĞ¾Ğº Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, Ğ¿Ğ¾ÑĞ»Ğµ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ñ)"""
        self.log_text.append("\nğŸ”„ Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½")

    def closeEvent(self, event):
        """ĞĞ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ"""
        # ĞÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¸ ĞµÑĞ»Ğ¸ Ğ¾Ğ½Ğ¸ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‚
        if self.optimized_scan_thread and self.optimized_scan_thread.isRunning():
            self.optimized_scan_thread.terminate()
            self.optimized_scan_thread.wait()

        if self.compare_thread and self.compare_thread.isRunning():
            self.compare_thread.terminate()
            self.compare_thread.wait()

        event.accept()


# =============================================================================
# Ğ¢ĞĞ§ĞšĞ Ğ’Ğ¥ĞĞ”Ğ Ğ’ ĞŸĞ Ğ˜Ğ›ĞĞ–Ğ•ĞĞ˜Ğ•
# =============================================================================

def main():
    """ĞÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ° Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ"""
    # Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ
    app = QApplication(sys.argv)
    app.setApplicationName("VideoDuplicate Cleaner")
    app.setApplicationVersion("1.0")

    # Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ¸ Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ³Ğ»Ğ°Ğ²Ğ½Ğ¾Ğµ Ğ¾ĞºĞ½Ğ¾
    window = MainWindow()
    window.show()

    # Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ Ñ†Ğ¸ĞºĞ» ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹
    sys.exit(app.exec())


if __name__ == "__main__":
    main()


algorithms\__init__.py

from .base_comparator import BaseComparator
from .histogram_comparator import HistogramComparator
from .phash_comparator import PHashComparator
from .comparison_manager import ComparisonManager

__all__ = ['BaseComparator', 'HistogramComparator', 'PHashComparator', 'ComparisonManager']


algorithms\base_comparator.py

import cv2
import numpy as np
from abc import ABC, abstractmethod
from typing import Dict, Any


class BaseComparator(ABC):
    """Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ ĞºĞ»Ğ°ÑÑ Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ¾Ğ² ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¹"""

    def __init__(self, name: str, weight: float = 1.0):
        self.name = name
        self.weight = weight

    @abstractmethod
    def compare(self, image1: np.ndarray, image2: np.ndarray) -> float:
        """
        Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ´Ğ²Ğ° Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ¸ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ¾Ñ†ĞµĞ½ĞºÑƒ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸ (0-1)
        Ğ³Ğ´Ğµ 1 - Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ‡Ğ½Ñ‹Ğµ, 0 - ÑĞ¾Ğ²ĞµÑ€ÑˆĞµĞ½Ğ½Ğ¾ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ
        """
        pass

    def normalize_image(self, image: np.ndarray, target_size: tuple = (256, 256)) -> np.ndarray:
        """ĞĞ¾Ñ€Ğ¼Ğ°Ğ»Ğ¸Ğ·ÑƒĞµÑ‚ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Ğº ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ğ¾Ğ¼Ñƒ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ñƒ"""
        if len(image.shape) == 3:
            # Ğ¦Ğ²ĞµÑ‚Ğ½Ğ¾Ğµ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ
            return cv2.resize(image, target_size)
        else:
            # Ğ§Ğ‘ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ
            return cv2.resize(image, target_size)


algorithms\comparison_manager.py

from typing import List, Dict
import numpy as np
from .base_comparator import BaseComparator
from .histogram_comparator import HistogramComparator
from .phash_comparator import PHashComparator


class ComparisonManager:
    """Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ²ÑĞµĞ¼Ğ¸ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ°Ğ¼Ğ¸ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ğ¸ Ğ°Ğ³Ñ€ĞµĞ³Ğ¸Ñ€ÑƒĞµÑ‚ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹"""

    def __init__(self):
        self.comparators: List[BaseComparator] = []
        self.setup_comparators()

    def setup_comparators(self):
        """ĞĞ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°ĞµÑ‚ ĞºĞ¾Ğ¼Ğ¿Ğ°Ñ€Ğ°Ñ‚Ğ¾Ñ€Ñ‹ Ñ Ğ²ĞµÑĞ°Ğ¼Ğ¸ Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ"""
        # Ğ’ĞµÑĞ° Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ±ÑƒĞ´ĞµÑ‚ Ğ½Ğ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°Ñ‚ÑŒ Ñ‡ĞµÑ€ĞµĞ· UI Ğ¿Ğ¾Ğ·Ğ¶Ğµ
        self.comparators = [
            HistogramComparator(weight=0.4),  # 40%
            PHashComparator(weight=0.6)  # 60%
        ]

    def compare_images(self, image1: np.ndarray, image2: np.ndarray) -> Dict[str, float]:
        """
        Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ´Ğ²Ğ° Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ²ÑĞµĞ¼Ğ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğ¼Ğ¸ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ°Ğ¼Ğ¸
        Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ ÑĞ»Ğ¾Ğ²Ğ°Ñ€ÑŒ Ñ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ°Ğ¼Ğ¸ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ° Ğ¸ Ğ¾Ğ±Ñ‰Ğ¸Ğ¼ ÑÑ‡ĞµÑ‚Ğ¾Ğ¼
        """
        results = {}
        total_score = 0.0
        total_weight = 0.0

        for comparator in self.comparators:
            try:
                score = comparator.compare(image1, image2)
                results[comparator.name] = score
                total_score += score * comparator.weight
                total_weight += comparator.weight
            except Exception as e:
                print(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ² ĞºĞ¾Ğ¼Ğ¿Ğ°Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğµ {comparator.name}: {e}")
                results[comparator.name] = 0.0

        # Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ÑĞµĞ¼ Ğ¾Ğ±Ñ‰Ğ¸Ğ¹ Ğ²Ğ·Ğ²ĞµÑˆĞµĞ½Ğ½Ñ‹Ğ¹ ÑÑ‡ĞµÑ‚
        if total_weight > 0:
            results['overall'] = total_score / total_weight
        else:
            results['overall'] = 0.0

        return results

    def get_comparator_names(self) -> List[str]:
        """Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ¸Ğ¼ĞµĞ½ Ğ²ÑĞµÑ… ĞºĞ¾Ğ¼Ğ¿Ğ°Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ¾Ğ²"""
        return [comp.name for comp in self.comparators]

    def set_weights(self, weights: Dict[str, float]):
        """Ğ£ÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ²ĞµÑĞ° Ğ´Ğ»Ñ ĞºĞ¾Ğ¼Ğ¿Ğ°Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ¾Ğ²"""
        for comp in self.comparators:
            if comp.name in weights:
                comp.weight = weights[comp.name]


algorithms\histogram_comparator.py

import cv2
import numpy as np
from .base_comparator import BaseComparator


class HistogramComparator(BaseComparator):
    """Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ñ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰ÑŒÑ Ğ³Ğ¸ÑÑ‚Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼ Ğ² HSV Ğ¿Ñ€Ğ¾ÑÑ‚Ñ€Ğ°Ğ½ÑÑ‚Ğ²Ğµ"""

    def __init__(self, weight: float = 1.0):
        super().__init__("Histogram", weight)
        # ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ Ğ´Ğ»Ñ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ñ Ğ³Ğ¸ÑÑ‚Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼
        self.h_bins = 50
        self.s_bins = 50
        self.hist_size = [self.h_bins, self.s_bins]
        self.ranges = [0, 180, 0, 256]  # HSV Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½Ñ‹

    def compare(self, image1: np.ndarray, image2: np.ndarray) -> float:
        """
        Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ´Ğ²Ğ° Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ñ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰ÑŒÑ Ğ³Ğ¸ÑÑ‚Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼ HSV
        Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ¾Ñ†ĞµĞ½ĞºÑƒ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸ Ğ¾Ñ‚ 0 Ğ´Ğ¾ 1
        """
        try:
            # ĞĞ¾Ñ€Ğ¼Ğ°Ğ»Ğ¸Ğ·ÑƒĞµĞ¼ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¹
            image1_norm = self.normalize_image(image1)
            image2_norm = self.normalize_image(image2)

            # ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ² HSV
            hsv1 = cv2.cvtColor(image1_norm, cv2.COLOR_BGR2HSV)
            hsv2 = cv2.cvtColor(image2_norm, cv2.COLOR_BGR2HSV)

            # Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ÑĞµĞ¼ Ğ³Ğ¸ÑÑ‚Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹ Ğ´Ğ»Ñ ĞºĞ°Ğ½Ğ°Ğ»Ğ¾Ğ² H Ğ¸ S
            hist1 = cv2.calcHist([hsv1], [0, 1], None, self.hist_size, self.ranges)
            hist2 = cv2.calcHist([hsv2], [0, 1], None, self.hist_size, self.ranges)

            # ĞĞ¾Ñ€Ğ¼Ğ°Ğ»Ğ¸Ğ·ÑƒĞµĞ¼ Ğ³Ğ¸ÑÑ‚Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹
            cv2.normalize(hist1, hist1, 0, 1, cv2.NORM_MINMAX)
            cv2.normalize(hist2, hist2, 0, 1, cv2.NORM_MINMAX)

            # Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ³Ğ¸ÑÑ‚Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹ Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ¾Ğ¼ ĞºĞ¾Ñ€Ñ€ĞµĞ»ÑÑ†Ğ¸Ğ¸
            similarity = cv2.compareHist(hist1, hist2, cv2.HISTCMP_CORREL)

            # ĞŸÑ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·ÑƒĞµĞ¼ Ğ² Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½ 0-1 (ĞºĞ¾Ñ€Ñ€ĞµĞ»ÑÑ†Ğ¸Ñ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ¾Ñ‚ -1 Ğ´Ğ¾ 1)
            return max(0.0, (similarity + 1) / 2)

        except Exception as e:
            print(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ² HistogramComparator: {e}")
            return 0.0


algorithms\phash_comparator.py

import cv2
import numpy as np
from .base_comparator import BaseComparator


class PHashComparator(BaseComparator):
    """Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ñ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰ÑŒÑ perceptual hashing (pHash)"""

    def __init__(self, weight: float = 1.0, hash_size: int = 16):
        super().__init__("Perceptual Hash", weight)
        self.hash_size = hash_size

    def _compute_phash(self, image: np.ndarray) -> str:
        """Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ÑĞµÑ‚ perceptual hash Ğ´Ğ»Ñ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ"""
        try:
            # ĞĞ¾Ñ€Ğ¼Ğ°Ğ»Ğ¸Ğ·ÑƒĞµĞ¼ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€
            resized = self.normalize_image(image, (self.hash_size, self.hash_size))

            # ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ² grayscale ĞµÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ¾
            if len(resized.shape) == 3:
                gray = cv2.cvtColor(resized, cv2.COLOR_BGR2GRAY)
            else:
                gray = resized

            # Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ÑĞµĞ¼ DCT (Discrete Cosine Transform)
            dct = cv2.dct(np.float32(gray))

            # Ğ‘ĞµÑ€ĞµĞ¼ Ğ²ĞµÑ€Ñ…Ğ½Ğ¸Ğ¹ Ğ»ĞµĞ²Ñ‹Ğ¹ ĞºĞ²Ğ°Ğ´Ñ€Ğ°Ñ‚ 8x8 (Ğ¸Ğ³Ğ½Ğ¾Ñ€Ğ¸Ñ€ÑƒĞµĞ¼ Ğ½Ğ¸Ğ·ĞºĞ¾Ñ‡Ğ°ÑÑ‚Ğ¾Ñ‚Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹)
            dct_roi = dct[:8, :8]

            # Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ÑĞµĞ¼ ÑÑ€ĞµĞ´Ğ½ĞµĞµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ (Ğ¸Ğ³Ğ½Ğ¾Ñ€Ğ¸Ñ€ÑƒÑ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚)
            mean_val = np.mean(dct_roi[1:, 1:])

            # Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ñ…ÑÑˆ: 1 ĞµÑĞ»Ğ¸ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ > ÑÑ€ĞµĞ´Ğ½ĞµĞ³Ğ¾, 0 Ğ¸Ğ½Ğ°Ñ‡Ğµ
            hash_array = dct_roi > mean_val
            hash_str = ''.join(['1' if bit else '0' for row in hash_array for bit in row])

            return hash_str

        except Exception as e:
            print(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğ¸ pHash: {e}")
            return ""

    def compare(self, image1: np.ndarray, image2: np.ndarray) -> float:
        """Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ´Ğ²Ğ° Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ñ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰ÑŒÑ pHash"""
        try:
            hash1 = self._compute_phash(image1)
            hash2 = self._compute_phash(image2)

            if not hash1 or not hash2 or len(hash1) != len(hash2):
                return 0.0

            # Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ÑĞµĞ¼ Ñ€Ğ°ÑÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ¥ÑĞ¼Ğ¼Ğ¸Ğ½Ğ³Ğ°
            hamming_distance = sum(c1 != c2 for c1, c2 in zip(hash1, hash2))

            # ĞŸÑ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·ÑƒĞµĞ¼ Ğ² ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ (0-1)
            max_distance = len(hash1)
            similarity = 1.0 - (hamming_distance / max_distance)

            return max(0.0, similarity)

        except Exception as e:
            print(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ² PHashComparator: {e}")
            return 0.0


algorithms\__pycache__\__init__.cpython-313.pyc

Ñƒ
    Â¦i#  Ğ³                   Ñƒ<   â€¢ S SK Jr  S SKJr  S SKJr  S SKJr  / SQrg)Ğ¹   )ĞªBaseComparator)ĞªHistogramComparator)ĞªPHashComparator)ĞªComparisonManager)r   r   r   r   N)	Ğªbase_comparatorr   Ğªhistogram_comparatorr   Ğªphash_comparatorr   Ğªcomparison_managerr   Ğª__all__Â© Ñƒ    ĞªJF:\Programs\PythonProject\VideoDuplicateCleaner\src\algorithms\__init__.pyĞª<module>r      s   Ñ€Ğ­ +Ğ­ 5Ğ­ -Ğ­ 1Ğ²
[Ğƒr   


algorithms\__pycache__\base_comparator.cpython-313.pyc

Ã³
    gi|  Ã£                   Ã³J   Â• S SK r S SKrS SKJrJr  S SKJrJr   " S S\5      r	g)Ã©    N)ÃšABCÃšabstractmethod)ÃšDictÃšAnyc                   Ã³Â¸   Â• \ rS rSrSrSS\S\4S jjr\S\	R                  S\	R                  S\4S	 j5       rSS
\	R                  S\S\	R                  4S jjrSrg)ÃšBaseComparatorÃ©   uh   ÃÂ‘ÃÂ°ÃÂ·ÃÂ¾ÃÂ²Ã‘Â‹ÃÂ¹ ÃÂºÃÂ»ÃÂ°Ã‘ÂÃ‘Â ÃÂ´ÃÂ»Ã‘Â ÃÂ²Ã‘ÂÃÂµÃ‘Â… ÃÂ°ÃÂ»ÃÂ³ÃÂ¾Ã‘Â€ÃÂ¸Ã‘Â‚ÃÂ¼ÃÂ¾ÃÂ² Ã‘ÂÃ‘Â€ÃÂ°ÃÂ²ÃÂ½ÃÂµÃÂ½ÃÂ¸Ã‘Â ÃÂ¸ÃÂ·ÃÂ¾ÃÂ±Ã‘Â€ÃÂ°ÃÂ¶ÃÂµÃÂ½ÃÂ¸ÃÂ¹ÃšnameÃšweightc                 Ã³   Â• Xl         X l        g )NÂ©r
   r   )Ãšselfr
   r   s      ÃšQF:\Programs\PythonProject\VideoDuplicateCleaner\src\algorithms\base_comparator.pyÃš__init__ÃšBaseComparator.__init__
   s   Â€ Ã˜ÂŒ	Ã˜ÂÃ³    Ãšimage1Ãšimage2Ãšreturnc                 Ã³   Â• g)uÂ·   
ÃÂ¡Ã‘Â€ÃÂ°ÃÂ²ÃÂ½ÃÂ¸ÃÂ²ÃÂ°ÃÂµÃ‘Â‚ ÃÂ´ÃÂ²ÃÂ° ÃÂ¸ÃÂ·ÃÂ¾ÃÂ±Ã‘Â€ÃÂ°ÃÂ¶ÃÂµÃÂ½ÃÂ¸Ã‘Â ÃÂ¸ ÃÂ²ÃÂ¾ÃÂ·ÃÂ²Ã‘Â€ÃÂ°Ã‘Â‰ÃÂ°ÃÂµÃ‘Â‚ ÃÂ¾Ã‘Â†ÃÂµÃÂ½ÃÂºÃ‘Âƒ Ã‘ÂÃ‘Â…ÃÂ¾ÃÂ¶ÃÂµÃ‘ÂÃ‘Â‚ÃÂ¸ (0-1)
ÃÂ³ÃÂ´ÃÂµ 1 - ÃÂ¸ÃÂ´ÃÂµÃÂ½Ã‘Â‚ÃÂ¸Ã‘Â‡ÃÂ½Ã‘Â‹ÃÂµ, 0 - Ã‘ÂÃÂ¾ÃÂ²ÃÂµÃ‘Â€Ã‘ÂˆÃÂµÃÂ½ÃÂ½ÃÂ¾ Ã‘Â€ÃÂ°ÃÂ·ÃÂ½Ã‘Â‹ÃÂµ
NÂ© )r   r   r   s      r   ÃšcompareÃšBaseComparator.compare   s   Â€ Ã° 	r   ÃšimageÃštarget_sizec                 Ã³ÂŒ   Â• [        UR                  5      S:X  a  [        R                  " X5      $ [        R                  " X5      $ )uX   ÃÂÃÂ¾Ã‘Â€ÃÂ¼ÃÂ°ÃÂ»ÃÂ¸ÃÂ·Ã‘ÂƒÃÂµÃ‘Â‚ ÃÂ¸ÃÂ·ÃÂ¾ÃÂ±Ã‘Â€ÃÂ°ÃÂ¶ÃÂµÃÂ½ÃÂ¸ÃÂµ ÃÂº Ã‘ÂÃ‘Â‚ÃÂ°ÃÂ½ÃÂ´ÃÂ°Ã‘Â€Ã‘Â‚ÃÂ½ÃÂ¾ÃÂ¼Ã‘Âƒ Ã‘Â€ÃÂ°ÃÂ·ÃÂ¼ÃÂµÃ‘Â€Ã‘ÂƒÃ©   )ÃšlenÃšshapeÃšcv2Ãšresize)r   r   r   s      r   Ãšnormalize_imageÃšBaseComparator.normalize_image   s3   Â€ Ã¤ÂˆuÂ{Â‰{Ã“Â˜qÃ“ Ã¤Â—:Â’:Â˜eÃ“1Ã1Ã´ Â—:Â’:Â˜eÃ“1Ã1r   r   N)g      Ã°?))Ã©   r$   )Ãš__name__Ãš
__module__Ãš__qualname__Ãš__firstlineno__Ãš__doc__ÃšstrÃšfloatr   r   ÃšnpÃšndarrayr   Ãštupler"   Ãš__static_attributes__r   r   r   r   r      ss   Â† Ã™rÃ±Â˜SÃ° Â¨%Ãµ Ã° Ã°Â˜bÂŸjÂ™jÃ° Â°"Â·*Â±*Ã° Ã€Ã³ Ã³ Ã°Ã±2Â RÂ§ZÂ¡ZÃ° 2Â¸eÃ° 2ÃUWÃ—U_Ã‘U_Ã· 2Ã° 2r   r   )
r    Ãšnumpyr,   Ãšabcr   r   Ãštypingr   r   r   r   r   r   Ãš<module>r3      s   Ã°Ã› 
Ã› ÃŸ #ÃŸ Ã´2ÂSÃµ 2r   


algorithms\__pycache__\comparison_manager.cpython-313.pyc

Ã³
    giÂ’	  Ã£                   Ã³T   Â• S SK JrJr  S SKrSSKJr  SSKJr  SSK	J
r
   " S S5      rg)	Ã©    )ÃšListÃšDictNÃ©   )ÃšBaseComparator)ÃšHistogramComparator)ÃšPHashComparatorc                   Ã³Â˜   Â• \ rS rSrSrS rS rS\R                  S\R                  S\	\
\4   4S jrS\\
   4S	 jrS
\	\
\4   4S jrSrg)ÃšComparisonManagerÃ©   ut   ÃÂ£ÃÂ¿Ã‘Â€ÃÂ°ÃÂ²ÃÂ»Ã‘ÂÃÂµÃ‘Â‚ ÃÂ²Ã‘ÂÃÂµÃÂ¼ÃÂ¸ ÃÂ°ÃÂ»ÃÂ³ÃÂ¾Ã‘Â€ÃÂ¸Ã‘Â‚ÃÂ¼ÃÂ°ÃÂ¼ÃÂ¸ Ã‘ÂÃ‘Â€ÃÂ°ÃÂ²ÃÂ½ÃÂµÃÂ½ÃÂ¸Ã‘Â ÃÂ¸ ÃÂ°ÃÂ³Ã‘Â€ÃÂµÃÂ³ÃÂ¸Ã‘Â€Ã‘ÂƒÃÂµÃ‘Â‚ Ã‘Â€ÃÂµÃÂ·Ã‘ÂƒÃÂ»Ã‘ÂŒÃ‘Â‚ÃÂ°Ã‘Â‚Ã‘Â‹c                 Ã³2   Â• / U l         U R                  5         g )N)ÃšcomparatorsÃšsetup_comparatorsÂ©Ãšselfs    ÃšTF:\Programs\PythonProject\VideoDuplicateCleaner\src\algorithms\comparison_manager.pyÃš__init__ÃšComparisonManager.__init__   s   Â€ Ã˜13ÂˆÃ”Ã˜Ã—Ã‘Ã• Ã³    c                 Ã³2   Â• [        SS9[        SS9/U l        g)uU   ÃÂÃÂ°Ã‘ÂÃ‘Â‚Ã‘Â€ÃÂ°ÃÂ¸ÃÂ²ÃÂ°ÃÂµÃ‘Â‚ ÃÂºÃÂ¾ÃÂ¼ÃÂ¿ÃÂ°Ã‘Â€ÃÂ°Ã‘Â‚ÃÂ¾Ã‘Â€Ã‘Â‹ Ã‘Â ÃÂ²ÃÂµÃ‘ÂÃÂ°ÃÂ¼ÃÂ¸ ÃÂ¿ÃÂ¾ Ã‘ÂƒÃÂ¼ÃÂ¾ÃÂ»Ã‘Â‡ÃÂ°ÃÂ½ÃÂ¸Ã‘ÂgÂšÂ™Â™Â™Â™Â™Ã™?)Ãšweightg333333Ã£?N)r   r   r   r   s    r   r   Ãš#ComparisonManager.setup_comparators   s   Â€ Ã´  Â sÃ‘+ÃœÂ 3Ã‘'Ã°
ÂˆÃ•r   Ãšimage1Ãšimage2Ãšreturnc                 Ã³`  Â• 0 nSnSnU R                    HB  n UR                  X5      nXsUR                  '   XGUR                  -  -  nXVR                  -  nMD     US:Â”  a	  XE-  US'   U$ SUS'   U$ ! [         a4  n[        SUR                   SU 35        SX6R                  '    SnAMÂ•  SnAff = f)uÃ¨   
ÃÂ¡Ã‘Â€ÃÂ°ÃÂ²ÃÂ½ÃÂ¸ÃÂ²ÃÂ°ÃÂµÃ‘Â‚ ÃÂ´ÃÂ²ÃÂ° ÃÂ¸ÃÂ·ÃÂ¾ÃÂ±Ã‘Â€ÃÂ°ÃÂ¶ÃÂµÃÂ½ÃÂ¸Ã‘Â ÃÂ²Ã‘ÂÃÂµÃÂ¼ÃÂ¸ ÃÂ´ÃÂ¾Ã‘ÂÃ‘Â‚Ã‘ÂƒÃÂ¿ÃÂ½Ã‘Â‹ÃÂ¼ÃÂ¸ ÃÂ°ÃÂ»ÃÂ³ÃÂ¾Ã‘Â€ÃÂ¸Ã‘Â‚ÃÂ¼ÃÂ°ÃÂ¼ÃÂ¸
ÃÂ’ÃÂ¾ÃÂ·ÃÂ²Ã‘Â€ÃÂ°Ã‘Â‰ÃÂ°ÃÂµÃ‘Â‚ Ã‘ÂÃÂ»ÃÂ¾ÃÂ²ÃÂ°Ã‘Â€Ã‘ÂŒ Ã‘Â Ã‘Â€ÃÂµÃÂ·Ã‘ÂƒÃÂ»Ã‘ÂŒÃ‘Â‚ÃÂ°Ã‘Â‚ÃÂ°ÃÂ¼ÃÂ¸ ÃÂºÃÂ°ÃÂ¶ÃÂ´ÃÂ¾ÃÂ³ÃÂ¾ ÃÂ°ÃÂ»ÃÂ³ÃÂ¾Ã‘Â€ÃÂ¸Ã‘Â‚ÃÂ¼ÃÂ° ÃÂ¸ ÃÂ¾ÃÂ±Ã‘Â‰ÃÂ¸ÃÂ¼ Ã‘ÂÃ‘Â‡ÃÂµÃ‘Â‚ÃÂ¾ÃÂ¼
g        u'   ÃÂÃ‘ÂˆÃÂ¸ÃÂ±ÃÂºÃÂ° ÃÂ² ÃÂºÃÂ¾ÃÂ¼ÃÂ¿ÃÂ°Ã‘Â€ÃÂ°Ã‘Â‚ÃÂ¾Ã‘Â€ÃÂµ z: Nr   Ãšoverall)r   ÃšcompareÃšnamer   Ãš	ExceptionÃšprint)	r   r   r   ÃšresultsÃštotal_scoreÃštotal_weightÃš
comparatorÃšscoreÃšes	            r   Ãšcompare_imagesÃš ComparisonManager.compare_images   sÃ   Â€ Ã°
 ÂˆÃ˜ÂˆÃ˜ÂˆÃ Ã—*Ã”*ÂˆJÃ°/Ã˜"Ã—*Ã‘*Â¨6Ã“:ÂÃ˜+0Â˜
ÂŸÂ™Ã‘(Ã˜Â zÃ—'8Ã‘'8Ã‘8Ã‘8ÂÃ˜Ã— 1Ã‘ 1Ã‘1Â’Ã± +Ã° Â˜!Ã“Ã˜!,Ã‘!;ÂˆGÂIÃ‘Ã° ÂˆÃ° "%ÂˆGÂIÃ‘Ã ÂˆÃ¸Ã´ Ã³ /ÃœÃ?Ã€
Ã‡ÃÃ?PÃPRÃSTÃRUÃVÃ”WÃ˜+.ÂÂŸÂ™Ã—(Ã»Ã°/Ãºs   Â—>A/Ã/
B-Ã9)B(Ã‚(B-c                 Ã³X   Â• U R                    Vs/ s H  oR                  PM     sn$ s  snf )uL   ÃÂ’ÃÂ¾ÃÂ·ÃÂ²Ã‘Â€ÃÂ°Ã‘Â‰ÃÂ°ÃÂµÃ‘Â‚ Ã‘ÂÃÂ¿ÃÂ¸Ã‘ÂÃÂ¾ÃÂº ÃÂ¸ÃÂ¼ÃÂµÃÂ½ ÃÂ²Ã‘ÂÃÂµÃ‘Â… ÃÂºÃÂ¾ÃÂ¼ÃÂ¿ÃÂ°Ã‘Â€ÃÂ°Ã‘Â‚ÃÂ¾Ã‘Â€ÃÂ¾ÃÂ²)r   r   )r   Ãšcomps     r   Ãšget_comparator_namesÃš&ComparisonManager.get_comparator_names2   s$   Â€ Ã &*Ã—&6Ã’&6Ã“7Ã’&6Â˜dÂ—	Â”	Ã‘&6Ã‘7Ã7Ã¹Ã’7s   Â'Ãšweightsc                 Ã³t   Â• U R                    H(  nUR                  U;   d  M  XR                     Ul        M*     g)uC   ÃÂ£Ã‘ÂÃ‘Â‚ÃÂ°ÃÂ½ÃÂ°ÃÂ²ÃÂ»ÃÂ¸ÃÂ²ÃÂ°ÃÂµÃ‘Â‚ ÃÂ²ÃÂµÃ‘ÂÃÂ° ÃÂ´ÃÂ»Ã‘Â ÃÂºÃÂ¾ÃÂ¼ÃÂ¿ÃÂ°Ã‘Â€ÃÂ°Ã‘Â‚ÃÂ¾Ã‘Â€ÃÂ¾ÃÂ²N)r   r   r   )r   r-   r*   s      r   Ãšset_weightsÃšComparisonManager.set_weights6   s,   Â€ Ã Ã—$Ã”$ÂˆDÃ˜ÂyÂ‰yÂ˜GÃ•#Ã˜%Â§iÂ¡iÃ‘0ÂÂ–Ã² %r   )r   N)Ãš__name__Ãš
__module__Ãš__qualname__Ãš__firstlineno__Ãš__doc__r   r   ÃšnpÃšndarrayr   ÃšstrÃšfloatr'   r   r+   r/   Ãš__static_attributes__Â© r   r   r
   r
      s`   Â† Ã™~Ã²!Ã²
Ã°Â RÂ§ZÂ¡ZÃ° Â¸Â¿Â¹Ã° ÃˆÃˆSÃRWÃˆZÃ‘HXÃ´ Ã°68Â dÂ¨3Â¡iÃ´ 8Ã°1Â 4Â¨Â¨UÂ¨
Ã‘#3Ã· 1r   r
   )Ãštypingr   r   Ãšnumpyr6   Ãšbase_comparatorr   Ãšhistogram_comparatorr   Ãšphash_comparatorr   r
   r;   r   r   Ãš<module>rA      s   Ã°ÃŸ Ã› Ã +Ã 5Ã -Ã·21Ã² 21r   


algorithms\__pycache__\histogram_comparator.cpython-313.pyc

Ã³
    ix  Ã£                   Ã³6   Â• S SK r S SKrSSKJr   " S S\5      rg)Ã©    NÃ©   )ÃšBaseComparatorc                   Ã³v   ^ Â• \ rS rSrSrS
S\4U 4S jjjrS\R                  S\R                  S\4S jr	S	r
U =r$ )ÃšHistogramComparatorÃ©   ur   ÃÂ¡Ã‘Â€ÃÂ°ÃÂ²ÃÂ½ÃÂ¸ÃÂ²ÃÂ°ÃÂµÃ‘Â‚ ÃÂ¸ÃÂ·ÃÂ¾ÃÂ±Ã‘Â€ÃÂ°ÃÂ¶ÃÂµÃÂ½ÃÂ¸Ã‘Â Ã‘Â ÃÂ¿ÃÂ¾ÃÂ¼ÃÂ¾Ã‘Â‰Ã‘ÂŒÃ‘Â ÃÂ³ÃÂ¸Ã‘ÂÃ‘Â‚ÃÂ¾ÃÂ³Ã‘Â€ÃÂ°ÃÂ¼ÃÂ¼ ÃÂ² HSV ÃÂ¿Ã‘Â€ÃÂ¾Ã‘ÂÃ‘Â‚Ã‘Â€ÃÂ°ÃÂ½Ã‘ÂÃ‘Â‚ÃÂ²ÃÂµÃšweightc                 Ã³Â   >Â• [         TU ]  SU5        SU l        SU l        U R                  U R                  /U l        / SQU l        g )NÃš	HistogramÃ©2   )r   Ã©Â´   r   Ã©   )ÃšsuperÃš__init__Ãšh_binsÃšs_binsÃš	hist_sizeÃšranges)Ãšselfr   Ãš	__class__s     Â€ÃšVF:\Programs\PythonProject\VideoDuplicateCleaner\src\algorithms\histogram_comparator.pyr   ÃšHistogramComparator.__init__	   s;   Ã¸Â€ ÃœÂ‰Ã‘Â˜Â fÃ”-Ã ÂˆÂŒÃ˜ÂˆÂŒÃ˜ÂŸ+Â™+Â tÂ§{Â¡{Ã3ÂˆÂŒÃš&ÂˆÂÃ³    Ãšimage1Ãšimage2Ãšreturnc                 Ã³Ã´  Â•  U R                  U5      nU R                  U5      n[        R                  " U[        R                  5      n[        R                  " U[        R                  5      n[        R                  " U/SS/SU R
                  U R                  5      n[        R                  " U/SS/SU R
                  U R                  5      n[        R                  " XwSS[        R                  5        [        R                  " XÂˆSS[        R                  5        [        R                  " Xx[        R                  5      n	[        SU	S-   S-  5      $ ! [         a  n
[        SU
 35         Sn
A
gSn
A
ff = f)uÂ    
ÃÂ¡Ã‘Â€ÃÂ°ÃÂ²ÃÂ½ÃÂ¸ÃÂ²ÃÂ°ÃÂµÃ‘Â‚ ÃÂ´ÃÂ²ÃÂ° ÃÂ¸ÃÂ·ÃÂ¾ÃÂ±Ã‘Â€ÃÂ°ÃÂ¶ÃÂµÃÂ½ÃÂ¸Ã‘Â Ã‘Â ÃÂ¿ÃÂ¾ÃÂ¼ÃÂ¾Ã‘Â‰Ã‘ÂŒÃ‘Â ÃÂ³ÃÂ¸Ã‘ÂÃ‘Â‚ÃÂ¾ÃÂ³Ã‘Â€ÃÂ°ÃÂ¼ÃÂ¼ HSV
ÃÂ’ÃÂ¾ÃÂ·ÃÂ²Ã‘Â€ÃÂ°Ã‘Â‰ÃÂ°ÃÂµÃ‘Â‚ ÃÂ¾Ã‘Â†ÃÂµÃÂ½ÃÂºÃ‘Âƒ Ã‘ÂÃ‘Â…ÃÂ¾ÃÂ¶ÃÂµÃ‘ÂÃ‘Â‚ÃÂ¸ ÃÂ¾Ã‘Â‚ 0 ÃÂ´ÃÂ¾ 1
r   r   Ng        Ã©   u%   ÃÂÃ‘ÂˆÃÂ¸ÃÂ±ÃÂºÃÂ° ÃÂ² HistogramComparator: )Ãšnormalize_imageÃšcv2ÃšcvtColorÃšCOLOR_BGR2HSVÃšcalcHistr   r   Ãš	normalizeÃšNORM_MINMAXÃšcompareHistÃšHISTCMP_CORRELÃšmaxÃš	ExceptionÃšprint)r   r   r   Ãšimage1_normÃšimage2_normÃšhsv1Ãšhsv2Ãšhist1Ãšhist2Ãš
similarityÃšes              r   ÃšcompareÃšHistogramComparator.compare   s   Â€ Ã°
	Ã Ã—.Ã‘.Â¨vÃ“6ÂˆKÃ˜Ã—.Ã‘.Â¨vÃ“6ÂˆKÃ´ Â—<Â’<Â Â¬SÃ—->Ã‘->Ã“?ÂˆDÃœÂ—<Â’<Â Â¬SÃ—->Ã‘->Ã“?ÂˆDÃ´ Â—LÂ’LÂ $Â Â¨!Â¨QÂ¨Â°Â°tÂ·~Â±~Ã€tÃ‡{Ã{Ã“SÂˆEÃœÂ—LÂ’LÂ $Â Â¨!Â¨QÂ¨Â°Â°tÂ·~Â±~Ã€tÃ‡{Ã{Ã“SÂˆEÃ´ ÂMÂŠMÂ˜%Â¨Â¨1Â¬cÂ¯oÂ©oÃ”>ÃœÂMÂŠMÂ˜%Â¨Â¨1Â¬cÂ¯oÂ©oÃ”>Ã´ ÂŸÂšÂ¨Â´sÃ—7IÃ‘7IÃ“JÂˆJÃ´ ÂsÂ˜ZÂ¨!Â™^Â¨qÃ‘0Ã“1Ã1Ã¸Ã¤Ã³ 	ÃœÃ9Â¸!Â¸Ã=Ã”>ÃœÃ»Ã°	Ãºs   Â‚EE Ã…
E7Ã…E2Ã…2E7)r   r   r   r   )g      Ã°?)Ãš__name__Ãš
__module__Ãš__qualname__Ãš__firstlineno__Ãš__doc__Ãšfloatr   ÃšnpÃšndarrayr2   Ãš__static_attributes__Ãš__classcell__)r   s   @r   r   r      s>   Ã¸Â† Ã™|Ã±'Â˜uÃ· 'Ã° 'Ã°Â˜bÂŸjÂ™jÃ° Â°"Â·*Â±*Ã° Ã€Ã· Ã² r   r   )r   Ãšnumpyr:   Ãšbase_comparatorr   r   Â© r   r   Ãš<module>rA      s   Ã°Ã› 
Ã› Ã +Ã´)Â˜.Ãµ )r   


algorithms\__pycache__\phash_comparator.cpython-313.pyc

Ã³
    ?i;
  Ã£                   Ã³6   Â• S SK r S SKrSSKJr   " S S\5      rg)Ã©    NÃ©   )ÃšBaseComparatorc                   Ã³Â    ^ Â• \ rS rSrSrSS\S\4U 4S jjjrS\R                  S\
4S jrS	\R                  S
\R                  S\4S jrSrU =r$ )ÃšPHashComparatorÃ©   uX   ÃÂ¡Ã‘Â€ÃÂ°ÃÂ²ÃÂ½ÃÂ¸ÃÂ²ÃÂ°ÃÂµÃ‘Â‚ ÃÂ¸ÃÂ·ÃÂ¾ÃÂ±Ã‘Â€ÃÂ°ÃÂ¶ÃÂµÃÂ½ÃÂ¸Ã‘Â Ã‘Â ÃÂ¿ÃÂ¾ÃÂ¼ÃÂ¾Ã‘Â‰Ã‘ÂŒÃ‘Â perceptual hashing (pHash)ÃšweightÃš	hash_sizec                 Ã³2   >Â• [         TU ]  SU5        X l        g )NzPerceptual Hash)ÃšsuperÃš__init__r	   )Ãšselfr   r	   Ãš	__class__s      Â€ÃšRF:\Programs\PythonProject\VideoDuplicateCleaner\src\algorithms\phash_comparator.pyr   ÃšPHashComparator.__init__	   s   Ã¸Â€ ÃœÂ‰Ã‘Ã*Â¨FÃ”3Ã˜"ÂÃ³    ÃšimageÃšreturnc                 Ã³H  Â•  U R                  XR                  U R                  45      n[        UR                  5      S:X  a&  [        R
                  " U[        R                  5      nOUn[        R                  " [        R                  " U5      5      nUSS2SS24   n[        R                  " USS2SS24   5      nXV:Â„  nSR                  U VV	s/ s H  oÂˆ  H  oÂ™(       a  SOSPM     M     sn	n5      n
U
$ s  sn	nf ! [         a  n[        SU 35         SnAgSnAff = f)	u@   ÃÂ’Ã‘Â‹Ã‘Â‡ÃÂ¸Ã‘ÂÃÂ»Ã‘ÂÃÂµÃ‘Â‚ perceptual hash ÃÂ´ÃÂ»Ã‘Â ÃÂ¸ÃÂ·ÃÂ¾ÃÂ±Ã‘Â€ÃÂ°ÃÂ¶ÃÂµÃÂ½ÃÂ¸Ã‘ÂÃ©   NÃ©   r   Ãš Ãš1Ãš0u0   ÃÂÃ‘ÂˆÃÂ¸ÃÂ±ÃÂºÃÂ° ÃÂ¿Ã‘Â€ÃÂ¸ ÃÂ²Ã‘Â‹Ã‘Â‡ÃÂ¸Ã‘ÂÃÂ»ÃÂµÃÂ½ÃÂ¸ÃÂ¸ pHash: )Ãšnormalize_imager	   ÃšlenÃšshapeÃšcv2ÃšcvtColorÃšCOLOR_BGR2GRAYÃšdctÃšnpÃšfloat32ÃšmeanÃšjoinÃš	ExceptionÃšprint)r   r   ÃšresizedÃšgrayr    Ãšdct_roiÃšmean_valÃš
hash_arrayÃšrowÃšbitÃšhash_strÃšes               r   Ãš_compute_phashÃšPHashComparator._compute_phash   s  Â€ Ã°	Ã Ã—*Ã‘*Â¨5Â·>Â±>Ã€4Ã‡>Ã>Ã2RÃ“SÂˆGÃ´ Â7Â—=Â‘=Ã“!Â QÃ“&ÃœÂ—|Â’|Â GÂ¬SÃ—-?Ã‘-?Ã“@Â‘Ã ÂÃ´ Â—'Â’'Âœ"ÂŸ*Âš*Â TÃ“*Ã“+ÂˆCÃ° Â˜"Â˜1Â˜"Â˜bÂ˜qÂ˜bÂ˜&Â‘kÂˆGÃ´ Â—wÂ’wÂ˜wÂ qÂ¡rÂ¨1Â©2Â vÂ™Ã“/ÂˆHÃ° !Ã‘+ÂˆJÃ˜Â—wÂ‘wÂ¹zÃ”YÂºzÂ¸Ã“UXÃˆcÂ¥sÂ¡Â°Ã’ 3Ã‘UXÃ‘ 3Â¹zÃ’YÃ“ZÂˆHÃ ÂˆOÃ¹Ã³  ZÃ¸Ã´ Ã³ 	ÃœÃDÃ€QÃ€CÃHÃ”IÃœÃ»Ã°	Ãºs*   Â‚CC? ÃƒC9
Ãƒ/	C? Ãƒ9C? Ãƒ?
D!Ã„	DÃ„D!Ãšimage1Ãšimage2c                 Ã³R  Â•  U R                  U5      nU R                  U5      nU(       a  U(       a  [        U5      [        U5      :w  a  g[        S [        X45       5       5      n[        U5      nSXV-  -
  n[	        SU5      $ ! [
         a  n[        SU 35         SnAgSnAff = f)uJ   ÃÂ¡Ã‘Â€ÃÂ°ÃÂ²ÃÂ½ÃÂ¸ÃÂ²ÃÂ°ÃÂµÃ‘Â‚ ÃÂ´ÃÂ²ÃÂ° ÃÂ¸ÃÂ·ÃÂ¾ÃÂ±Ã‘Â€ÃÂ°ÃÂ¶ÃÂµÃÂ½ÃÂ¸Ã‘Â Ã‘Â ÃÂ¿ÃÂ¾ÃÂ¼ÃÂ¾Ã‘Â‰Ã‘ÂŒÃ‘Â pHashg        c              3   Ã³.   #   Â• U  H  u  pX:g  v Â•  M     g 7f)NÂ© )Ãš.0Ãšc1Ãšc2s      r   Ãš	<genexpr>Ãš*PHashComparator.compare.<locals>.<genexpr>6   s   Ã© Â€ Ã"LÃ’:KÂ±Â°Â 2Â¦8Ã’:KÃ¹s   Â‚Ã§      Ã°?u!   ÃÂÃ‘ÂˆÃÂ¸ÃÂ±ÃÂºÃÂ° ÃÂ² PHashComparator: N)r0   r   ÃšsumÃšzipÃšmaxr%   r&   )	r   r2   r3   Ãšhash1Ãšhash2Ãšhamming_distanceÃšmax_distanceÃš
similarityr/   s	            r   ÃšcompareÃšPHashComparator.compare,   sÂŸ   Â€ Ã°	Ã˜Ã—'Ã‘'Â¨Ã“/ÂˆEÃ˜Ã—'Ã‘'Â¨Ã“/ÂˆEÃ¦Â¦Â¬Â¨UÂ«Â´sÂ¸5Â³zÃ“)AÃ˜Ã´  #Ã‘"LÂ¼#Â¸eÃ”:KÃ“"LÃ“LÃÃ´ Â˜uÂ›:ÂˆLÃ˜Ã 0Ã‘ ?Ã‘@ÂˆJÃ¤ÂsÂ˜JÃ“'Ã'Ã¸Ã¤Ã³ 	ÃœÃ5Â°aÂ°SÃ9Ã”:ÃœÃ»Ã°	Ãºs   Â‚AB Ã8B Ã‚
B&Ã‚B!Ã‚!B&)r	   )r<   Ã©   )Ãš__name__Ãš
__module__Ãš__qualname__Ãš__firstlineno__Ãš__doc__ÃšfloatÃšintr   r!   ÃšndarrayÃšstrr0   rE   Ãš__static_attributes__Ãš__classcell__)r   s   @r   r   r      s\   Ã¸Â† Ã™bÃ±#Â˜uÃ° #Â°sÃ· #Ã° #Ã°Â BÂ§JÂ¡JÃ° Â°3Ã´ Ã°>Â˜bÂŸjÂ™jÃ° Â°"Â·*Â±*Ã° Ã€Ã· Ã² r   r   )r   Ãšnumpyr!   Ãšbase_comparatorr   r   r6   r   r   Ãš<module>rU      s   Ã°Ã› 
Ã› Ã +Ã´:ÂnÃµ :r   


core\__init__.py

from .file_scanner import FileScanner
from .frame_extractor import FrameExtractor
from .video_comparator import VideoComparator

__all__ = ['FileScanner', 'FrameExtractor', 'VideoComparator']


core\file_scanner.py

import os
from typing import List


class FileScanner:
    def __init__(self):
        self.supported_formats = {'.mp4', '.avi', '.mov', '.mkv', '.wmv'}

    def find_video_files(self, directory: str) -> List[str]:
        """
        ĞĞ°Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ²ÑĞµ Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ² ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ğ¿Ğ°Ğ¿ĞºĞµ Ğ¸ Ğ¿Ğ¾Ğ´Ğ¿Ğ°Ğ¿ĞºĞ°Ñ…
        """
        video_files = []

        try:
            for root, dirs, files in os.walk(directory):
                for file in files:
                    file_ext = os.path.splitext(file)[1].lower()
                    if file_ext in self.supported_formats:
                        full_path = os.path.join(root, file)
                        video_files.append(full_path)
        except Exception as e:
            print(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¸ Ğ¿Ğ°Ğ¿ĞºĞ¸: {e}")

        return video_files

    def get_file_info(self, file_path: str) -> dict:
        """
        ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ Ğ±Ğ°Ğ·Ğ¾Ğ²ÑƒÑ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğµ
        """
        try:
            stat = os.stat(file_path)
            return {
                'size': stat.st_size,
                'modified': stat.st_mtime,
                'path': file_path
            }
        except Exception as e:
            print(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğ¸ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸ Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğµ {file_path}: {e}")
            return {}


core\frame_extractor.py

import cv2
import os
from typing import List, Optional
import numpy as np


class FrameExtractor:
    def __init__(self):
        self.supported_formats = {'.mp4', '.avi', '.mov', '.mkv', '.wmv'}

    def extract_frames(self, video_path: str, num_frames: int = 10) -> List[np.ndarray]:
        """
        Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµÑ‚ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ½Ğ¾Ğµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ĞºĞ°Ğ´Ñ€Ğ¾Ğ² Ğ¸Ğ· Ğ²Ğ¸Ğ´ĞµĞ¾, Ñ€Ğ°Ğ²Ğ½Ğ¾Ğ¼ĞµÑ€Ğ½Ğ¾ Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ½Ñ‹Ñ… Ğ¿Ğ¾ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸

        Args:
            video_path: Ğ¿ÑƒÑ‚ÑŒ Ğº Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ñƒ
            num_frames: ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ĞºĞ°Ğ´Ñ€Ğ¾Ğ² Ğ´Ğ»Ñ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ñ

        Returns:
            Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº ĞºĞ°Ğ´Ñ€Ğ¾Ğ² Ğ² Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğµ numpy arrays
        """
        frames = []

        try:
            # ĞÑ‚ĞºÑ€Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»
            cap = cv2.VideoCapture(video_path)

            if not cap.isOpened():
                print(f"ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»: {video_path}")
                return frames

            # ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ¾Ğ±Ñ‰ĞµĞµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ĞºĞ°Ğ´Ñ€Ğ¾Ğ² Ğ¸ FPS
            total_frames = int(cap.get(cv2.CAP_PROP_FRAME_COUNT))
            fps = cap.get(cv2.CAP_PROP_FPS)
            duration = total_frames / fps if fps > 0 else 0

            # Ğ•ÑĞ»Ğ¸ Ğ²Ğ¸Ğ´ĞµĞ¾ ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¾Ğµ, Ğ±ĞµÑ€ĞµĞ¼ Ğ²ÑĞµ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğµ ĞºĞ°Ğ´Ñ€Ñ‹
            if total_frames <= num_frames:
                for i in range(total_frames):
                    cap.set(cv2.CAP_PROP_POS_FRAMES, i)
                    ret, frame = cap.read()
                    if ret:
                        frames.append(frame)
            else:
                # Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ÑĞµĞ¼ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸ Ğ´Ğ»Ñ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ñ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²
                frame_positions = np.linspace(0, total_frames - 1, num_frames, dtype=int)

                for pos in frame_positions:
                    cap.set(cv2.CAP_PROP_POS_FRAMES, pos)
                    ret, frame = cap.read()
                    if ret:
                        frames.append(frame)

            cap.release()

        except Exception as e:
            print(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğ¸ ĞºĞ°Ğ´Ñ€Ğ¾Ğ² Ğ¸Ğ· {video_path}: {e}")

        return frames

    def extract_and_save_frames(self, video_path: str, output_dir: str, num_frames: int = 10) -> List[str]:
        """
        Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµÑ‚ ĞºĞ°Ğ´Ñ€Ñ‹ Ğ¸ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ Ğ¸Ñ… Ğ² Ñ„Ğ°Ğ¹Ğ»Ñ‹ (Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸)
        """
        frames = self.extract_frames(video_path, num_frames)
        saved_paths = []

        for i, frame in enumerate(frames):
            filename = f"frame_{i}_{os.path.basename(video_path)}.jpg"
            output_path = os.path.join(output_dir, filename)
            try:
                cv2.imwrite(output_path, frame)
                saved_paths.append(output_path)
            except Exception as e:
                print(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğ¸ ĞºĞ°Ğ´Ñ€Ğ° {i}: {e}")

        return saved_paths

    def get_video_info(self, video_path: str) -> dict:
        """
        ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğµ
        """
        try:
            cap = cv2.VideoCapture(video_path)
            if not cap.isOpened():
                return {}

            width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))
            height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))
            fps = cap.get(cv2.CAP_PROP_FPS)
            total_frames = int(cap.get(cv2.CAP_PROP_FRAME_COUNT))
            duration = total_frames / fps if fps > 0 else 0

            cap.release()

            return {
                'width': width,
                'height': height,
                'fps': fps,
                'total_frames': total_frames,
                'duration': duration
            }
        except Exception as e:
            print(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğ¸ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸ Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾ {video_path}: {e}")
            return {}


core\optimized_comparator.py

import os
import hashlib
from typing import List, Dict, Tuple, Optional
from src.core.frame_extractor import FrameExtractor
from src.algorithms.comparison_manager import ComparisonManager


class OptimizedVideoComparator:
    """
    ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ¼Ğ¿Ğ°Ñ€Ğ°Ñ‚Ğ¾Ñ€ Ğ²Ğ¸Ğ´ĞµĞ¾ Ñ Ğ¿Ñ€ĞµĞ´Ğ²Ğ°Ñ€Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ¹ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸ĞµĞ¹ Ğ¸ ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼
    """

    def __init__(self):
        self.frame_extractor = FrameExtractor()
        self.comparison_manager = ComparisonManager()
        self.num_frames_to_compare = 3  # Ğ£Ğ¼ĞµĞ½ÑŒÑˆĞ°ĞµĞ¼ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ĞºĞ°Ğ´Ñ€Ğ¾Ğ² Ğ´Ğ»Ñ ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚Ğ¸
        self.similarity_threshold = 0.7

        # ĞšÑÑˆĞ¸ Ğ´Ğ»Ñ ÑƒÑĞºĞ¾Ñ€ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€Ğ½Ñ‹Ñ… Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹
        self._frame_cache = {}  # ĞšÑÑˆ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²: video_path -> [frames]
        self._metadata_cache = {}  # ĞšÑÑˆ Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…: video_path -> metadata
        self._file_hash_cache = {}  # ĞšÑÑˆ Ñ…ÑÑˆĞµĞ¹ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ´Ğ»Ñ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ Ñ‚Ğ¾Ñ‡Ğ½Ñ‹Ñ… Ğ´ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ‚Ğ¾Ğ²

    def _get_file_hash(self, file_path: str) -> str:
        """Ğ‘Ñ‹ÑÑ‚Ñ€Ğ¾Ğµ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğµ Ñ…ÑÑˆĞ° Ñ„Ğ°Ğ¹Ğ»Ğ° Ğ´Ğ»Ñ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ Ñ‚Ğ¾Ñ‡Ğ½Ñ‹Ñ… Ğ´ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ‚Ğ¾Ğ²"""
        if file_path in self._file_hash_cache:
            return self._file_hash_cache[file_path]

        try:
            file_size = os.path.getsize(file_path)
            # Ğ”Ğ»Ñ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ñ… Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ±ĞµÑ€ĞµĞ¼ Ñ…ÑÑˆ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¾Ñ‚ Ğ¿ĞµÑ€Ğ²Ñ‹Ñ… 1MB Ğ¸ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ°
            with open(file_path, 'rb') as f:
                if file_size > 1024 * 1024:
                    content = f.read(1024 * 1024)  # ĞŸĞµÑ€Ğ²Ñ‹Ğµ 1MB
                    content += str(file_size).encode()  # Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€ Ñ„Ğ°Ğ¹Ğ»Ğ°
                else:
                    content = f.read()

            file_hash = hashlib.md5(content).hexdigest()
            self._file_hash_cache[file_path] = file_hash
            return file_hash
        except Exception as e:
            print(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğ¸ Ñ…ÑÑˆĞ° Ñ„Ğ°Ğ¹Ğ»Ğ° {file_path}: {e}")
            return ""

    def _get_video_metadata(self, video_path: str) -> Dict:
        """ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ Ğ¸ ĞºÑÑˆĞ¸Ñ€ÑƒĞµÑ‚ Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ²Ğ¸Ğ´ĞµĞ¾"""
        if video_path in self._metadata_cache:
            return self._metadata_cache[video_path]

        metadata = self.frame_extractor.get_video_info(video_path)
        file_info = {
            'size': os.path.getsize(video_path),
            'duration': metadata.get('duration', 0),
            'width': metadata.get('width', 0),
            'height': metadata.get('height', 0),
            'file_hash': self._get_file_hash(video_path)
        }

        self._metadata_cache[video_path] = file_info
        return file_info

    def _get_cached_frames(self, video_path: str) -> List:
        """ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ ĞºĞ°Ğ´Ñ€Ñ‹ Ğ¸Ğ· ĞºÑÑˆĞ° Ğ¸Ğ»Ğ¸ Ğ¸Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµÑ‚ Ğ¸Ñ…"""
        if video_path in self._frame_cache:
            return self._frame_cache[video_path]

        frames = self.frame_extractor.extract_frames(video_path, self.num_frames_to_compare)
        self._frame_cache[video_path] = frames
        return frames

    def _are_metadata_similar(self, meta1: Dict, meta2: Dict) -> bool:
        """
        Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿Ğ¾ Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼ - Ğ¾Ñ‚Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ²Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ·Ğ°Ğ²ĞµĞ´Ğ¾Ğ¼Ğ¾ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ Ğ²Ğ¸Ğ´ĞµĞ¾
        """
        # Ğ•ÑĞ»Ğ¸ Ñ…ÑÑˆĞ¸ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² ÑĞ¾Ğ²Ğ¿Ğ°Ğ´Ğ°ÑÑ‚ - ÑÑ‚Ğ¾ Ñ‚Ğ¾Ñ‡Ğ½Ñ‹Ğµ Ğ´ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ‚Ñ‹
        if meta1['file_hash'] and meta2['file_hash'] and meta1['file_hash'] == meta2['file_hash']:
            return True

        # Ğ Ğ°Ğ·Ğ½Ğ¸Ñ†Ğ° Ğ² Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğµ Ñ„Ğ°Ğ¹Ğ»Ğ° Ğ±Ğ¾Ğ»ÑŒÑˆĞµ 50% - ÑĞºĞ¾Ñ€ĞµĞµ Ğ²ÑĞµĞ³Ğ¾ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ Ğ²Ğ¸Ğ´ĞµĞ¾
        size_ratio = min(meta1['size'], meta2['size']) / max(meta1['size'], meta2['size'])
        if size_ratio < 0.5:
            return False

        # Ğ Ğ°Ğ·Ğ½Ğ¸Ñ†Ğ° Ğ² Ğ´Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ 30% - ÑĞºĞ¾Ñ€ĞµĞµ Ğ²ÑĞµĞ³Ğ¾ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ Ğ²Ğ¸Ğ´ĞµĞ¾
        if meta1['duration'] > 0 and meta2['duration'] > 0:
            duration_ratio = min(meta1['duration'], meta2['duration']) / max(meta1['duration'], meta2['duration'])
            if duration_ratio < 0.7:
                return False

        # Ğ¡Ğ¸Ğ»ÑŒĞ½Ğ¾ Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ°ÑÑ‰ĞµĞµÑÑ Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ
        if meta1['width'] > 0 and meta2['width'] > 0:
            width_ratio = min(meta1['width'], meta2['width']) / max(meta1['width'], meta2['width'])
            if width_ratio < 0.7:
                return False

        return True

    def find_similar_videos_optimized(self, video_files: List[str], similarity_threshold: float = 0.7) -> List[Tuple]:
        """
        ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº Ğ¿Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ñ… Ğ²Ğ¸Ğ´ĞµĞ¾
        """
        self.similarity_threshold = similarity_threshold
        similar_pairs = []

        print(f"ğŸ” ĞĞ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµĞ¼ {len(video_files)} Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²...")

        # Ğ¨Ğ°Ğ³ 1: Ğ¡Ğ¾Ğ±Ğ¸Ñ€Ğ°ĞµĞ¼ Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²
        print("ğŸ“Š Ğ¡Ğ¾Ğ±Ğ¸Ñ€Ğ°ĞµĞ¼ Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ...")
        video_metadata = {}
        for video_path in video_files:
            video_metadata[video_path] = self._get_video_metadata(video_path)

        # Ğ¨Ğ°Ğ³ 2: Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¿Ğ¾ Ñ…ÑÑˆĞ°Ğ¼ Ğ´Ğ»Ñ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ñ…Ğ¾Ğ¶Ğ´ĞµĞ½Ğ¸Ñ Ñ‚Ğ¾Ñ‡Ğ½Ñ‹Ñ… Ğ´ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ‚Ğ¾Ğ²
        print("ğŸ¯ Ğ˜Ñ‰ĞµĞ¼ Ñ‚Ğ¾Ñ‡Ğ½Ñ‹Ğµ Ğ´ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ‚Ñ‹...")
        hash_groups = {}
        for video_path, meta in video_metadata.items():
            if meta['file_hash']:
                if meta['file_hash'] not in hash_groups:
                    hash_groups[meta['file_hash']] = []
                hash_groups[meta['file_hash']].append(video_path)

        # Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ Ñ‚Ğ¾Ñ‡Ğ½Ñ‹Ğµ Ğ´ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ‚Ñ‹ Ğ² Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹
        for file_hash, group in hash_groups.items():
            if len(group) > 1:
                for i in range(len(group)):
                    for j in range(i + 1, len(group)):
                        similar_pairs.append((group[i], group[j], 1.0, {'type': 'exact_duplicate'}))

        # Ğ¨Ğ°Ğ³ 3: ĞŸÑ€ĞµĞ´Ğ²Ğ°Ñ€Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼
        print("âš¡ Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ÑƒĞµĞ¼ Ğ¿Ğ¾ Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼...")
        candidate_pairs = []
        processed_pairs = set()

        for i, video1 in enumerate(video_files):
            meta1 = video_metadata[video1]

            for j, video2 in enumerate(video_files[i + 1:], i + 1):
                # ĞŸÑ€Ğ¾Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ ĞµÑĞ»Ğ¸ ÑƒĞ¶Ğµ Ğ½Ğ°ÑˆĞ»Ğ¸ ĞºĞ°Ğº Ñ‚Ğ¾Ñ‡Ğ½Ñ‹Ğµ Ğ´ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ‚Ñ‹
                if (video1, video2) in processed_pairs or (video2, video1) in processed_pairs:
                    continue

                meta2 = video_metadata[video2]

                # Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿Ğ¾ Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼
                if self._are_metadata_similar(meta1, meta2):
                    candidate_pairs.append((video1, video2))

                processed_pairs.add((video1, video2))

        print(f"ğŸ¯ ĞšĞ°Ğ½Ğ´Ğ¸Ğ´Ğ°Ñ‚Ğ¾Ğ² Ğ´Ğ»Ñ Ğ³Ğ»ÑƒĞ±Ğ¾ĞºĞ¾Ğ³Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°: {len(candidate_pairs)}")

        # Ğ¨Ğ°Ğ³ 4: Ğ“Ğ»ÑƒĞ±Ğ¾ĞºĞ¸Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞºĞ°Ğ½Ğ´Ğ¸Ğ´Ğ°Ñ‚Ğ¾Ğ²
        print("ğŸ” Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ Ğ³Ğ»ÑƒĞ±Ğ¾ĞºĞ¸Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·...")
        for idx, (video1, video2) in enumerate(candidate_pairs):
            if idx % 10 == 0:
                print(f"ğŸ“ˆ ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ğ¾ {idx}/{len(candidate_pairs)} Ğ¿Ğ°Ñ€...")

            result = self.compare_videos(video1, video2)
            similarity = result['similarity']

            if similarity >= similarity_threshold:
                similar_pairs.append((video1, video2, similarity, result))

        # Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¿Ğ¾ ÑƒĞ±Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸
        similar_pairs.sort(key=lambda x: x[2], reverse=True)

        return similar_pairs

    def compare_videos(self, video_path1: str, video_path2: str) -> Dict:
        """
        ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğµ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ´Ğ²ÑƒÑ… Ğ²Ğ¸Ğ´ĞµĞ¾
        """
        # Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ ĞºĞ°Ğ´Ñ€Ñ‹
        frames1 = self._get_cached_frames(video_path1)
        frames2 = self._get_cached_frames(video_path2)

        if not frames1 or not frames2:
            return {
                'similarity': 0.0,
                'error': 'ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ÑŒ ĞºĞ°Ğ´Ñ€Ñ‹',
                'details': {}
            }

        # Ğ£Ğ¿Ñ€Ğ¾Ñ‰ĞµĞ½Ğ½Ğ¾Ğµ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ - Ğ±ĞµÑ€ĞµĞ¼ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ»ÑƒÑ‡ÑˆĞ¸Ğµ ÑĞ¾Ğ²Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ñ
        frame_comparisons = []
        total_similarity = 0.0
        compared_pairs = 0

        # Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ½Ğ¾Ğµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ĞºĞ¾Ğ¼Ğ±Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¹
        max_comparisons = min(len(frames1), len(frames2), 3)

        for i in range(max_comparisons):
            frame1 = frames1[i] if i < len(frames1) else frames1[0]
            frame2 = frames2[i] if i < len(frames2) else frames2[0]

            comparison_result = self.comparison_manager.compare_images(frame1, frame2)
            similarity = comparison_result.get('overall', 0.0)

            frame_comparisons.append({
                'frame1_index': i,
                'frame2_index': i,
                'similarity': similarity,
                'algorithm_details': comparison_result
            })

            total_similarity += similarity
            compared_pairs += 1

        # Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ÑĞµĞ¼ Ğ¾Ğ±Ñ‰ÑƒÑ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ
        overall_similarity = total_similarity / compared_pairs if compared_pairs > 0 else 0.0

        return {
            'similarity': overall_similarity,
            'frame_comparisons': frame_comparisons,
            'frames_extracted': {
                'video1': len(frames1),
                'video2': len(frames2)
            }
        }

    def clear_cache(self):
        """ĞÑ‡Ğ¸Ñ‰Ğ°ĞµÑ‚ ĞºÑÑˆĞ¸"""
        self._frame_cache.clear()
        self._metadata_cache.clear()
        self._file_hash_cache.clear()


core\video_comparator.py

import os
from typing import List, Dict, Tuple

# ĞĞ±ÑĞ¾Ğ»ÑÑ‚Ğ½Ñ‹Ğµ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ñ‹ Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Ğ¾Ñ‚Ğ½Ğ¾ÑĞ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ñ…
from src.algorithms.comparison_manager import ComparisonManager
from src.core.frame_extractor import FrameExtractor


class VideoComparator:
    """Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ´Ğ²Ğ° Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑ Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¾ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ¾Ğ²"""

    def __init__(self):
        self.frame_extractor = FrameExtractor()
        self.comparison_manager = ComparisonManager()
        self.num_frames_to_compare = 5  # ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ĞºĞ°Ğ´Ñ€Ğ¾Ğ² Ğ´Ğ»Ñ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ

    def compare_videos(self, video_path1: str, video_path2: str) -> Dict:
        """
        Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ´Ğ²Ğ° Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ°
        Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ´ĞµÑ‚Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ
        """
        print(f"Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ²Ğ¸Ğ´ĞµĞ¾: {os.path.basename(video_path1)} Ğ¸ {os.path.basename(video_path2)}")

        # Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµĞ¼ ĞºĞ°Ğ´Ñ€Ñ‹ Ğ¸Ğ· Ğ¾Ğ±Ğ¾Ğ¸Ñ… Ğ²Ğ¸Ğ´ĞµĞ¾
        frames1 = self.frame_extractor.extract_frames(video_path1, self.num_frames_to_compare)
        frames2 = self.frame_extractor.extract_frames(video_path2, self.num_frames_to_compare)

        if not frames1 or not frames2:
            return {
                'similarity': 0.0,
                'error': 'ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ÑŒ ĞºĞ°Ğ´Ñ€Ñ‹ Ğ¸Ğ· Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ğ¸Ğ· Ğ²Ğ¸Ğ´ĞµĞ¾',
                'details': {}
            }

        print(f"Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¾ {len(frames1)} ĞºĞ°Ğ´Ñ€Ğ¾Ğ² Ğ¸Ğ· Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾ Ğ¸ {len(frames2)} Ğ¸Ğ· Ğ²Ñ‚Ğ¾Ñ€Ğ¾Ğ³Ğ¾")

        # Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ ĞºĞ°Ğ´Ñ€Ñ‹
        frame_comparisons = []
        total_similarity = 0.0
        compared_pairs = 0

        for i, frame1 in enumerate(frames1):
            best_similarity = 0.0
            best_comparison_details = {}

            for j, frame2 in enumerate(frames2):
                # Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ´Ğ²Ğ° ĞºĞ°Ğ´Ñ€Ğ°
                comparison_result = self.comparison_manager.compare_images(frame1, frame2)
                similarity = comparison_result.get('overall', 0.0)

                if similarity > best_similarity:
                    best_similarity = similarity
                    best_comparison_details = {
                        'frame1_index': i,
                        'frame2_index': j,
                        'similarity': similarity,
                        'algorithm_details': comparison_result
                    }

            if best_comparison_details:
                frame_comparisons.append(best_comparison_details)
                total_similarity += best_similarity
                compared_pairs += 1

        # Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ÑĞµĞ¼ Ğ¾Ğ±Ñ‰ÑƒÑ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ
        overall_similarity = total_similarity / compared_pairs if compared_pairs > 0 else 0.0

        return {
            'similarity': overall_similarity,
            'frame_comparisons': frame_comparisons,
            'frames_extracted': {
                'video1': len(frames1),
                'video2': len(frames2)
            },
            'algorithm_weights': {comp.name: comp.weight for comp in self.comparison_manager.comparators}
        }

    def find_similar_videos(self, video_files: List[str], similarity_threshold: float = 0.7) -> List[Tuple]:
        """
        ĞĞ°Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ¿Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ğµ Ğ²Ğ¸Ğ´ĞµĞ¾ ÑÑ€ĞµĞ´Ğ¸ ÑĞ¿Ğ¸ÑĞºĞ° Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²
        Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ ÑĞ¿Ğ¸ÑĞ¾Ğº ĞºĞ¾Ñ€Ñ‚ĞµĞ¶ĞµĞ¹ (video1, video2, similarity)
        """
        similar_pairs = []

        for i in range(len(video_files)):
            for j in range(i + 1, len(video_files)):
                video1 = video_files[i]
                video2 = video_files[j]

                print(f"Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ {i + 1}/{len(video_files)}: {os.path.basename(video1)} Ğ¸ {os.path.basename(video2)}")

                result = self.compare_videos(video1, video2)
                similarity = result['similarity']

                if similarity >= similarity_threshold:
                    similar_pairs.append((video1, video2, similarity, result))

        # Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¿Ğ¾ ÑƒĞ±Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸
        similar_pairs.sort(key=lambda x: x[2], reverse=True)

        return similar_pairs


core\__pycache__\__init__.cpython-313.pyc

Ñƒ
    â€œiĞ“   Ğ³                   Ñƒ0   â€¢ S SK Jr  S SKJr  S SKJr  / SQrg)Ğ¹   )ĞªFileScanner)ĞªFrameExtractor)ĞªVideoComparator)r   r   r   N)Ğªfile_scannerr   Ğªframe_extractorr   Ğªvideo_comparatorr   Ğª__all__Â© Ñƒ    ĞªDF:\Programs\PythonProject\VideoDuplicateCleaner\src\core\__init__.pyĞª<module>r      s   Ñ€Ğ­ %Ğ­ +Ğ­ -Ğ²
>Ğƒr   


core\__pycache__\file_scanner.cpython-313.pyc

Ã³
    ÂŠiÂ‡  Ã£                   Ã³,   Â• S SK r S SKJr   " S S5      rg)Ã©    N)ÃšListc                   Ã³D   Â• \ rS rSrS rS\S\\   4S jrS\S\4S jr	Sr
g	)
ÃšFileScannerÃ©   c                 Ã³   Â• 1 SkU l         g )N>   Ãº.aviÃº.mkvÃº.movÃº.mp4Ãº.wmvÂ©Ãšsupported_formats)Ãšselfs    ÃšHF:\Programs\PythonProject\VideoDuplicateCleaner\src\core\file_scanner.pyÃš__init__ÃšFileScanner.__init__   s
   Â€ Ãš!IÂˆÃ•Ã³    Ãš	directoryÃšreturnc                 Ã³ÂŒ  Â• / n [         R                  " U5       HÂ€  u  p4nU Ht  n[         R                  R                  U5      S   R	                  5       nXpR
                  ;   d  MD  [         R                  R                  X65      nUR                  U5        Mv     MÂ‚     U$ ! [         a  n	[        SU	 35         Sn	A	U$ Sn	A	ff = f)uc   
ÃÂÃÂ°Ã‘Â…ÃÂ¾ÃÂ´ÃÂ¸Ã‘Â‚ ÃÂ²Ã‘ÂÃÂµ ÃÂ²ÃÂ¸ÃÂ´ÃÂµÃÂ¾Ã‘Â„ÃÂ°ÃÂ¹ÃÂ»Ã‘Â‹ ÃÂ² Ã‘ÂƒÃÂºÃÂ°ÃÂ·ÃÂ°ÃÂ½ÃÂ½ÃÂ¾ÃÂ¹ ÃÂ¿ÃÂ°ÃÂ¿ÃÂºÃÂµ ÃÂ¸ ÃÂ¿ÃÂ¾ÃÂ´ÃÂ¿ÃÂ°ÃÂ¿ÃÂºÃÂ°Ã‘Â…
Ã©   u9   ÃÂÃ‘ÂˆÃÂ¸ÃÂ±ÃÂºÃÂ° ÃÂ¿Ã‘Â€ÃÂ¸ Ã‘ÂÃÂºÃÂ°ÃÂ½ÃÂ¸Ã‘Â€ÃÂ¾ÃÂ²ÃÂ°ÃÂ½ÃÂ¸ÃÂ¸ ÃÂ¿ÃÂ°ÃÂ¿ÃÂºÃÂ¸: N)
ÃšosÃšwalkÃšpathÃšsplitextÃšlowerr   ÃšjoinÃšappendÃš	ExceptionÃšprint)
r   r   Ãšvideo_filesÃšrootÃšdirsÃšfilesÃšfileÃšfile_extÃš	full_pathÃšes
             r   Ãšfind_video_filesÃšFileScanner.find_video_files	   sÂ´   Â€ Ã° ÂˆÃ°	SÃœ%'Â§WÂ¢WÂ¨YÃ–%7Ã‘!ÂÂ˜EÃ›!ÂDÃœ!ÂŸwÂ™wÃ—/Ã‘/Â°Ã“5Â°aÃ‘8Ã—>Ã‘>Ã“@ÂHÃ˜Ã—#9Ã‘#9Ã•9Ãœ$&Â§GÂ¡GÂ§LÂ¡LÂ°Ã“$<Â˜	Ã˜#Ã—*Ã‘*Â¨9Ã–5Ã³	 "Ã± &8Ã° ÃÃ¸Ã´ Ã³ 	SÃœÃMÃˆaÃˆSÃQÃ—RÃRÃ ÃÃ»Ã°	SÃºs   Â„AB  Ã&8B  Ã‚ 
CÃ‚*B>Ã‚>CÃš	file_pathc                 Ã³Â¸   Â•  [         R                  " U5      nUR                  UR                  US.$ ! [         a  n[        SU SU 35        0 s SnA$ SnAff = f)uD   
ÃÂŸÃÂ¾ÃÂ»Ã‘ÂƒÃ‘Â‡ÃÂ°ÃÂµÃ‘Â‚ ÃÂ±ÃÂ°ÃÂ·ÃÂ¾ÃÂ²Ã‘ÂƒÃ‘Â ÃÂ¸ÃÂ½Ã‘Â„ÃÂ¾Ã‘Â€ÃÂ¼ÃÂ°Ã‘Â†ÃÂ¸Ã‘Â ÃÂ¾ Ã‘Â„ÃÂ°ÃÂ¹ÃÂ»ÃÂµ
)ÃšsizeÃšmodifiedr   uJ   ÃÂÃ‘ÂˆÃÂ¸ÃÂ±ÃÂºÃÂ° ÃÂ¿Ã‘Â€ÃÂ¸ ÃÂ¿ÃÂ¾ÃÂ»Ã‘ÂƒÃ‘Â‡ÃÂµÃÂ½ÃÂ¸ÃÂ¸ ÃÂ¸ÃÂ½Ã‘Â„ÃÂ¾Ã‘Â€ÃÂ¼ÃÂ°Ã‘Â†ÃÂ¸ÃÂ¸ ÃÂ¾ Ã‘Â„ÃÂ°ÃÂ¹ÃÂ»ÃÂµ z: N)r   ÃšstatÃšst_sizeÃšst_mtimer   r    )r   r+   r/   r(   s       r   Ãšget_file_infoÃšFileScanner.get_file_info   sb   Â€ Ã°		ÃœÂ—7Â’7Â˜9Ã“%ÂˆDÃ ÂŸÂ™Ã˜ ÂŸMÂ™MÃ˜!Ã±Ã° Ã¸Ã´
 Ã³ 	ÃœÃ^Ã_hÃ^iÃikÃlmÃknÃoÃ”pÃ˜ÂIÃ»Ã°	Ãºs   Â‚/2 Â²
AÂ¼AÃAÃAr   N)Ãš__name__Ãš
__module__Ãš__qualname__Ãš__firstlineno__r   Ãšstrr   r)   Ãšdictr2   Ãš__static_attributes__Â© r   r   r   r      s2   Â† Ã²JÃ°Â¨#Ã° Â°$Â°sÂ±)Ã´ Ã°$Â sÃ° Â¨tÃ· r   r   )r   Ãštypingr   r   r;   r   r   Ãš<module>r=      s   Ã°Ã› 	Ã Ã·#Ã² #r   


core\__pycache__\frame_extractor.cpython-313.pyc

Ã³
    +iÃ²  Ã£                   Ã³@   Â• S SK r S SKrS SKJrJr  S SKr " S S5      rg)Ã©    N)ÃšListÃšOptionalc            
       Ã³Â„   Â• \ rS rSrS rSS\S\S\\R                     4S jjr
SS\S\S\S\\   4S jjrS\S\4S	 jrS
rg)ÃšFrameExtractorÃ©   c                 Ã³   Â• 1 SkU l         g )N>   Ãº.aviÃº.mkvÃº.movÃº.mp4Ãº.wmvÂ©Ãšsupported_formats)Ãšselfs    ÃšKF:\Programs\PythonProject\VideoDuplicateCleaner\src\core\frame_extractor.pyÃš__init__ÃšFrameExtractor.__init__   s
   Â€ Ãš!IÂˆÃ•Ã³    Ãš
video_pathÃš
num_framesÃšreturnc                 Ã³H  Â• / n [         R                  " U5      nUR                  5       (       d  [        SU 35        U$ [	        UR                  [         R                  5      5      nUR                  [         R                  5      nUS:Â”  a  XV-  OSnXR::  a_  [        U5       HO  nUR                  [         R                  U5        UR                  5       u  pÂšU	(       d  M>  UR                  U
5        MQ     Os[        R                  " SUS-
  U[        S9nU HO  nUR                  [         R                  U5        UR                  5       u  pÂšU	(       d  M>  UR                  U
5        MQ     UR                  5         U$ ! [          a  n[        SU SU 35         SnAU$ SnAff = f)um  
ÃÂ˜ÃÂ·ÃÂ²ÃÂ»ÃÂµÃÂºÃÂ°ÃÂµÃ‘Â‚ Ã‘ÂƒÃÂºÃÂ°ÃÂ·ÃÂ°ÃÂ½ÃÂ½ÃÂ¾ÃÂµ ÃÂºÃÂ¾ÃÂ»ÃÂ¸Ã‘Â‡ÃÂµÃ‘ÂÃ‘Â‚ÃÂ²ÃÂ¾ ÃÂºÃÂ°ÃÂ´Ã‘Â€ÃÂ¾ÃÂ² ÃÂ¸ÃÂ· ÃÂ²ÃÂ¸ÃÂ´ÃÂµÃÂ¾, Ã‘Â€ÃÂ°ÃÂ²ÃÂ½ÃÂ¾ÃÂ¼ÃÂµÃ‘Â€ÃÂ½ÃÂ¾ Ã‘Â€ÃÂ°Ã‘ÂÃÂ¿Ã‘Â€ÃÂµÃÂ´ÃÂµÃÂ»ÃÂµÃÂ½ÃÂ½Ã‘Â‹Ã‘Â… ÃÂ¿ÃÂ¾ ÃÂ²Ã‘Â€ÃÂµÃÂ¼ÃÂµÃÂ½ÃÂ¸

Args:
    video_path: ÃÂ¿Ã‘ÂƒÃ‘Â‚Ã‘ÂŒ ÃÂº ÃÂ²ÃÂ¸ÃÂ´ÃÂµÃÂ¾Ã‘Â„ÃÂ°ÃÂ¹ÃÂ»Ã‘Âƒ
    num_frames: ÃÂºÃÂ¾ÃÂ»ÃÂ¸Ã‘Â‡ÃÂµÃ‘ÂÃ‘Â‚ÃÂ²ÃÂ¾ ÃÂºÃÂ°ÃÂ´Ã‘Â€ÃÂ¾ÃÂ² ÃÂ´ÃÂ»Ã‘Â ÃÂ¸ÃÂ·ÃÂ²ÃÂ»ÃÂµÃ‘Â‡ÃÂµÃÂ½ÃÂ¸Ã‘Â

Returns:
    ÃÂ¡ÃÂ¿ÃÂ¸Ã‘ÂÃÂ¾ÃÂº ÃÂºÃÂ°ÃÂ´Ã‘Â€ÃÂ¾ÃÂ² ÃÂ² Ã‘Â„ÃÂ¾Ã‘Â€ÃÂ¼ÃÂ°Ã‘Â‚ÃÂµ numpy arrays
u7   ÃÂÃÂµ Ã‘ÂƒÃÂ´ÃÂ°ÃÂ»ÃÂ¾Ã‘ÂÃ‘ÂŒ ÃÂ¾Ã‘Â‚ÃÂºÃ‘Â€Ã‘Â‹Ã‘Â‚Ã‘ÂŒ ÃÂ²ÃÂ¸ÃÂ´ÃÂµÃÂ¾Ã‘Â„ÃÂ°ÃÂ¹ÃÂ»: r   Ã©   )Ãšdtypeu;   ÃÂÃ‘ÂˆÃÂ¸ÃÂ±ÃÂºÃÂ° ÃÂ¿Ã‘Â€ÃÂ¸ ÃÂ¸ÃÂ·ÃÂ²ÃÂ»ÃÂµÃ‘Â‡ÃÂµÃÂ½ÃÂ¸ÃÂ¸ ÃÂºÃÂ°ÃÂ´Ã‘Â€ÃÂ¾ÃÂ² ÃÂ¸ÃÂ· Ãº: N)Ãšcv2ÃšVideoCaptureÃšisOpenedÃšprintÃšintÃšgetÃšCAP_PROP_FRAME_COUNTÃšCAP_PROP_FPSÃšrangeÃšsetÃšCAP_PROP_POS_FRAMESÃšreadÃšappendÃšnpÃšlinspaceÃšreleaseÃš	Exception)r   r   r   ÃšframesÃšcapÃštotal_framesÃšfpsÃšdurationÃšiÃšretÃšframeÃšframe_positionsÃšposÃšes                 r   Ãšextract_framesÃšFrameExtractor.extract_frames   sh  Â€ Ã° ÂˆÃ°!	cÃ¤Ã—"Ã’"Â :Ã“.ÂˆCÃ Â—<Â‘<Â—>Â‘>ÃœÃOÃPZÃˆ|Ã\Ã”]Ã˜ÂÃ´ Â˜sÂŸwÂ™wÂ¤sÃ—'?Ã‘'?Ã“@Ã“AÂˆLÃ˜Â—'Â‘'Âœ#Ã—*Ã‘*Ã“+ÂˆCÃ˜-0Â°1Â«WÂ|Ã’)Â¸!ÂˆHÃ° Ã“)ÃœÂ˜|Ã–,ÂAÃ˜Â—GÂ‘GÂœCÃ—3Ã‘3Â°QÃ”7Ã˜!$Â§Â¡Â£Â‘JÂCÃŸÂsÃ˜ÂŸÂ™Â eÃ–,Ã²	 -Ã´ #%Â§+Â¢+Â¨aÂ°Ã€Ã‘1AÃ€:Ã”UXÃ‘"YÂÃ£*ÂCÃ˜Â—GÂ‘GÂœCÃ—3Ã‘3Â°SÃ”9Ã˜!$Â§Â¡Â£Â‘JÂCÃŸÂsÃ˜ÂŸÂ™Â eÃ–,Ã±	 +Ã° ÂKÂ‰KÂŒMÃ°
 ÂˆÃ¸Ã´ Ã³ 	cÃœÃOÃPZÃˆ|Ã[]Ã^_Ã]`ÃaÃ—bÃbÃ ÂˆÃ»Ã°	cÃºs*   Â„:E; Â¿BE; Ãƒ A0E; Ã…%E; Ã…;
F!Ã†FÃ†F!Ãš
output_dirc                 Ã³Â€  Â• U R                  X5      n/ n[        U5       Hr  u  pgSU S[        R                  R	                  U5       S3n[        R                  R                  X(5      n	 [        R                  " XÂ—5        UR                  U	5        Mt     U$ ! [         a  n
[        SU SU
 35         Sn
A
MÂ™  Sn
A
ff = f)u`   
ÃÂ˜ÃÂ·ÃÂ²ÃÂ»ÃÂµÃÂºÃÂ°ÃÂµÃ‘Â‚ ÃÂºÃÂ°ÃÂ´Ã‘Â€Ã‘Â‹ ÃÂ¸ Ã‘ÂÃÂ¾Ã‘Â…Ã‘Â€ÃÂ°ÃÂ½Ã‘ÂÃÂµÃ‘Â‚ ÃÂ¸Ã‘Â… ÃÂ² Ã‘Â„ÃÂ°ÃÂ¹ÃÂ»Ã‘Â‹ (ÃÂ´ÃÂ»Ã‘Â ÃÂ¾Ã‘Â‚ÃÂ»ÃÂ°ÃÂ´ÃÂºÃÂ¸)
Ãšframe_Ãš_z.jpgu4   ÃÂÃ‘ÂˆÃÂ¸ÃÂ±ÃÂºÃÂ° ÃÂ¿Ã‘Â€ÃÂ¸ Ã‘ÂÃÂ¾Ã‘Â…Ã‘Â€ÃÂ°ÃÂ½ÃÂµÃÂ½ÃÂ¸ÃÂ¸ ÃÂºÃÂ°ÃÂ´Ã‘Â€ÃÂ° r   N)r8   Ãš	enumerateÃšosÃšpathÃšbasenameÃšjoinr   Ãšimwriter(   r,   r   )r   r   r:   r   r-   Ãšsaved_pathsr2   r4   ÃšfilenameÃšoutput_pathr7   s              r   Ãšextract_and_save_framesÃš&FrameExtractor.extract_and_save_frames=   sÂ·   Â€ Ã° Ã—$Ã‘$Â ZÃ“<ÂˆÃ˜ÂˆÃ¤!Â &Ã–)Â‰HÂˆAÃ˜Â Â˜sÂ !Â¤BÂ§GÂ¡GÃ—$4Ã‘$4Â°ZÃ“$@Ã#AÃ€ÃFÂˆHÃœÂŸ'Â™'ÂŸ,Â™,Â zÃ“<ÂˆKÃ°WÃœÂ—Â’Â˜KÃ”/Ã˜Ã—"Ã‘"Â ;Ã–/Ã± *Ã° ÃÃ¸Ã´ Ã³ WÃœÃLÃˆQÃˆCÃˆrÃRSÃQTÃUÃ—VÃ’VÃ»Ã°WÃºs   Ã*'BÃ‚
B=Ã‚!B8Ã‚8B=c                 Ã³(  Â•  [         R                  " U5      nUR                  5       (       d  0 $ [        UR	                  [         R
                  5      5      n[        UR	                  [         R                  5      5      nUR	                  [         R                  5      n[        UR	                  [         R                  5      5      nUS:Â”  a  Xe-  OSnUR                  5         UUUUUS.$ ! [         a  n[        SU SU 35        0 s SnA$ SnAff = f)u?   
ÃÂŸÃÂ¾ÃÂ»Ã‘ÂƒÃ‘Â‡ÃÂ°ÃÂµÃ‘Â‚ ÃÂ¸ÃÂ½Ã‘Â„ÃÂ¾Ã‘Â€ÃÂ¼ÃÂ°Ã‘Â†ÃÂ¸Ã‘Â ÃÂ¾ ÃÂ²ÃÂ¸ÃÂ´ÃÂµÃÂ¾Ã‘Â„ÃÂ°ÃÂ¹ÃÂ»ÃÂµ
r   )ÃšwidthÃšheightr0   r/   r1   uJ   ÃÂÃ‘ÂˆÃÂ¸ÃÂ±ÃÂºÃÂ° ÃÂ¿Ã‘Â€ÃÂ¸ ÃÂ¿ÃÂ¾ÃÂ»Ã‘ÂƒÃ‘Â‡ÃÂµÃÂ½ÃÂ¸ÃÂ¸ ÃÂ¸ÃÂ½Ã‘Â„ÃÂ¾Ã‘Â€ÃÂ¼ÃÂ°Ã‘Â†ÃÂ¸ÃÂ¸ ÃÂ¾ ÃÂ²ÃÂ¸ÃÂ´ÃÂµÃÂ¾ r   N)r   r   r   r    r!   ÃšCAP_PROP_FRAME_WIDTHÃšCAP_PROP_FRAME_HEIGHTr#   r"   r+   r,   r   )	r   r   r.   rJ   rK   r0   r/   r1   r7   s	            r   Ãšget_video_infoÃšFrameExtractor.get_video_infoO   sÃ¬   Â€ Ã°	ÃœÃ—"Ã’"Â :Ã“.ÂˆCÃ˜Â—<Â‘<Â—>Â‘>Ã˜Â	Ã¤Â˜ÂŸÂ™Â¤Ã— 8Ã‘ 8Ã“9Ã“:ÂˆEÃœÂ˜ÂŸÂ™Â¤Ã—!:Ã‘!:Ã“;Ã“<ÂˆFÃ˜Â—'Â‘'Âœ#Ã—*Ã‘*Ã“+ÂˆCÃœÂ˜sÂŸwÂ™wÂ¤sÃ—'?Ã‘'?Ã“@Ã“AÂˆLÃ˜-0Â°1Â«WÂ|Ã’)Â¸!ÂˆHÃ ÂKÂ‰KÂŒMÃ° Ã˜ Ã˜Ã˜ ,Ã˜$Ã±Ã° Ã¸Ã´ Ã³ 	ÃœÃ^Ã_iÃ^jÃjlÃmnÃloÃpÃ”qÃ˜ÂIÃ»Ã°	Ãºs#   Â‚,C* Â¯B:C* Ãƒ*
DÃƒ4DÃ„DÃ„Dr   N)Ã©
   )Ãš__name__Ãš
__module__Ãš__qualname__Ãš__firstlineno__r   Ãšstrr    r   r)   Ãšndarrayr8   rG   ÃšdictrN   Ãš__static_attributes__Â© r   r   r   r      sh   Â† Ã²JÃ±0Â¨Ã° 0Â¸#Ã° 0Ã€tÃˆBÃJÃ‰JÃ‘GWÃµ 0Ã±dÂ°#Ã° Ã€3Ã° ÃTWÃ° ÃaeÃfiÃ‘ajÃµ Ã°$Â¨Ã° Â°Ã· r   r   )r   r?   Ãštypingr   r   Ãšnumpyr)   r   rY   r   r   Ãš<module>r\      s   Ã°Ã› 
Ã› 	ÃŸ !Ã› Ã·bÃ² br   


core\__pycache__\optimized_comparator.cpython-313.pyc

Ã³
    #im(  Ã£                   Ã³X   Â• S SK r S SKrS SKJrJrJrJr  S SKJr  S SK	J
r
   " S S5      rg)Ã©    N)ÃšListÃšDictÃšTupleÃšOptional)ÃšFrameExtractor)ÃšComparisonManagerc                   Ã³Â¬   Â• \ rS rSrSrS rS\S\4S jrS\S\4S jr	S\S\
4S	 jrS
\S\S\4S jrSS\
\   S\S\
\   4S jjrS\S\S\4S jrS rSrg)ÃšOptimizedVideoComparatorÃ©   uÂ—   
ÃÂÃÂ¿Ã‘Â‚ÃÂ¸ÃÂ¼ÃÂ¸ÃÂ·ÃÂ¸Ã‘Â€ÃÂ¾ÃÂ²ÃÂ°ÃÂ½ÃÂ½Ã‘Â‹ÃÂ¹ ÃÂºÃÂ¾ÃÂ¼ÃÂ¿ÃÂ°Ã‘Â€ÃÂ°Ã‘Â‚ÃÂ¾Ã‘Â€ ÃÂ²ÃÂ¸ÃÂ´ÃÂµÃÂ¾ Ã‘Â ÃÂ¿Ã‘Â€ÃÂµÃÂ´ÃÂ²ÃÂ°Ã‘Â€ÃÂ¸Ã‘Â‚ÃÂµÃÂ»Ã‘ÂŒÃÂ½ÃÂ¾ÃÂ¹ Ã‘Â„ÃÂ¸ÃÂ»Ã‘ÂŒÃ‘Â‚Ã‘Â€ÃÂ°Ã‘Â†ÃÂ¸ÃÂµÃÂ¹ ÃÂ¸ ÃÂºÃ‘ÂÃ‘ÂˆÃÂ¸Ã‘Â€ÃÂ¾ÃÂ²ÃÂ°ÃÂ½ÃÂ¸ÃÂµÃÂ¼
c                 Ã³Â†   Â• [        5       U l        [        5       U l        SU l        SU l        0 U l        0 U l        0 U l        g )NÃ©   Ã§ffffffÃ¦?)	r   Ãšframe_extractorr   Ãšcomparison_managerÃšnum_frames_to_compareÃšsimilarity_thresholdÃš_frame_cacheÃš_metadata_cacheÃš_file_hash_cacheÂ©Ãšselfs    ÃšPF:\Programs\PythonProject\VideoDuplicateCleaner\src\core\optimized_comparator.pyÃš__init__Ãš!OptimizedVideoComparator.__init__   sB   Â€ Ãœ-Ã“/ÂˆÃ”Ãœ"3Ã“"5ÂˆÃ”Ã˜%&ÂˆÃ”"Ã˜$'ÂˆÃ”!Ã° ÂˆÃ”Ã˜!ÂˆÃ”Ã˜ "ÂˆÃ•Ã³    Ãš	file_pathÃšreturnc                 Ã³
  Â• XR                   ;   a  U R                   U   $  [        R                  R                  U5      n[	        US5       nUS:Â”  a.  UR                  S5      nU[        U5      R                  5       -  nOUR                  5       nSSS5        [        R                  " W5      R                  5       nXPR                   U'   U$ ! , (       d  f       NB= f! [         a  n[        SU SU 35         SnAgSnAff = f)uw   ÃÂ‘Ã‘Â‹Ã‘ÂÃ‘Â‚Ã‘Â€ÃÂ¾ÃÂµ ÃÂ²Ã‘Â‹Ã‘Â‡ÃÂ¸Ã‘ÂÃÂ»ÃÂµÃÂ½ÃÂ¸ÃÂµ Ã‘Â…Ã‘ÂÃ‘ÂˆÃÂ° Ã‘Â„ÃÂ°ÃÂ¹ÃÂ»ÃÂ° ÃÂ´ÃÂ»Ã‘Â ÃÂ¾ÃÂ¿Ã‘Â€ÃÂµÃÂ´ÃÂµÃÂ»ÃÂµÃÂ½ÃÂ¸Ã‘Â Ã‘Â‚ÃÂ¾Ã‘Â‡ÃÂ½Ã‘Â‹Ã‘Â… ÃÂ´Ã‘ÂƒÃÂ±ÃÂ»ÃÂ¸ÃÂºÃÂ°Ã‘Â‚ÃÂ¾ÃÂ²Ãšrbi   Nu=   ÃÂÃ‘ÂˆÃÂ¸ÃÂ±ÃÂºÃÂ° ÃÂ¿Ã‘Â€ÃÂ¸ ÃÂ²Ã‘Â‹Ã‘Â‡ÃÂ¸Ã‘ÂÃÂ»ÃÂµÃÂ½ÃÂ¸ÃÂ¸ Ã‘Â…Ã‘ÂÃ‘ÂˆÃÂ° Ã‘Â„ÃÂ°ÃÂ¹ÃÂ»ÃÂ° z: Ãš )r   ÃšosÃšpathÃšgetsizeÃšopenÃšreadÃšstrÃšencodeÃšhashlibÃšmd5Ãš	hexdigestÃš	ExceptionÃšprint)r   r   Ãš	file_sizeÃšfÃšcontentÃš	file_hashÃšes          r   Ãš_get_file_hashÃš'OptimizedVideoComparator._get_file_hash   sÃ¤   Â€ Ã Ã—-Ã‘-Ã“-Ã˜Ã—(Ã‘(Â¨Ã‘3Ã3Ã°	ÃœÂŸÂ™ÂŸÂ™Â¨	Ã“2ÂˆIÃ¤ÂiÂ Ã”&Â¨!Ã˜Â˜{Ã“*Ã˜ÂŸfÂ™fÂ [Ã“1ÂGÃ˜ÂœsÂ 9Â›~Ã—4Ã‘4Ã“6Ã‘6Â‘GÃ ÂŸfÂ™fÂ›hÂGÃ· 'Ã´  ÂŸÂšÂ GÃ“,Ã—6Ã‘6Ã“8ÂˆIÃ˜/8Ã—!Ã‘!Â )Ã‘,Ã˜ÃÃ· 'Ã•&Ã»Ã´ Ã³ 	ÃœÃQÃR[ÃQ\Ã\^Ã_`Ã^aÃbÃ”cÃœÃ»Ã°	Ãºs0   Â +C ÃACÃ‚;C Ãƒ
CÃƒC Ãƒ
DÃƒ'C=Ãƒ=DÃš
video_pathc                 Ã³\  Â• XR                   ;   a  U R                   U   $ U R                  R                  U5      n[        R                  R                  U5      UR                  SS5      UR                  SS5      UR                  SS5      U R                  U5      S.nX0R                   U'   U$ )uD   ÃÂŸÃÂ¾ÃÂ»Ã‘ÂƒÃ‘Â‡ÃÂ°ÃÂµÃ‘Â‚ ÃÂ¸ ÃÂºÃ‘ÂÃ‘ÂˆÃÂ¸Ã‘Â€Ã‘ÂƒÃÂµÃ‘Â‚ ÃÂ¼ÃÂµÃ‘Â‚ÃÂ°ÃÂ´ÃÂ°ÃÂ½ÃÂ½Ã‘Â‹ÃÂµ ÃÂ²ÃÂ¸ÃÂ´ÃÂµÃÂ¾Ãšdurationr   ÃšwidthÃšheight)Ãšsizer6   r7   r8   r0   )r   r   Ãšget_video_infor!   r"   r#   Ãšgetr2   )r   r4   ÃšmetadataÃš	file_infos       r   Ãš_get_video_metadataÃš,OptimizedVideoComparator._get_video_metadata.   sÂš   Â€ Ã Ã—-Ã‘-Ã“-Ã˜Ã—'Ã‘'Â¨
Ã‘3Ã3Ã Ã—'Ã‘'Ã—6Ã‘6Â°zÃ“BÂˆÃ¤Â—GÂ‘GÂ—OÂ‘OÂ JÃ“/Ã˜ ÂŸÂ™Â ZÂ°Ã“3Ã˜Â—\Â‘\Â 'Â¨1Ã“-Ã˜Â—lÂ‘lÂ 8Â¨QÃ“/Ã˜Ã—,Ã‘,Â¨ZÃ“8Ã±
Âˆ	Ã° ,5Ã—Ã‘Â˜ZÃ‘(Ã˜Ãr   c                 Ã³Â¨   Â• XR                   ;   a  U R                   U   $ U R                  R                  XR                  5      nX R                   U'   U$ )uH   ÃÂŸÃÂ¾ÃÂ»Ã‘ÂƒÃ‘Â‡ÃÂ°ÃÂµÃ‘Â‚ ÃÂºÃÂ°ÃÂ´Ã‘Â€Ã‘Â‹ ÃÂ¸ÃÂ· ÃÂºÃ‘ÂÃ‘ÂˆÃÂ° ÃÂ¸ÃÂ»ÃÂ¸ ÃÂ¸ÃÂ·ÃÂ²ÃÂ»ÃÂµÃÂºÃÂ°ÃÂµÃ‘Â‚ ÃÂ¸Ã‘Â…)r   r   Ãšextract_framesr   )r   r4   Ãšframess      r   Ãš_get_cached_framesÃš+OptimizedVideoComparator._get_cached_frames?   sN   Â€ Ã Ã—*Ã‘*Ã“*Ã˜Ã—$Ã‘$Â ZÃ‘0Ã0Ã Ã—%Ã‘%Ã—4Ã‘4Â°ZÃ—A[Ã‘A[Ã“\ÂˆÃ˜(.Ã—Ã‘Â˜*Ã‘%Ã˜Âˆr   Ãšmeta1Ãšmeta2c                 Ã³Â–  Â• US   (       a  US   (       a  US   US   :X  a  g[        US   US   5      [        US   US   5      -  nUS:  a  gUS   S:Â”  a5  US   S:Â”  a,  [        US   US   5      [        US   US   5      -  nUS:  a  gUS	   S:Â”  a5  US	   S:Â”  a,  [        US	   US	   5      [        US	   US	   5      -  nUS:  a  gg)
uÂ…   
ÃÂ‘Ã‘Â‹Ã‘ÂÃ‘Â‚Ã‘Â€ÃÂ°Ã‘Â ÃÂ¿Ã‘Â€ÃÂ¾ÃÂ²ÃÂµÃ‘Â€ÃÂºÃÂ° ÃÂ¿ÃÂ¾ ÃÂ¼ÃÂµÃ‘Â‚ÃÂ°ÃÂ´ÃÂ°ÃÂ½ÃÂ½Ã‘Â‹ÃÂ¼ - ÃÂ¾Ã‘Â‚Ã‘Â„ÃÂ¸ÃÂ»Ã‘ÂŒÃ‘Â‚Ã‘Â€ÃÂ¾ÃÂ²Ã‘Â‹ÃÂ²ÃÂ°ÃÂµÃÂ¼ ÃÂ·ÃÂ°ÃÂ²ÃÂµÃÂ´ÃÂ¾ÃÂ¼ÃÂ¾ Ã‘Â€ÃÂ°ÃÂ·ÃÂ½Ã‘Â‹ÃÂµ ÃÂ²ÃÂ¸ÃÂ´ÃÂµÃÂ¾
r0   Tr9   g      Ã ?Fr6   r   r   r7   )ÃšminÃšmax)r   rE   rF   Ãš
size_ratioÃšduration_ratioÃšwidth_ratios         r   Ãš_are_metadata_similarÃš.OptimizedVideoComparator._are_metadata_similarH   s  Â€ Ã°
 ÂÃ—Â %Â¨Ã—"4Â¸Â¸{Ã‘9KÃˆuÃU`Ã‘OaÃ“9aÃ˜Ã´ Â˜Â˜vÂ™Â¨Â¨fÂ©Ã“6Â¼Â¸UÃ€6Â¹]ÃˆEÃRXÃ‰MÃ“9ZÃ‘ZÂˆ
Ã˜Â˜Ã“Ã˜Ã° ÂÃ‘Â˜qÃ“ Â UÂ¨:Ã‘%6Â¸Ã“%:Ãœ Â Â zÃ‘!2Â°EÂ¸*Ã‘4EÃ“FÃŒÃˆUÃS]Ã‘M^Ã`eÃfpÃ‘`qÃ“IrÃ‘rÂˆNÃ˜Â Ã“#Ã˜Ã° ÂÂ‰>Â˜AÃ“Â %Â¨Â¡.Â°1Ã“"4ÃœÂ˜eÂ GÂ™nÂ¨eÂ°GÂ©nÃ“=Ã„Ã€EÃˆ'ÃNÃTYÃZaÃ‘TbÃ“@cÃ‘cÂˆKÃ˜Â˜SÃ“ Ã˜Ã r   Ãšvideo_filesr   c           
      Ã³Ã  Â• X l         / n[        S[        U5       S35        [        S5        0 nU H  nU R                  U5      XE'   M     [        S5        0 nUR	                  5        H7  u  pWUS   (       d  M  US   U;  a  / XgS   '   XgS      R                  U5        M9     UR	                  5        Hk  u  pÂ‰[        U	5      S:Â”  d  M  [        [        U	5      5       H=  n
[        U
S-   [        U	5      5       H  nUR                  XÂš   XÂ›   SSS	045        M      M?     Mm     [        S
5        / n[        5       n[        U5       H{  u  pÂ®XN   n[        XS-   S U
S-   5       HZ  u  nnUU4U;   d  UU4U;   a  M  UU   nU R                  UU5      (       a  UR                  UU45        UR                  UU45        M\     M}     [        S[        U5       35        [        S5        [        U5       Ha  u  nu  nnUS-  S:X  a  [        SU S[        U5       S35        U R                  UU5      nUS   nUU:Â¼  d  ML  UR                  UUUU45        Mc     UR                  S SS9  U$ )uG   
ÃÂÃÂ¿Ã‘Â‚ÃÂ¸ÃÂ¼ÃÂ¸ÃÂ·ÃÂ¸Ã‘Â€ÃÂ¾ÃÂ²ÃÂ°ÃÂ½ÃÂ½Ã‘Â‹ÃÂ¹ ÃÂ¿ÃÂ¾ÃÂ¸Ã‘ÂÃÂº ÃÂ¿ÃÂ¾Ã‘Â…ÃÂ¾ÃÂ¶ÃÂ¸Ã‘Â… ÃÂ²ÃÂ¸ÃÂ´ÃÂµÃÂ¾
u   Ã°ÂŸÂ”Â ÃÂÃÂ½ÃÂ°ÃÂ»ÃÂ¸ÃÂ·ÃÂ¸Ã‘Â€Ã‘ÂƒÃÂµÃÂ¼ u    ÃÂ²ÃÂ¸ÃÂ´ÃÂµÃÂ¾Ã‘Â„ÃÂ°ÃÂ¹ÃÂ»ÃÂ¾ÃÂ²...u-   Ã°ÂŸÂ“ÂŠ ÃÂ¡ÃÂ¾ÃÂ±ÃÂ¸Ã‘Â€ÃÂ°ÃÂµÃÂ¼ ÃÂ¼ÃÂµÃ‘Â‚ÃÂ°ÃÂ´ÃÂ°ÃÂ½ÃÂ½Ã‘Â‹ÃÂµ...u0   Ã°ÂŸÂÂ¯ ÃÂ˜Ã‘Â‰ÃÂµÃÂ¼ Ã‘Â‚ÃÂ¾Ã‘Â‡ÃÂ½Ã‘Â‹ÃÂµ ÃÂ´Ã‘ÂƒÃÂ±ÃÂ»ÃÂ¸ÃÂºÃÂ°Ã‘Â‚Ã‘Â‹...r0   Ã©   g      Ã°?ÃštypeÃšexact_duplicateu3   Ã¢ÂšÂ¡ ÃÂ¤ÃÂ¸ÃÂ»Ã‘ÂŒÃ‘Â‚Ã‘Â€Ã‘ÂƒÃÂµÃÂ¼ ÃÂ¿ÃÂ¾ ÃÂ¼ÃÂµÃ‘Â‚ÃÂ°ÃÂ´ÃÂ°ÃÂ½ÃÂ½Ã‘Â‹ÃÂ¼...NuD   Ã°ÂŸÂÂ¯ ÃÂšÃÂ°ÃÂ½ÃÂ´ÃÂ¸ÃÂ´ÃÂ°Ã‘Â‚ÃÂ¾ÃÂ² ÃÂ´ÃÂ»Ã‘Â ÃÂ³ÃÂ»Ã‘ÂƒÃÂ±ÃÂ¾ÃÂºÃÂ¾ÃÂ³ÃÂ¾ ÃÂ°ÃÂ½ÃÂ°ÃÂ»ÃÂ¸ÃÂ·ÃÂ°: u8   Ã°ÂŸÂ”Â ÃÂ—ÃÂ°ÃÂ¿Ã‘ÂƒÃ‘ÂÃÂºÃÂ°ÃÂµÃÂ¼ ÃÂ³ÃÂ»Ã‘ÂƒÃÂ±ÃÂ¾ÃÂºÃÂ¸ÃÂ¹ ÃÂ°ÃÂ½ÃÂ°ÃÂ»ÃÂ¸ÃÂ·...Ã©
   r   u   Ã°ÂŸÂ“Âˆ ÃÂÃÂ±Ã‘Â€ÃÂ°ÃÂ±ÃÂ¾Ã‘Â‚ÃÂ°ÃÂ½ÃÂ¾ Ãš/u
    ÃÂ¿ÃÂ°Ã‘Â€...Ãš
similarityc                 Ã³   Â• U S   $ )NÃ©   Â© )Ãšxs    r   Ãš<lambda>ÃšHOptimizedVideoComparator.find_similar_videos_optimized.<locals>.<lambda>Â¦   s   Â€ Â¨Â¨1Âªr   T)ÃškeyÃšreverse)r   r,   Ãšlenr>   ÃšitemsÃšappendÃšrangeÃšsetÃš	enumeraterM   ÃšaddÃšcompare_videosÃšsort)r   rO   r   Ãšsimilar_pairsÃšvideo_metadatar4   Ãšhash_groupsÃšmetar0   ÃšgroupÃšiÃšjÃšcandidate_pairsÃšprocessed_pairsÃšvideo1rE   Ãšvideo2rF   ÃšidxÃšresultrV   s                        r   Ãšfind_similar_videos_optimizedÃš6OptimizedVideoComparator.find_similar_videos_optimizedc   sÂ™  Â€ Ã° %9Ã”!Ã˜ÂˆÃ¤Ã,Â¬SÂ°Ã“-=Ã,>Ã>XÃYÃ”ZÃ´ 	Ã=Ã”>Ã˜ÂˆÃ›%ÂˆJÃ˜)-Ã—)AÃ‘)AÃ€*Ã“)MÂˆNÃ“&Ã± &Ã´ 	Ã@Ã”AÃ˜ÂˆÃ˜ .Ã— 4Ã‘ 4Ã– 6Ã‘ÂˆJÃ˜ÂKÃ— Ã‘ Ã˜Â˜Ã‘$Â¨KÃ“7Ã˜57ÂKÂ [Ã‘ 1Ã‘2Ã˜Â Ã‘-Ã‘.Ã—5Ã‘5Â°jÃ–AÃ±	 !7Ã° !,Ã— 1Ã‘ 1Ã– 3Ã‘ÂˆIÃœÂ5Â‹zÂ˜AÂ~ÃœÂœsÂ 5Â›zÃ–*ÂAÃœ"Â 1Â qÂ¡5Â¬#Â¨eÂ«*Ã–5Â˜Ã˜%Ã—,Ã‘,Â¨eÂ©hÂ¸Â¹Ã€#ÃˆÃPaÃGbÃ-cÃ–dÃ³ 6Ã³ +Ã± !4Ã´ 	ÃCÃ”DÃ˜ÂˆÃœÂ›%ÂˆÃ¤"Â ;Ã–/Â‰IÂˆAÃ˜"Ã‘*ÂˆEÃ¤&Â {Â°qÂ±5Â°6Ã':Â¸AÃ€Â¹EÃ–BÂ‘	ÂÂ6Ã Â˜FÃ#Â Ã“6Â¸6Ã€6Ã:JÃˆoÃ“:]Ã™Ã &Â vÃ‘.ÂÃ° Ã—-Ã‘-Â¨eÂ°UÃ—;Ã‘;Ã˜#Ã—*Ã‘*Â¨FÂ°FÃ+;Ã”<Ã Ã—#Ã‘#Â VÂ¨VÃ$4Ã–5Ã³ CÃ± 0Ã´  	ÃTÃ”UXÃYhÃ“UiÃTjÃkÃ”lÃ´ 	ÃHÃ”IÃœ%.Â¨Ã–%?Ã‘!ÂˆCÃ‘!Â&Â˜&Ã˜ÂRÂ‰xÂ˜1Â‹}ÃœÃ2Â°3Â°%Â°qÂ¼Â¸_Ã“9MÃ8NÃˆjÃYÃ”ZÃ Ã—(Ã‘(Â¨Â°Ã“8ÂˆFÃ˜Â Ã‘-ÂˆJÃ Ã1Ã•1Ã˜Ã—$Ã‘$Â fÂ¨fÂ°jÃ€&Ã%IÃ–JÃ± &@Ã° 	Ã—Ã‘Â™~Â°tÃÃ‘<Ã Ãr   Ãšvideo_path1Ãšvideo_path2c                 Ã³"  Â• U R                  U5      nU R                  U5      nU(       a  U(       d  SS0 S.$ / nSnSn[        [        U5      [        U5      S5      n[        U5       H  n	U	[        U5      :  a  X9   OUS   n
U	[        U5      :  a  XI   OUS   nU R                  R                  XÂ«5      nUR                  SS5      nUR                  U	U	UUS.5        Xm-  nUS-  nMÂ     US:Â”  a  Xg-  OSnUU[        U5      [        U5      S	.S
.$ )uI   
ÃÂÃÂ¿Ã‘Â‚ÃÂ¸ÃÂ¼ÃÂ¸ÃÂ·ÃÂ¸Ã‘Â€ÃÂ¾ÃÂ²ÃÂ°ÃÂ½ÃÂ½ÃÂ¾ÃÂµ Ã‘ÂÃ‘Â€ÃÂ°ÃÂ²ÃÂ½ÃÂµÃÂ½ÃÂ¸ÃÂµ ÃÂ´ÃÂ²Ã‘ÂƒÃ‘Â… ÃÂ²ÃÂ¸ÃÂ´ÃÂµÃÂ¾
g        u-   ÃÂÃÂµ Ã‘ÂƒÃÂ´ÃÂ°ÃÂ»ÃÂ¾Ã‘ÂÃ‘ÂŒ ÃÂ¸ÃÂ·ÃÂ²ÃÂ»ÃÂµÃ‘Â‡Ã‘ÂŒ ÃÂºÃÂ°ÃÂ´Ã‘Â€Ã‘Â‹)rV   ÃšerrorÃšdetailsr   r   Ãšoverall)Ãšframe1_indexÃšframe2_indexrV   Ãšalgorithm_detailsrQ   )rq   rr   )rV   Ãšframe_comparisonsÃšframes_extracted)rC   rH   r_   rb   r   Ãšcompare_imagesr;   ra   )r   rw   rx   Ãšframes1Ãšframes2rÂ€   Ãštotal_similarityÃšcompared_pairsÃšmax_comparisonsrm   Ãšframe1Ãšframe2Ãšcomparison_resultrV   Ãšoverall_similaritys                  r   rf   Ãš'OptimizedVideoComparator.compare_videosÂª   sA  Â€ Ã°
 Ã—)Ã‘)Â¨+Ã“6ÂˆÃ˜Ã—)Ã‘)Â¨+Ã“6ÂˆÃ¦ÂgÃ !Ã˜HÃ˜Ã±Ã° Ã° ÃÃ˜ÃÃ˜ÂˆÃ´ ÂœcÂ 'Â›lÂ¬CÂ°Â«LÂ¸!Ã“<ÂˆÃ¤ÂÃ–'ÂˆAÃ˜#$Â¤sÂ¨7Â£|Ã“#3ÂWÂ’ZÂ¸Ã€Â¹ÂˆFÃ˜#$Â¤sÂ¨7Â£|Ã“#3ÂWÂ’ZÂ¸Ã€Â¹ÂˆFÃ  $Ã— 7Ã‘ 7Ã— FÃ‘ FÃ€vÃ“ VÃÃ˜*Ã—.Ã‘.Â¨yÂ¸#Ã“>ÂˆJÃ Ã—$Ã‘$Ã˜ !Ã˜ !Ã˜(Ã˜%6Ã±	&Ã´ Ã° Ã‘*ÃÃ˜Â˜aÃ‘ÂŠNÃ± (Ã°$ CQÃSTÃ“BTÃ-Ã’>ÃZ]ÃÃ° -Ã˜!2Ã¤Â˜gÂ›,ÃœÂ˜gÂ›,Ã±!Ã±
Ã° 	
r   c                 Ã³Â    Â• U R                   R                  5         U R                  R                  5         U R                  R                  5         g)u   ÃÂÃ‘Â‡ÃÂ¸Ã‘Â‰ÃÂ°ÃÂµÃ‘Â‚ ÃÂºÃ‘ÂÃ‘ÂˆÃÂ¸N)r   Ãšclearr   r   r   s    r   Ãšclear_cacheÃš$OptimizedVideoComparator.clear_cacheÃ   s8   Â€ Ã Ã—Ã‘Ã—Ã‘Ã”!Ã˜Ã—Ã‘Ã—"Ã‘"Ã”$Ã˜Ã—Ã‘Ã—#Ã‘#Ã•%r   )r   r   r   r   r   r   r   N)r   )Ãš__name__Ãš
__module__Ãš__qualname__Ãš__firstlineno__Ãš__doc__r   r&   r2   r   r>   r   rC   ÃšboolrM   Ãšfloatr   ru   rf   rÂ   Ãš__static_attributes__rY   r   r   r
   r
      sÂª   Â† Ã±Ã²	#Ã°Â¨Ã° Â°Ã´ Ã°,Â¨cÃ° Â°dÃ´ Ã°"Â¨SÃ° Â°TÃ´ Ã°Â¨4Ã° Â¸Ã° Ã€Ã´ Ã±6EÂ¸Â¸cÂ¹Ã° EÃZ_Ã° EÃjnÃotÃ‘juÃµ EÃ°N2
Â¨#Ã° 2
Â¸CÃ° 2
Ã€DÃ´ 2
Ãµh&r   r
   )r!   r(   Ãštypingr   r   r   r   Ãšsrc.core.frame_extractorr   Ãš!src.algorithms.comparison_managerr   r
   rY   r   r   Ãš<module>rÂœ      s#   Ã°Ã› 	Ã› ÃŸ .Ã“ .Ã 3Ã ?Ã·Z&Ã² Z&r   


core\__pycache__\video_comparator.cpython-313.pyc

Ã³
    oi  Ã£                   Ã³L   Â• S SK r S SKJrJrJr  S SKJr  S SKJr   " S S5      r	g)Ã©    N)ÃšListÃšDictÃšTuple)ÃšComparisonManager)ÃšFrameExtractorc                   Ã³Z   Â• \ rS rSrSrS rS\S\S\4S jrSS\	\   S	\
S\	\   4S
 jjrSrg)ÃšVideoComparatorÃ©	   uk   ÃÂ¡Ã‘Â€ÃÂ°ÃÂ²ÃÂ½ÃÂ¸ÃÂ²ÃÂ°ÃÂµÃ‘Â‚ ÃÂ´ÃÂ²ÃÂ° ÃÂ²ÃÂ¸ÃÂ´ÃÂµÃÂ¾Ã‘Â„ÃÂ°ÃÂ¹ÃÂ»ÃÂ° ÃÂ¸Ã‘ÂÃÂ¿ÃÂ¾ÃÂ»Ã‘ÂŒÃÂ·Ã‘ÂƒÃ‘Â ÃÂ½ÃÂµÃ‘ÂÃÂºÃÂ¾ÃÂ»Ã‘ÂŒÃÂºÃÂ¾ ÃÂ°ÃÂ»ÃÂ³ÃÂ¾Ã‘Â€ÃÂ¸Ã‘Â‚ÃÂ¼ÃÂ¾ÃÂ²c                 Ã³N   Â• [        5       U l        [        5       U l        SU l        g )NÃ©   )r   Ãšframe_extractorr   Ãšcomparison_managerÃšnum_frames_to_compare)Ãšselfs    ÃšLF:\Programs\PythonProject\VideoDuplicateCleaner\src\core\video_comparator.pyÃš__init__ÃšVideoComparator.__init__   s    Â€ Ãœ-Ã“/ÂˆÃ”Ãœ"3Ã“"5ÂˆÃ”Ã˜%&ÂˆÃ•"Ã³    Ãšvideo_path1Ãšvideo_path2Ãšreturnc                 Ã³Â  Â• [        S[        R                  R                  U5       S[        R                  R                  U5       35        U R                  R                  XR                  5      nU R                  R                  X R                  5      nU(       a  U(       d  SS0 S.$ [        S[        U5       S[        U5       S35        / nSnS	n[        U5       H}  u  pÂ‰Sn
0 n[        U5       HB  u  pÃU R                  R                  XÂ5      nUR                  S
S5      nXÃº:Â”  d  M9  Un
UUUUS.nMD     U(       d  Mc  UR                  U5        Xj-  nUS-  nM     US	:Â”  a  Xg-  OSnUU[        U5      [        U5      S.U R                  R                   Vs0 s H  nUR                  UR                  _M     snS.$ s  snf )uÂ   
ÃÂ¡Ã‘Â€ÃÂ°ÃÂ²ÃÂ½ÃÂ¸ÃÂ²ÃÂ°ÃÂµÃ‘Â‚ ÃÂ´ÃÂ²ÃÂ° ÃÂ²ÃÂ¸ÃÂ´ÃÂµÃÂ¾Ã‘Â„ÃÂ°ÃÂ¹ÃÂ»ÃÂ°
ÃÂ’ÃÂ¾ÃÂ·ÃÂ²Ã‘Â€ÃÂ°Ã‘Â‰ÃÂ°ÃÂµÃ‘Â‚ ÃÂ´ÃÂµÃ‘Â‚ÃÂ°ÃÂ»ÃÂ¸ÃÂ·ÃÂ¸Ã‘Â€ÃÂ¾ÃÂ²ÃÂ°ÃÂ½ÃÂ½Ã‘Â‹ÃÂµ Ã‘Â€ÃÂµÃÂ·Ã‘ÂƒÃÂ»Ã‘ÂŒÃ‘Â‚ÃÂ°Ã‘Â‚Ã‘Â‹ Ã‘ÂÃ‘Â€ÃÂ°ÃÂ²ÃÂ½ÃÂµÃÂ½ÃÂ¸Ã‘Â
u!   ÃÂ¡Ã‘Â€ÃÂ°ÃÂ²ÃÂ½ÃÂ¸ÃÂ²ÃÂ°ÃÂµÃÂ¼ ÃÂ²ÃÂ¸ÃÂ´ÃÂµÃÂ¾: Ãµ    ÃÂ¸ g        uO   ÃÂÃÂµ Ã‘ÂƒÃÂ´ÃÂ°ÃÂ»ÃÂ¾Ã‘ÂÃ‘ÂŒ ÃÂ¸ÃÂ·ÃÂ²ÃÂ»ÃÂµÃ‘Â‡Ã‘ÂŒ ÃÂºÃÂ°ÃÂ´Ã‘Â€Ã‘Â‹ ÃÂ¸ÃÂ· ÃÂ¾ÃÂ´ÃÂ½ÃÂ¾ÃÂ³ÃÂ¾ ÃÂ¸ÃÂ· ÃÂ²ÃÂ¸ÃÂ´ÃÂµÃÂ¾)Ãš
similarityÃšerrorÃšdetailsu   ÃÂ˜ÃÂ·ÃÂ²ÃÂ»ÃÂµÃ‘Â‡ÃÂµÃÂ½ÃÂ¾ u0    ÃÂºÃÂ°ÃÂ´Ã‘Â€ÃÂ¾ÃÂ² ÃÂ¸ÃÂ· ÃÂ¿ÃÂµÃ‘Â€ÃÂ²ÃÂ¾ÃÂ³ÃÂ¾ ÃÂ²ÃÂ¸ÃÂ´ÃÂµÃÂ¾ ÃÂ¸ u    ÃÂ¸ÃÂ· ÃÂ²Ã‘Â‚ÃÂ¾Ã‘Â€ÃÂ¾ÃÂ³ÃÂ¾r   Ãšoverall)Ãšframe1_indexÃšframe2_indexr   Ãšalgorithm_detailsÃ©   )Ãšvideo1Ãšvideo2)r   Ãšframe_comparisonsÃšframes_extractedÃšalgorithm_weights)ÃšprintÃšosÃšpathÃšbasenamer   Ãšextract_framesr   ÃšlenÃš	enumerater   Ãšcompare_imagesÃšgetÃšappendÃšcomparatorsÃšnameÃšweight)r   r   r   Ãšframes1Ãšframes2r$   Ãštotal_similarityÃšcompared_pairsÃšiÃšframe1Ãšbest_similarityÃšbest_comparison_detailsÃšjÃšframe2Ãšcomparison_resultr   Ãšoverall_similarityÃšcomps                     r   Ãšcompare_videosÃšVideoComparator.compare_videos   sÃª  Â€ Ã´
 	Ã1Â´"Â·'Â±'Ã—2BÃ‘2BÃ€;Ã“2OÃ1PÃPTÃ”UWÃ—U\Ã‘U\Ã—UeÃ‘UeÃfqÃ“UrÃTsÃtÃ”uÃ° Ã—&Ã‘&Ã—5Ã‘5Â°kÃ—C]Ã‘C]Ã“^ÂˆÃ˜Ã—&Ã‘&Ã—5Ã‘5Â°kÃ—C]Ã‘C]Ã“^ÂˆÃ¦ÂgÃ !Ã˜jÃ˜Ã±Ã° Ã´ 	Ã#Â¤CÂ¨Â£LÂ >Ã1aÃ”beÃfmÃ“bnÃaoÃ°  pDÃ°  EÃ´  	FÃ° ÃÃ˜ÃÃ˜ÂˆÃ¤"Â 7Ã–+Â‰IÂˆAÃ˜!ÂˆOÃ˜&(Ã#Ã¤&Â wÃ–/Â‘	ÂÃ $(Ã—$;Ã‘$;Ã—$JÃ‘$JÃˆ6Ã“$ZÃ!Ã˜.Ã—2Ã‘2Â°9Â¸cÃ“BÂ
Ã Ã•/Ã˜&0ÂOÃ ()Ã˜()Ã˜&0Ã˜->Ã±	/Ã’+Ã± 0Ã· 'Ã&Ã˜!Ã—(Ã‘(Ã)@Ã”AÃ˜ Ã‘3Ã Ã˜Â !Ã‘#Â’Ã±+ ,Ã°0 CQÃSTÃ“BTÃ-Ã’>ÃZ]ÃÃ° -Ã˜!2Ã¤Â˜gÂ›,ÃœÂ˜gÂ›,Ã±!Ã° FJÃ—E\Ã‘E\Ã—EhÃ’EhÃ“!iÃ’EhÂ¸TÂ $Â§)Â¡)Â¨TÂ¯[Â©[Ã’"8Ã‘EhÃ‘!iÃ±
Ã° 	
Ã¹Ã² "js   Ã†!G
Ãšvideo_filesÃšsimilarity_thresholdc                 Ã³ÃŠ  Â• / n[        [        U5      5       HÂ·  n[        US-   [        U5      5       HÂ˜  nX   nX   n[        SUS-    S[        U5       S[        R                  R                  U5       S[        R                  R                  U5       35        U R                  Xg5      nUS   n	XÂ’:Â¼  d  MÂ…  UR                  XgXÂ˜45        MÂš     MÂ¹     UR                  S SS	9  U$ )
uÂŸ   
ÃÂÃÂ°Ã‘Â…ÃÂ¾ÃÂ´ÃÂ¸Ã‘Â‚ ÃÂ¿ÃÂ¾Ã‘Â…ÃÂ¾ÃÂ¶ÃÂ¸ÃÂµ ÃÂ²ÃÂ¸ÃÂ´ÃÂµÃÂ¾ Ã‘ÂÃ‘Â€ÃÂµÃÂ´ÃÂ¸ Ã‘ÂÃÂ¿ÃÂ¸Ã‘ÂÃÂºÃÂ° Ã‘Â„ÃÂ°ÃÂ¹ÃÂ»ÃÂ¾ÃÂ²
ÃÂ’ÃÂ¾ÃÂ·ÃÂ²Ã‘Â€ÃÂ°Ã‘Â‰ÃÂ°ÃÂµÃ‘Â‚ Ã‘ÂÃÂ¿ÃÂ¸Ã‘ÂÃÂ¾ÃÂº ÃÂºÃÂ¾Ã‘Â€Ã‘Â‚ÃÂµÃÂ¶ÃÂµÃÂ¹ (video1, video2, similarity)
r!   u   ÃÂ¡Ã‘Â€ÃÂ°ÃÂ²ÃÂ½ÃÂ¸ÃÂ²ÃÂ°ÃÂµÃÂ¼ Ãš/z: r   r   c                 Ã³   Â• U S   $ )NÃ©   Â© )Ãšxs    r   Ãš<lambda>Ãš5VideoComparator.find_similar_videos.<locals>.<lambda>c   s   Â€ Â¨Â¨1Âªr   T)ÃškeyÃšreverse)	Ãšranger,   r'   r(   r)   r*   rA   r0   Ãšsort)
r   rC   rD   Ãšsimilar_pairsr8   r<   r"   r#   Ãšresultr   s
             r   Ãšfind_similar_videosÃš#VideoComparator.find_similar_videosN   sÃ³   Â€ Ã°
 ÂˆÃ¤Â”sÂ˜;Ã“'Ã–(ÂˆAÃœÂ˜1Â˜qÂ™5Â¤#Â kÃ“"2Ã–3ÂÃ˜$Â™ÂÃ˜$Â™ÂÃ¤Ã-Â¨aÂ°!Â©eÂ¨WÂ°AÂ´cÂ¸+Ã“6FÃ5GÃ€rÃŒ"Ã'Ã‰'Ã—JZÃ‘JZÃ[aÃ“JbÃIcÃcgÃ”hjÃ—hoÃ‘hoÃ—hxÃ‘hxÃyÃ³  iAÃ°  hBÃ°  CÃ´  DÃ Ã—,Ã‘,Â¨VÃ“<ÂÃ˜#Â LÃ‘1Â
Ã Ã•5Ã˜!Ã—(Ã‘(Â¨&Â¸*Ã)MÃ–NÃ³ 4Ã± )Ã° 	Ã—Ã‘Â™~Â°tÃÃ‘<Ã Ãr   )r   r   r   N)gffffffÃ¦?)Ãš__name__Ãš
__module__Ãš__qualname__Ãš__firstlineno__Ãš__doc__r   Ãšstrr   rA   r   Ãšfloatr   rS   Ãš__static_attributes__rI   r   r   r	   r	   	   sP   Â† Ã™uÃ²'Ã°
;
Â¨#Ã° ;
Â¸CÃ° ;
Ã€DÃ´ ;
Ã±zÂ¨tÂ°CÂ©yÃ° ÃPUÃ° Ã`dÃejÃ‘`kÃ· Ã° r   r	   )
r(   Ãštypingr   r   r   Ãš!src.algorithms.comparison_managerr   Ãšsrc.core.frame_extractorr   r	   rI   r   r   Ãš<module>r`      s#   Ã°Ã› 	ÃŸ $Ã‘ $Ãµ @Ã 3Ã·\Ã² \r   


gui\__init__.py




gui\comparison_dialog.py

import os
import gc
import cv2
import numpy as np
from PyQt6.QtWidgets import (
    QDialog, QVBoxLayout, QHBoxLayout, QLabel, QPushButton,
    QTextEdit, QWidget, QProgressBar, QMessageBox
)
from PyQt6.QtCore import Qt, QThread, pyqtSignal
from PyQt6.QtGui import QPixmap, QImage


class SafeFrameExtractionThread(QThread):
    """Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ñ‹Ğ¹ Ğ¿Ğ¾Ñ‚Ğ¾Ğº Ğ´Ğ»Ñ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ñ ĞºĞ°Ğ´Ñ€Ğ¾Ğ² Ñ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ĞµĞ¼ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸"""

    progress_signal = pyqtSignal(int, str)
    frames_extracted = pyqtSignal(dict, list)  # frames_data, frame_similarities

    def __init__(self, video_paths, num_frames=10):
        super().__init__()
        self.video_paths = video_paths
        self.num_frames = num_frames

    def safe_extract_frames(self, video_path, num_frames):
        """Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾Ğµ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ°Ğ´Ñ€Ğ¾Ğ² Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¾Ğ¹ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº"""
        try:
            from src.core.frame_extractor import FrameExtractor
            extractor = FrameExtractor()
            return extractor.extract_frames(video_path, num_frames)
        except Exception as e:
            print(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğ¸ ĞºĞ°Ğ´Ñ€Ğ¾Ğ² Ğ¸Ğ· {video_path}: {e}")
            return []

    def calculate_similarities(self, frames1, frames2):
        """Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ÑĞµÑ‚ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸ Ğ¼ĞµĞ¶Ğ´Ñƒ ĞºĞ°Ğ´Ñ€Ğ°Ğ¼Ğ¸ Ñ Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ¾Ğ¹ Ğ¾Ñ‚ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº"""
        try:
            from src.algorithms.comparison_manager import ComparisonManager
            manager = ComparisonManager()

            similarities = []
            min_frames = min(len(frames1), len(frames2))

            for i in range(min_frames):
                if frames1[i] is not None and frames2[i] is not None:
                    result = manager.compare_images(frames1[i], frames2[i])
                    similarities.append(result.get('overall', 0.0))
                else:
                    similarities.append(0.0)

            return similarities
        except Exception as e:
            print(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğ¸ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚ĞµĞ¹: {e}")
            return [0.0] * min(len(frames1), len(frames2))

    def run(self):
        """ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´ Ñ Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ¾Ğ¹ Ğ¾Ñ‚ Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ğ¹"""
        try:
            results = {}
            similarities = []

            self.progress_signal.emit(0, "ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° Ğº Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ñ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²...")

            # Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµĞ¼ ĞºĞ°Ğ´Ñ€Ñ‹ Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾
            for i, video_path in enumerate(self.video_paths):
                progress = int((i / len(self.video_paths)) * 50)
                self.progress_signal.emit(progress, f"Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµĞ¼ ĞºĞ°Ğ´Ñ€Ñ‹ Ğ¸Ğ· {os.path.basename(video_path)}")

                frames = self.safe_extract_frames(video_path, self.num_frames)
                results[video_path] = frames

                # ĞŸÑ€Ğ¸Ğ½ÑƒĞ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ° Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸ Ğ¿Ğ¾ÑĞ»Ğµ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾
                gc.collect()

            # Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ÑĞµĞ¼ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸ ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ Ğ´Ğ²Ğ° Ğ²Ğ¸Ğ´ĞµĞ¾
            if len(self.video_paths) >= 2:
                self.progress_signal.emit(75, "Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ÑĞµĞ¼ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²...")
                frames1 = results.get(self.video_paths[0], [])
                frames2 = results.get(self.video_paths[1], [])
                similarities = self.calculate_similarities(frames1, frames2)

                # ĞÑ‡Ğ¸Ñ‰Ğ°ĞµĞ¼ Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ Ğ¿Ğ¾ÑĞ»Ğµ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğ¹
                gc.collect()

            self.progress_signal.emit(100, "Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾!")
            self.frames_extracted.emit(results, similarities)

        except Exception as e:
            print(f"ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ° Ğ² Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞµ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ñ: {e}")
            self.frames_extracted.emit({}, [])


class ComparisonDialog(QDialog):
    """Ğ¡Ñ‚Ğ°Ğ±Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³ Ğ´Ğ»Ñ side-by-side ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ"""

    def __init__(self, video_paths, parent=None):
        super().__init__(parent)
        self.video_paths = video_paths[:2]  # Ğ’ÑĞµĞ³Ğ´Ğ° Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ 2 Ğ²Ğ¸Ğ´ĞµĞ¾
        self.frames_data = {}
        self.frame_similarities = []
        self.current_frame_index = 0

        self.setWindowTitle("Side-by-Side Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ’Ğ¸Ğ´ĞµĞ¾")
        self.setGeometry(100, 50, 1200, 800)
        self.setup_ui()

        # Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾Ğµ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²
        self.extract_frames()

    def setup_ui(self):
        """Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ ÑÑ‚Ğ°Ğ±Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ"""
        layout = QVBoxLayout()
        self.setLayout(layout)

        # Ğ—Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº
        title_label = QLabel("ğŸ¬ Side-by-Side Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ’Ğ¸Ğ´ĞµĞ¾")
        title_label.setStyleSheet("font-size: 16pt; font-weight: bold; margin: 10px;")
        title_label.setAlignment(Qt.AlignmentFlag.AlignCenter)
        layout.addWidget(title_label)

        # ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€
        main_layout = QHBoxLayout()
        layout.addLayout(main_layout)

        # Ğ›ĞµĞ²Ğ°Ñ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ
        self.left_panel = self.create_video_panel(0)
        main_layout.addWidget(self.left_panel)

        # ĞŸÑ€Ğ°Ğ²Ğ°Ñ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ
        self.right_panel = self.create_video_panel(1)
        main_layout.addWidget(self.right_panel)

        # ĞŸÑ€Ğ¾Ğ³Ñ€ĞµÑÑ-Ğ±Ğ°Ñ€
        self.progress_bar = QProgressBar()
        self.progress_bar.setVisible(True)
        layout.addWidget(self.progress_bar)

        # Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ
        self.status_label = QLabel("ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ»Ñ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ...")
        layout.addWidget(self.status_label)

        # ĞšĞ½Ğ¾Ğ¿ĞºĞ¸ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ
        self.create_control_buttons(layout)

    def create_video_panel(self, video_index):
        """Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ Ğ´Ğ»Ñ Ğ²Ğ¸Ğ´ĞµĞ¾"""
        panel = QWidget()
        layout = QVBoxLayout()
        panel.setLayout(layout)

        # Ğ—Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº
        title = QLabel(f"Ğ’Ğ¸Ğ´ĞµĞ¾ {video_index + 1}")
        title.setStyleSheet("font-size: 14pt; font-weight: bold;")
        title.setAlignment(Qt.AlignmentFlag.AlignCenter)
        layout.addWidget(title)

        # ĞœĞµÑ‚ĞºĞ° ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸
        similarity_label = QLabel("Ğ¡Ñ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ: ---")
        similarity_label.setStyleSheet("font-weight: bold; color: blue;")
        similarity_label.setAlignment(Qt.AlignmentFlag.AlignCenter)

        if not hasattr(self, 'similarity_labels'):
            self.similarity_labels = [None, None]
        self.similarity_labels[video_index] = similarity_label
        layout.addWidget(similarity_label)

        # ĞĞ±Ğ»Ğ°ÑÑ‚ÑŒ Ğ´Ğ»Ñ ĞºĞ°Ğ´Ñ€Ğ°
        frame_label = QLabel("Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° ĞºĞ°Ğ´Ñ€Ğ°...")
        frame_label.setAlignment(Qt.AlignmentFlag.AlignCenter)
        frame_label.setMinimumSize(400, 300)
        frame_label.setStyleSheet("border: 2px solid gray; background: #f0f0f0;")

        if not hasattr(self, 'frame_labels'):
            self.frame_labels = [None, None]
        self.frame_labels[video_index] = frame_label
        layout.addWidget(frame_label)

        # Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ ĞºĞ°Ğ´Ñ€Ğµ
        frame_info = QLabel("ĞšĞ°Ğ´Ñ€: 0/0")
        frame_info.setAlignment(Qt.AlignmentFlag.AlignCenter)

        if not hasattr(self, 'frame_info_labels'):
            self.frame_info_labels = [None, None]
        self.frame_info_labels[video_index] = frame_info
        layout.addWidget(frame_info)

        # Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğµ
        file_info = QTextEdit()
        file_info.setMaximumHeight(120)
        file_info.setReadOnly(True)

        if not hasattr(self, 'file_infos'):
            self.file_infos = [None, None]
        self.file_infos[video_index] = file_info
        layout.addWidget(file_info)

        return panel

    def create_control_buttons(self, layout):
        """Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ"""
        button_layout = QHBoxLayout()

        self.prev_btn = QPushButton("â® ĞŸÑ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰Ğ¸Ğ¹")
        self.prev_btn.clicked.connect(self.previous_frame)
        self.prev_btn.setEnabled(False)
        button_layout.addWidget(self.prev_btn)

        self.next_btn = QPushButton("Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ â­")
        self.next_btn.clicked.connect(self.next_frame)
        self.next_btn.setEnabled(False)
        button_layout.addWidget(self.next_btn)

        button_layout.addStretch()

        close_btn = QPushButton("Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚ÑŒ")
        close_btn.clicked.connect(self.safe_close)
        button_layout.addWidget(close_btn)

        layout.addLayout(button_layout)

    def extract_frames(self):
        """Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾Ğµ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²"""
        self.extraction_thread = SafeFrameExtractionThread(self.video_paths, 10)
        self.extraction_thread.progress_signal.connect(self.update_progress)
        self.extraction_thread.frames_extracted.connect(self.on_frames_extracted)
        self.extraction_thread.start()

    def update_progress(self, progress, message):
        """ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ"""
        self.progress_bar.setValue(progress)
        self.status_label.setText(message)

    def on_frames_extracted(self, frames_data, frame_similarities):
        """ĞĞ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ½Ñ‹Ğµ ĞºĞ°Ğ´Ñ€Ñ‹"""
        self.frames_data = frames_data
        self.frame_similarities = frame_similarities

        self.progress_bar.setVisible(False)
        self.status_label.setText("ĞšĞ°Ğ´Ñ€Ñ‹ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ñ‹!")

        # ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğ°Ñ…
        self.update_file_info()

        # ĞĞºÑ‚Ğ¸Ğ²Ğ¸Ñ€ÑƒĞµĞ¼ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸
        self.prev_btn.setEnabled(True)
        self.next_btn.setEnabled(True)

        # ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ ĞºĞ°Ğ´Ñ€
        self.show_frame(0)

        # ĞŸÑ€Ğ¸Ğ½ÑƒĞ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ° Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸
        gc.collect()

        def update_file_info(self):
            """ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğ°Ñ…"""
            from src.core.frame_extractor import FrameExtractor
            extractor = FrameExtractor()

            for i, video_path in enumerate(self.video_paths):
                if video_path in self.frames_data and i < len(self.file_infos):
                    try:
                        # ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
                        video_info = extractor.get_video_info(video_path)
                        file_size = os.path.getsize(video_path) / (1024 * 1024)  # MB

                        info_text = f"""ğŸ“ Ğ¤Ğ°Ğ¹Ğ»: {os.path.basename(video_path)}
        ğŸ“ Ğ Ğ°Ğ·Ğ¼ĞµÑ€: {file_size:.2f} MB
        ğŸï¸ Ğ Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ: {video_info.get('width', 'N/A')}x{video_info.get('height', 'N/A')}
        â±ï¸ Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ: {video_info.get('duration', 0):.1f} ÑĞµĞº
        ğŸ“Š FPS: {video_info.get('fps', 0):.1f}
        ğŸ–¼ï¸ Ğ’ÑĞµĞ³Ğ¾ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²: {video_info.get('total_frames', 0)}
        ğŸ“‚ ĞŸÑƒÑ‚ÑŒ: {video_path}"""

                        if self.file_infos[i]:
                            self.file_infos[i].setPlainText(info_text)
                    except Exception as e:
                        print(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğ¸ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸ Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğµ: {e}")

    def show_frame(self, frame_index):
        """ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ ĞºĞ°Ğ´Ñ€ Ñ Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ¾Ğ¹ Ğ¾Ñ‚ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº"""
        try:
            self.current_frame_index = frame_index

            # ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ ĞºĞ°Ğ´Ñ€Ğµ
            max_frames = min([len(frames) for frames in self.frames_data.values()])
            frame_info = f"ĞšĞ°Ğ´Ñ€: {frame_index + 1}/{max_frames}"

            for i in range(len(self.video_paths)):
                if i < len(self.frame_info_labels) and self.frame_info_labels[i]:
                    self.frame_info_labels[i].setText(frame_info)

            # ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ
            if (frame_index < len(self.frame_similarities) and
                    hasattr(self, 'similarity_labels')):

                similarity = self.frame_similarities[frame_index]
                similarity_text = f"Ğ¡Ñ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ: {similarity:.1%}"

                for label in self.similarity_labels:
                    if label:
                        label.setText(similarity_text)

            # ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶Ğ°ĞµĞ¼ ĞºĞ°Ğ´Ñ€Ñ‹
            for i, video_path in enumerate(self.video_paths):
                if (video_path in self.frames_data and
                        frame_index < len(self.frames_data[video_path]) and
                        i < len(self.frame_labels)):
                    frame = self.frames_data[video_path][frame_index]
                    self.safe_display_frame(frame, self.frame_labels[i])

        except Exception as e:
            print(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¸ ĞºĞ°Ğ´Ñ€Ğ°: {e}")

    def safe_display_frame(self, frame, label):
        """Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾Ğµ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ ĞºĞ°Ğ´Ñ€Ğ°"""
        try:
            if frame is None:
                label.setText("ĞšĞ°Ğ´Ñ€ Ğ½Ğµ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½")
                return

            # ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼ BGR Ğ² RGB
            frame_rgb = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)

            # ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ñ‹
            h, w, ch = frame_rgb.shape
            bytes_per_line = ch * w

            # Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ QImage
            q_img = QImage(frame_rgb.data, w, h, bytes_per_line, QImage.Format.Format_RGB888)

            # ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼ Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ
            pixmap = QPixmap.fromImage(q_img)
            scaled_pixmap = pixmap.scaled(400, 300, Qt.AspectRatioMode.KeepAspectRatio,
                                          Qt.TransformationMode.SmoothTransformation)

            label.setPixmap(scaled_pixmap)

        except Exception as e:
            label.setText(f"ĞÑˆĞ¸Ğ±ĞºĞ°: {str(e)}")

    def next_frame(self):
        """Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ĞºĞ°Ğ´Ñ€"""
        max_frames = min([len(frames) for frames in self.frames_data.values()])
        if self.current_frame_index < max_frames - 1:
            self.show_frame(self.current_frame_index + 1)

    def previous_frame(self):
        """ĞŸÑ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰Ğ¸Ğ¹ ĞºĞ°Ğ´Ñ€"""
        if self.current_frame_index > 0:
            self.show_frame(self.current_frame_index - 1)

    def safe_close(self):
        """Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾Ğµ Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ"""
        try:
            # ĞÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ¿Ğ¾Ñ‚Ğ¾Ğº ĞµÑĞ»Ğ¸ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
            if hasattr(self, 'extraction_thread') and self.extraction_thread.isRunning():
                self.extraction_thread.terminate()
                self.extraction_thread.wait()

            # ĞÑ‡Ğ¸Ñ‰Ğ°ĞµĞ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
            self.frames_data.clear()
            self.frame_similarities.clear()

            # ĞŸÑ€Ğ¸Ğ½ÑƒĞ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ° Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸
            gc.collect()

            self.close()

        except Exception as e:
            print(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚Ğ¸Ğ¸: {e}")
            self.close()

    def closeEvent(self, event):
        """ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚Ğ¸Ñ Ğ¾ĞºĞ½Ğ°"""
        self.safe_close()
        event.accept()


gui\safe_comparison_dialog.py

import os
from PyQt6.QtWidgets import (
    QDialog, QVBoxLayout, QHBoxLayout, QLabel, QPushButton,
    QTextEdit, QWidget, QProgressBar, QMessageBox
)
from PyQt6.QtCore import Qt, QThread, pyqtSignal


class SafeComparisonDialog(QDialog):
    """Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³Ğ° ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ñ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ½Ñ‹Ğ¼ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸"""

    def __init__(self, video_paths, parent=None):
        super().__init__(parent)
        self.video_paths = video_paths[:2]  # Ğ‘ĞµÑ€ĞµĞ¼ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¿ĞµÑ€Ğ²Ñ‹Ğµ 2 Ğ²Ğ¸Ğ´ĞµĞ¾

        self.setWindowTitle("Side-by-Side Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ’Ğ¸Ğ´ĞµĞ¾ (Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ñ‹Ğ¹ Ñ€ĞµĞ¶Ğ¸Ğ¼)")
        self.setGeometry(100, 50, 1000, 700)
        self.setup_ui()

        self.load_video_info()

    def setup_ui(self):
        """Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ ÑƒĞ¿Ñ€Ğ¾Ñ‰ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ"""
        layout = QVBoxLayout()
        self.setLayout(layout)

        # Ğ—Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº
        title_label = QLabel("ğŸ¬ Side-by-Side Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ’Ğ¸Ğ´ĞµĞ¾")
        title_label.setStyleSheet("font-size: 16pt; font-weight: bold; margin: 10px;")
        title_label.setAlignment(Qt.AlignmentFlag.AlignCenter)
        layout.addWidget(title_label)

        # Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğ¸
        info_text = QTextEdit()
        info_text.setPlainText(self.get_comparison_info())
        info_text.setReadOnly(True)
        layout.addWidget(info_text)

        # ĞšĞ½Ğ¾Ğ¿ĞºĞ¸
        button_layout = QHBoxLayout()

        extract_btn = QPushButton("ğŸ“¸ Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ÑŒ Ğ¸ ÑÑ€Ğ°Ğ²Ğ½Ğ¸Ñ‚ÑŒ ĞºĞ°Ğ´Ñ€Ñ‹")
        extract_btn.clicked.connect(self.extract_and_compare)
        button_layout.addWidget(extract_btn)

        close_btn = QPushButton("Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚ÑŒ")
        close_btn.clicked.connect(self.close)
        button_layout.addWidget(close_btn)

        layout.addLayout(button_layout)

        # ĞĞ±Ğ»Ğ°ÑÑ‚ÑŒ Ğ´Ğ»Ñ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²
        self.results_text = QTextEdit()
        self.results_text.setPlaceholderText("Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾ÑĞ²ÑÑ‚ÑÑ Ğ·Ğ´ĞµÑÑŒ...")
        self.results_text.setReadOnly(True)
        layout.addWidget(self.results_text)

    def get_comparison_info(self):
        """ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ ÑÑ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼Ñ‹Ñ… Ñ„Ğ°Ğ¹Ğ»Ğ°Ñ…"""
        from src.core.frame_extractor import FrameExtractor
        extractor = FrameExtractor()

        info = "Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹:\n\n"

        for i, video_path in enumerate(self.video_paths):
            video_info = extractor.get_video_info(video_path)
            file_size = os.path.getsize(video_path) / (1024 * 1024)

            info += f"Ğ’Ğ¸Ğ´ĞµĞ¾ {i + 1}:\n"
            info += f"ğŸ“ Ğ¤Ğ°Ğ¹Ğ»: {os.path.basename(video_path)}\n"
            info += f"ğŸ“ Ğ Ğ°Ğ·Ğ¼ĞµÑ€: {file_size:.2f} MB\n"
            info += f"ğŸï¸ Ğ Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ: {video_info.get('width', 'N/A')}x{video_info.get('height', 'N/A')}\n"
            info += f"â±ï¸ Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ: {video_info.get('duration', 0):.1f} ÑĞµĞº\n"
            info += f"ğŸ“Š FPS: {video_info.get('fps', 0):.1f}\n"
            info += f"ğŸ–¼ï¸ Ğ’ÑĞµĞ³Ğ¾ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²: {video_info.get('total_frames', 0)}\n\n"

        info += "âš ï¸ Ğ ĞµĞ¶Ğ¸Ğ¼: Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ñ‹Ğ¹ (Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ½Ğ°Ñ Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ)\n"
        info += "ğŸ” Ğ‘ÑƒĞ´ĞµÑ‚ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¾ Ğ¸ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¾ Ğ¿Ğ¾ 5 ĞºĞ°Ğ´Ñ€Ğ¾Ğ² Ğ¸Ğ· ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾"

        return info

    def extract_and_compare(self):
        """Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµÑ‚ Ğ¸ ÑÑ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµÑ‚ ĞºĞ°Ğ´Ñ€Ñ‹"""
        try:
            from src.core.frame_extractor import FrameExtractor
            from src.core.video_comparator import VideoComparator

            self.results_text.append("ğŸ”„ ĞĞ°Ñ‡Ğ¸Ğ½Ğ°ĞµĞ¼ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²...")

            extractor = FrameExtractor()
            comparator = VideoComparator()

            # Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµĞ¼ ĞºĞ°Ğ´Ñ€Ñ‹ Ñ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸ĞµĞ¼
            frames_data = {}
            for video_path in self.video_paths:
                frames = extractor.extract_frames(video_path, 5)  # Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ 5 ĞºĞ°Ğ´Ñ€Ğ¾Ğ² Ğ´Ğ»Ñ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸
                frames_data[video_path] = frames
                self.results_text.append(f"âœ… Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¾ {len(frames)} ĞºĞ°Ğ´Ñ€Ğ¾Ğ² Ğ¸Ğ· {os.path.basename(video_path)}")

            # Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ²Ğ¸Ğ´ĞµĞ¾
            self.results_text.append("\nğŸ” Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ²Ğ¸Ğ´ĞµĞ¾...")
            result = comparator.compare_videos(self.video_paths[0], self.video_paths[1])

            # ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹
            self.results_text.append(f"\nğŸ“Š Ğ Ğ•Ğ—Ğ£Ğ›Ğ¬Ğ¢ĞĞ¢Ğ« Ğ¡Ğ ĞĞ’ĞĞ•ĞĞ˜Ğ¯:")
            self.results_text.append(f"ğŸ¯ ĞĞ±Ñ‰Ğ°Ñ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ: {result['similarity']:.2%}")

            if 'frame_comparisons' in result:
                self.results_text.append(f"ğŸ” Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¾ Ğ¿Ğ°Ñ€ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²: {len(result['frame_comparisons'])}")

                for i, comparison in enumerate(result['frame_comparisons'][:3]):  # ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¿ĞµÑ€Ğ²Ñ‹Ğµ 3
                    self.results_text.append(f"\nĞšĞ°Ğ´Ñ€ {i + 1}: ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ {comparison['similarity']:.2%}")

            self.results_text.append("\nâœ… Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¾!")

        except Exception as e:
            self.results_text.append(f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ°: {str(e)}")


gui\simple_comparison_dialog.py

import os
from PyQt6.QtWidgets import (
    QDialog, QVBoxLayout, QHBoxLayout, QLabel, QPushButton,
    QTextEdit, QTabWidget, QWidget
)
from PyQt6.QtCore import Qt


class SimpleComparisonDialog(QDialog):
    """Ğ£Ğ¿Ñ€Ğ¾Ñ‰ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³ Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸"""

    def __init__(self, video_paths, parent=None):
        super().__init__(parent)
        self.video_paths = video_paths

        self.setWindowTitle("Side-by-Side Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ (Ğ¢ĞµÑÑ‚)")
        self.setGeometry(100, 100, 800, 600)
        self.setup_ui()

    def setup_ui(self):
        """Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ ÑƒĞ¿Ñ€Ğ¾Ñ‰ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ"""
        layout = QVBoxLayout()
        self.setLayout(layout)

        # Ğ—Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº
        title = QLabel("ğŸ¬ Side-by-Side Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ’Ğ¸Ğ´ĞµĞ¾")
        title.setStyleSheet("font-size: 16pt; font-weight: bold;")
        title.setAlignment(Qt.AlignmentFlag.AlignCenter)
        layout.addWidget(title)

        # Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğ°Ñ…
        info_text = QTextEdit()
        info_text.setPlainText(
            f"Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ Ñ„Ğ°Ğ¹Ğ»Ñ‹:\n"
            f"1. {os.path.basename(self.video_paths[0])}\n"
            f"2. {os.path.basename(self.video_paths[1])}\n\n"
            f"ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ğ±ÑƒĞ´ĞµÑ‚ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ° Ğ¿Ğ¾Ğ·Ğ¶Ğµ."
        )
        info_text.setReadOnly(True)
        layout.addWidget(info_text)

        # ĞšĞ½Ğ¾Ğ¿ĞºĞ¸
        button_layout = QHBoxLayout()

        test_btn = QPushButton("Ğ¢ĞµÑÑ‚: ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ")
        test_btn.clicked.connect(self.show_info)
        button_layout.addWidget(test_btn)

        close_btn = QPushButton("Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚ÑŒ")
        close_btn.clicked.connect(self.close)
        button_layout.addWidget(close_btn)

        layout.addLayout(button_layout)

    def show_info(self):
        """ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğ°Ñ…"""
        info = "Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğ°Ñ…:\n\n"
        for i, path in enumerate(self.video_paths):
            if os.path.exists(path):
                size = os.path.getsize(path) / (1024 * 1024)  # MB
                info += f"Ğ¤Ğ°Ğ¹Ğ» {i + 1}: {os.path.basename(path)}\n"
                info += f"Ğ Ğ°Ğ·Ğ¼ĞµÑ€: {size:.2f} MB\n"
                info += f"ĞŸÑƒÑ‚ÑŒ: {path}\n\n"
            else:
                info += f"Ğ¤Ğ°Ğ¹Ğ» {i + 1}: ĞĞ• ĞĞĞ™Ğ”Ğ•Ğ - {path}\n\n"

        from PyQt6.QtWidgets import QMessageBox
        QMessageBox.information(self, "Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğ°Ñ…", info)


gui\__pycache__\__init__.cpython-313.pyc

Ñƒ
    6i    Ğ³                   Ñƒ   â€¢ g )NÂ© r   Ñƒ    ĞªCF:\Programs\PythonProject\VideoDuplicateCleaner\src\gui\__init__.pyĞª<module>r      s   Ñr   


gui\__pycache__\comparison_dialog.cpython-313.pyc

Ã³
    iÃ¹i5=  Ã£                   Ã³Â    Â• S SK r S SKrS SKrS SKrS SKJrJrJrJ	r	J
r
JrJrJrJr  S SKJrJrJr  S SKJrJr   " S S\5      r " S S\5      rg)	Ã©    N)	ÃšQDialogÃšQVBoxLayoutÃšQHBoxLayoutÃšQLabelÃšQPushButtonÃš	QTextEditÃšQWidgetÃšQProgressBarÃšQMessageBox)ÃšQtÃšQThreadÃš
pyqtSignal)ÃšQPixmapÃšQImagec                   Ã³f   ^ Â• \ rS rSrSr\" \\5      r\" \	\
5      rSU 4S jjrS rS rS rSrU =r$ )	ÃšSafeFrameExtractionThreadÃ©   uk   ÃÂ‘ÃÂµÃÂ·ÃÂ¾ÃÂ¿ÃÂ°Ã‘ÂÃÂ½Ã‘Â‹ÃÂ¹ ÃÂ¿ÃÂ¾Ã‘Â‚ÃÂ¾ÃÂº ÃÂ´ÃÂ»Ã‘Â ÃÂ¸ÃÂ·ÃÂ²ÃÂ»ÃÂµÃ‘Â‡ÃÂµÃÂ½ÃÂ¸Ã‘Â ÃÂºÃÂ°ÃÂ´Ã‘Â€ÃÂ¾ÃÂ² Ã‘Â ÃÂºÃÂ¾ÃÂ½Ã‘Â‚Ã‘Â€ÃÂ¾ÃÂ»ÃÂµÃÂ¼ ÃÂ¿ÃÂ°ÃÂ¼Ã‘ÂÃ‘Â‚ÃÂ¸c                 Ã³:   >Â• [         TU ]  5         Xl        X l        g Â©N)ÃšsuperÃš__init__Ãšvideo_pathsÃš
num_frames)Ãšselfr   r   Ãš	__class__s      Â€ÃšLF:\Programs\PythonProject\VideoDuplicateCleaner\src\gui\comparison_dialog.pyr   Ãš"SafeFrameExtractionThread.__init__   s   Ã¸Â€ ÃœÂ‰Ã‘Ã”Ã˜&Ã”Ã˜$ÂÃ³    c                 Ã³Â”   Â•  SSK Jn  U" 5       nUR                  X5      $ ! [         a  n[	        SU SU 35        / s SnA$ SnAff = f)u[   ÃÂ‘ÃÂµÃÂ·ÃÂ¾ÃÂ¿ÃÂ°Ã‘ÂÃÂ½ÃÂ¾ÃÂµ ÃÂ¸ÃÂ·ÃÂ²ÃÂ»ÃÂµÃ‘Â‡ÃÂµÃÂ½ÃÂ¸ÃÂµ ÃÂºÃÂ°ÃÂ´Ã‘Â€ÃÂ¾ÃÂ² Ã‘Â ÃÂ¾ÃÂ±Ã‘Â€ÃÂ°ÃÂ±ÃÂ¾Ã‘Â‚ÃÂºÃÂ¾ÃÂ¹ ÃÂ¾Ã‘ÂˆÃÂ¸ÃÂ±ÃÂ¾ÃÂºr   Â©ÃšFrameExtractoru;   ÃÂÃ‘ÂˆÃÂ¸ÃÂ±ÃÂºÃÂ° ÃÂ¿Ã‘Â€ÃÂ¸ ÃÂ¸ÃÂ·ÃÂ²ÃÂ»ÃÂµÃ‘Â‡ÃÂµÃÂ½ÃÂ¸ÃÂ¸ ÃÂºÃÂ°ÃÂ´Ã‘Â€ÃÂ¾ÃÂ² ÃÂ¸ÃÂ· z: N)Ãšsrc.core.frame_extractorr!   Ãšextract_framesÃš	ExceptionÃšprint)r   Ãš
video_pathr   r!   Ãš	extractorÃšes         r   Ãšsafe_extract_framesÃš-SafeFrameExtractionThread.safe_extract_frames   sR   Â€ Ã°	Ã?Ã™&Ã“(ÂˆIÃ˜Ã—+Ã‘+Â¨JÃ“CÃCÃ¸ÃœÃ³ 	ÃœÃOÃPZÃˆ|Ã[]Ã^_Ã]`ÃaÃ”bÃ˜ÂIÃ»Ã°	Ãºs   Â‚  Â 
AÂªAÂ¼AÃAc                 Ã³Â¼  Â•  SSK Jn  U" 5       n/ n[        [        U5      [        U5      5      n[	        U5       HW  nX   b>  X'   b9  UR                  X   X'   5      nUR                  UR                  SS5      5        MF  UR                  S5        MY     U$ ! [         a:  n	[        SU	 35        S/[        [        U5      [        U5      5      -  s Sn	A	$ Sn	A	ff = f)ua   ÃÂ’Ã‘Â‹Ã‘Â‡ÃÂ¸Ã‘ÂÃÂ»Ã‘ÂÃÂµÃ‘Â‚ Ã‘ÂÃ‘Â…ÃÂ¾ÃÂ¶ÃÂµÃ‘ÂÃ‘Â‚ÃÂ¸ ÃÂ¼ÃÂµÃÂ¶ÃÂ´Ã‘Âƒ ÃÂºÃÂ°ÃÂ´Ã‘Â€ÃÂ°ÃÂ¼ÃÂ¸ Ã‘Â ÃÂ·ÃÂ°Ã‘Â‰ÃÂ¸Ã‘Â‚ÃÂ¾ÃÂ¹ ÃÂ¾Ã‘Â‚ ÃÂ¾Ã‘ÂˆÃÂ¸ÃÂ±ÃÂ¾ÃÂºr   )ÃšComparisonManagerNÃšoverallg        u=   ÃÂÃ‘ÂˆÃÂ¸ÃÂ±ÃÂºÃÂ° ÃÂ¿Ã‘Â€ÃÂ¸ ÃÂ²Ã‘Â‹Ã‘Â‡ÃÂ¸Ã‘ÂÃÂ»ÃÂµÃÂ½ÃÂ¸ÃÂ¸ Ã‘ÂÃ‘Â…ÃÂ¾ÃÂ¶ÃÂµÃ‘ÂÃ‘Â‚ÃÂµÃÂ¹: )
Ãš!src.algorithms.comparison_managerr,   ÃšminÃšlenÃšrangeÃšcompare_imagesÃšappendÃšgetr$   r%   )
r   Ãšframes1Ãšframes2r,   ÃšmanagerÃšsimilaritiesÃš
min_framesÃšiÃšresultr(   s
             r   Ãšcalculate_similaritiesÃš0SafeFrameExtractionThread.calculate_similarities"   sÃŒ   Â€ Ã°	;ÃKÃ™'Ã“)ÂˆGÃ ÂˆLÃœÂœSÂ Â›\Â¬3Â¨wÂ«<Ã“8ÂˆJÃ¤Â˜:Ã–&ÂÃ˜Â‘:Ã‘)Â¨gÂ©jÃ‘.DÃ˜$Ã—3Ã‘3Â°GÂ±JÃ€Ã
Ã“KÂFÃ˜ Ã—'Ã‘'Â¨Â¯
Â©
Â°9Â¸cÃ“(BÃ–CÃ  Ã—'Ã‘'Â¨Ã–,Ã± 'Ã°  ÃÃ¸ÃœÃ³ 	;ÃœÃQÃRSÃQTÃUÃ”VÃ˜Â5Âœ3ÂœsÂ 7Â›|Â¬SÂ°Â«\Ã“:Ã‘:Ã•:Ã»Ã°	;Ãºs   Â‚BB Ã‚
CÃ‚!/CÃƒCÃƒCc                 Ã³ÃŒ  Â•  0 n/ nU R                   R                  SS5        [        U R                  5       HÂ™  u  p4[	        U[        U R                  5      -  S-  5      nU R                   R                  US[        R                  R                  U5       35        U R                  X@R                  5      nXaU'   [        R                  " 5         MÂ›     [        U R                  5      S:Â¼  aÂ€  U R                   R                  SS5        UR                  U R                  S   / 5      nUR                  U R                  S   / 5      nU R                  Xx5      n[        R                  " 5         U R                   R                  S	S
5        U R                  R                  X5        g! [          a4  n	[#        SU	 35        U R                  R                  0 / 5         Sn	A	gSn	A	ff = f)uA   ÃÂÃ‘ÂÃÂ½ÃÂ¾ÃÂ²ÃÂ½ÃÂ¾ÃÂ¹ ÃÂ¼ÃÂµÃ‘Â‚ÃÂ¾ÃÂ´ Ã‘Â ÃÂ·ÃÂ°Ã‘Â‰ÃÂ¸Ã‘Â‚ÃÂ¾ÃÂ¹ ÃÂ¾Ã‘Â‚ ÃÂ¿ÃÂ°ÃÂ´ÃÂµÃÂ½ÃÂ¸ÃÂ¹r   u<   ÃÂŸÃÂ¾ÃÂ´ÃÂ³ÃÂ¾Ã‘Â‚ÃÂ¾ÃÂ²ÃÂºÃÂ° ÃÂº ÃÂ¸ÃÂ·ÃÂ²ÃÂ»ÃÂµÃ‘Â‡ÃÂµÃÂ½ÃÂ¸Ã‘Â ÃÂºÃÂ°ÃÂ´Ã‘Â€ÃÂ¾ÃÂ²...Ã©2   u#   ÃÂ˜ÃÂ·ÃÂ²ÃÂ»ÃÂµÃÂºÃÂ°ÃÂµÃÂ¼ ÃÂºÃÂ°ÃÂ´Ã‘Â€Ã‘Â‹ ÃÂ¸ÃÂ· Ã©   Ã©K   u3   ÃÂ’Ã‘Â‹Ã‘Â‡ÃÂ¸Ã‘ÂÃÂ»Ã‘ÂÃÂµÃÂ¼ Ã‘ÂÃ‘Â…ÃÂ¾ÃÂ¶ÃÂµÃ‘ÂÃ‘Â‚ÃÂ¸ ÃÂºÃÂ°ÃÂ´Ã‘Â€ÃÂ¾ÃÂ²...Ã©   Ã©d   u   ÃÂ“ÃÂ¾Ã‘Â‚ÃÂ¾ÃÂ²ÃÂ¾!uJ   ÃÂšÃ‘Â€ÃÂ¸Ã‘Â‚ÃÂ¸Ã‘Â‡ÃÂµÃ‘ÂÃÂºÃÂ°Ã‘Â ÃÂ¾Ã‘ÂˆÃÂ¸ÃÂ±ÃÂºÃÂ° ÃÂ² ÃÂ¿ÃÂ¾Ã‘Â‚ÃÂ¾ÃÂºÃÂµ ÃÂ¸ÃÂ·ÃÂ²ÃÂ»ÃÂµÃ‘Â‡ÃÂµÃÂ½ÃÂ¸Ã‘Â: N)Ãšprogress_signalÃšemitÃš	enumerater   Ãšintr0   ÃšosÃšpathÃšbasenamer)   r   ÃšgcÃšcollectr4   r<   Ãšframes_extractedr$   r%   )
r   Ãšresultsr8   r:   r&   ÃšprogressÃšframesr5   r6   r(   s
             r   ÃšrunÃšSafeFrameExtractionThread.run7   sÂ›  Â€ Ã° 	/Ã˜ÂˆGÃ˜ÂˆLÃ Ã— Ã‘ Ã—%Ã‘%Â aÃ)gÃ”hÃ´ "+Â¨4Ã—+;Ã‘+;Ã–!<Â‘ÂÃœÂ Â¤CÂ¨Ã—(8Ã‘(8Ã“$9Ã‘ 9Â¸RÃ‘?Ã“@ÂÃ˜Ã—$Ã‘$Ã—)Ã‘)Â¨(Ã6YÃ”Z\Ã—ZaÃ‘ZaÃ—ZjÃ‘ZjÃkuÃ“ZvÃYwÃ4xÃ”yÃ Ã—1Ã‘1Â°*Â¿oÂ¹oÃ“NÂÃ˜&,Â˜
Ã‘#Ã´ Â—
Â’
Â–Ã± "=Ã´ Â4Ã—#Ã‘#Ã“$Â¨Ã“)Ã˜Ã—$Ã‘$Ã—)Ã‘)Â¨"Ã.cÃ”dÃ˜!ÂŸ+Â™+Â dÃ—&6Ã‘&6Â°qÃ‘&9Â¸2Ã“>ÂÃ˜!ÂŸ+Â™+Â dÃ—&6Ã‘&6Â°qÃ‘&9Â¸2Ã“>ÂÃ˜#Ã—:Ã‘:Â¸7Ã“LÂÃ´ Â—
Â’
Â”Ã Ã— Ã‘ Ã—%Ã‘%Â cÂ¨?Ã”;Ã˜Ã—!Ã‘!Ã—&Ã‘&Â wÃ•=Ã¸Ã¤Ã³ 	/ÃœÃ^Ã_`Ã^aÃbÃ”cÃ˜Ã—!Ã‘!Ã—&Ã‘&Â rÂ¨2Ã—.Ã‘.Ã»Ã°	/Ãºs   Â‚F"F% Ã†%
G#Ã†/*GÃ‡G#)r   r   )Ã©
   )Ãš__name__Ãš
__module__Ãš__qualname__Ãš__firstlineno__Ãš__doc__r   rG   ÃšstrrD   ÃšdictÃšlistrM   r   r)   r<   rQ   Ãš__static_attributes__Ãš__classcell__Â©r   s   @r   r   r      s8   Ã¸Â† Ã™uÃ¡ Â Â cÃ“*Â€OÃ™!Â $Â¨Ã“-ÃÃ·%Ã²
Ã²;Ã·*"/Ã° "/r   r   c                   Ã³x   ^ Â• \ rS rSrSrSU 4S jjrS rS rS rS r	S r
S	 rS
 rS rS rS rS rS rSrU =r$ )ÃšComparisonDialogÃ©\   uH   ÃÂ¡Ã‘Â‚ÃÂ°ÃÂ±ÃÂ¸ÃÂ»Ã‘ÂŒÃÂ½Ã‘Â‹ÃÂ¹ ÃÂ´ÃÂ¸ÃÂ°ÃÂ»ÃÂ¾ÃÂ³ ÃÂ´ÃÂ»Ã‘Â side-by-side Ã‘ÂÃ‘Â€ÃÂ°ÃÂ²ÃÂ½ÃÂµÃÂ½ÃÂ¸Ã‘Âc                 Ã³Ã¬   >Â• [         TU ]  U5        US S U l        0 U l        / U l        SU l        U R                  S5        U R                  SSSS5        U R                  5         U R                  5         g )Nr@   r   u*   Side-by-Side ÃÂ¡Ã‘Â€ÃÂ°ÃÂ²ÃÂ½ÃÂµÃÂ½ÃÂ¸ÃÂµ ÃÂ’ÃÂ¸ÃÂ´ÃÂµÃÂ¾rC   r?   iÂ°  i   )
r   r   r   Ãšframes_dataÃšframe_similaritiesÃšcurrent_frame_indexÃšsetWindowTitleÃšsetGeometryÃšsetup_uir#   )r   r   Ãšparentr   s      Â€r   r   ÃšComparisonDialog.__init___   sp   Ã¸Â€ ÃœÂ‰Ã‘Â˜Ã” Ã˜&Â rÂ¨Â˜?ÂˆÃ”Ã˜ÂˆÃ”Ã˜"$ÂˆÃ”Ã˜#$ÂˆÃ” Ã Ã—Ã‘ÃHÃ”IÃ˜Ã—Ã‘Â˜Â˜bÂ $Â¨Ã”,Ã˜ÂÂ‰ÂŒÃ° 	Ã—Ã‘Ã•r   c                 Ã³Ã¢  Â• [        5       nU R                  U5        [        S5      nUR                  S5        UR	                  [
        R                  R                  5        UR                  U5        [        5       nUR                  U5        U R                  S5      U l        UR                  U R                  5        U R                  S5      U l        UR                  U R                  5        [        5       U l        U R                  R!                  S5        UR                  U R                  5        [        S5      U l        UR                  U R"                  5        U R%                  U5        g)u6   ÃÂ¡ÃÂ¾ÃÂ·ÃÂ´ÃÂ°ÃÂµÃ‘Â‚ Ã‘ÂÃ‘Â‚ÃÂ°ÃÂ±ÃÂ¸ÃÂ»Ã‘ÂŒÃÂ½Ã‘Â‹ÃÂ¹ ÃÂ¸ÃÂ½Ã‘Â‚ÃÂµÃ‘Â€Ã‘Â„ÃÂµÃÂ¹Ã‘Âu/   Ã°ÂŸÂÂ¬ Side-by-Side ÃÂ¡Ã‘Â€ÃÂ°ÃÂ²ÃÂ½ÃÂµÃÂ½ÃÂ¸ÃÂµ ÃÂ’ÃÂ¸ÃÂ´ÃÂµÃÂ¾z1font-size: 16pt; font-weight: bold; margin: 10px;r   rB   TuF   ÃÂŸÃÂ¾ÃÂ´ÃÂ³ÃÂ¾Ã‘Â‚ÃÂ°ÃÂ²ÃÂ»ÃÂ¸ÃÂ²ÃÂ°ÃÂµÃÂ¼ ÃÂ´ÃÂ°ÃÂ½ÃÂ½Ã‘Â‹ÃÂµ ÃÂ´ÃÂ»Ã‘Â Ã‘ÂÃ‘Â€ÃÂ°ÃÂ²ÃÂ½ÃÂµÃÂ½ÃÂ¸Ã‘Â...N)r   Ãš	setLayoutr   ÃšsetStyleSheetÃšsetAlignmentr   ÃšAlignmentFlagÃšAlignCenterÃš	addWidgetr   Ãš	addLayoutÃšcreate_video_panelÃš
left_panelÃšright_panelr
   Ãšprogress_barÃš
setVisibleÃšstatus_labelÃšcreate_control_buttons)r   ÃšlayoutÃštitle_labelÃšmain_layouts       r   rh   ÃšComparisonDialog.setup_uim   s'  Â€ Ã¤Â“ÂˆÃ˜ÂÂ‰ÂvÃ”Ã´ ÃNÃ“OÂˆÃ˜Ã—!Ã‘!Ã"UÃ”VÃ˜Ã— Ã‘ Â¤Ã—!1Ã‘!1Ã—!=Ã‘!=Ã”>Ã˜Ã—Ã‘Â˜Ã”%Ã´ "Â“mÂˆÃ˜Ã—Ã‘Â˜Ã”%Ã° Ã—1Ã‘1Â°!Ã“4ÂˆÂŒÃ˜Ã—Ã‘Â˜dÂŸoÂ™oÃ”.Ã°  Ã—2Ã‘2Â°1Ã“5ÂˆÃ”Ã˜Ã—Ã‘Â˜dÃ—.Ã‘.Ã”/Ã´ )Â›NÂˆÃ”Ã˜Ã—Ã‘Ã—$Ã‘$Â TÃ”*Ã˜Ã—Ã‘Â˜Ã—*Ã‘*Ã”+Ã´ #Ã#kÃ“lÂˆÃ”Ã˜Ã—Ã‘Â˜Ã—*Ã‘*Ã”+Ã° 	Ã—#Ã‘#Â FÃ•+r   c                 Ã³Ãˆ  Â• [        5       n[        5       nUR                  U5        [        SUS-    35      nUR	                  S5        UR                  [        R                  R                  5        UR                  U5        [        S5      nUR	                  S5        UR                  [        R                  R                  5        [        U S5      (       d	  SS/U l        XPR                  U'   UR                  U5        [        S5      nUR                  [        R                  R                  5        UR                  S	S
5        UR	                  S5        [        U S5      (       d	  SS/U l        X`R                  U'   UR                  U5        [        S5      nUR                  [        R                  R                  5        [        U S5      (       d	  SS/U l        XpR                  U'   UR                  U5        [        5       nUR!                  S5        UR#                  S5        [        U S5      (       d	  SS/U l        XÂ€R$                  U'   UR                  U5        U$ )u-   ÃÂ¡ÃÂ¾ÃÂ·ÃÂ´ÃÂ°ÃÂµÃ‘Â‚ ÃÂ¿ÃÂ°ÃÂ½ÃÂµÃÂ»Ã‘ÂŒ ÃÂ´ÃÂ»Ã‘Â ÃÂ²ÃÂ¸ÃÂ´ÃÂµÃÂ¾u   ÃÂ’ÃÂ¸ÃÂ´ÃÂµÃÂ¾ rB   z#font-size: 14pt; font-weight: bold;u   ÃÂ¡Ã‘Â…ÃÂ¾ÃÂ¶ÃÂµÃ‘ÂÃ‘Â‚Ã‘ÂŒ: ---zfont-weight: bold; color: blue;Ãšsimilarity_labelsNu   ÃÂ—ÃÂ°ÃÂ³Ã‘Â€Ã‘ÂƒÃÂ·ÃÂºÃÂ° ÃÂºÃÂ°ÃÂ´Ã‘Â€ÃÂ°...Ã©Â  Ã©,  z,border: 2px solid gray; background: #f0f0f0;Ãšframe_labelsu   ÃÂšÃÂ°ÃÂ´Ã‘Â€: 0/0Ãšframe_info_labelsÃ©x   TÃš
file_infos)r	   r   rl   r   rm   rn   r   ro   rp   rq   Ãšhasattrr   ÃšsetMinimumSizerÂ‚   rÂƒ   r   ÃšsetMaximumHeightÃšsetReadOnlyrÂ…   )	r   Ãšvideo_indexÃšpanelrz   ÃštitleÃšsimilarity_labelÃšframe_labelÃš
frame_infoÃš	file_infos	            r   rs   Ãš#ComparisonDialog.create_video_panelÂ   s  Â€ Ã¤Â“	ÂˆÃœÂ“ÂˆÃ˜ÂÂ‰Â˜Ã”Ã´ Â˜Â [Â°1Â¡_Ã$5Ã6Ã“7ÂˆÃ˜Ã—Ã‘ÃAÃ”BÃ˜Ã—Ã‘Âœ2Ã—+Ã‘+Ã—7Ã‘7Ã”8Ã˜Ã—Ã‘Â˜Ã”Ã´ "Ã"9Ã“:ÃÃ˜Ã—&Ã‘&Ã'HÃ”IÃ˜Ã—%Ã‘%Â¤bÃ—&6Ã‘&6Ã—&BÃ‘&BÃ”CÃ¤ÂtÃ0Ã—1Ã‘1Ã˜&*Â¨DÂ \ÂˆDÃ”"Ã˜.>Ã—Ã‘Â˜{Ã‘+Ã˜Ã—Ã‘Ã)Ã”*Ã´ Ã=Ã“>ÂˆÃ˜Ã— Ã‘ Â¤Ã—!1Ã‘!1Ã—!=Ã‘!=Ã”>Ã˜Ã—"Ã‘"Â 3Â¨Ã”,Ã˜Ã—!Ã‘!Ã"PÃ”QÃ¤ÂtÂ˜^Ã—,Ã‘,Ã˜!%Â tÂ ÂˆDÃ”Ã˜)4Ã—Ã‘Â˜+Ã‘&Ã˜Ã—Ã‘Â˜Ã”%Ã´ Â˜OÃ“,Âˆ
Ã˜Ã—Ã‘Â¤Ã— 0Ã‘ 0Ã— <Ã‘ <Ã”=Ã¤ÂtÃ0Ã—1Ã‘1Ã˜&*Â¨DÂ \ÂˆDÃ”"Ã˜.8Ã—Ã‘Â˜{Ã‘+Ã˜Ã—Ã‘Â˜Ã”$Ã´ Â“KÂˆ	Ã˜Ã—"Ã‘"Â 3Ã”'Ã˜Ã—Ã‘Â˜dÃ”#Ã¤ÂtÂ˜\Ã—*Ã‘*Ã˜#Â TÂ˜lÂˆDÂŒOÃ˜'0ÂÂ‰Â˜Ã‘$Ã˜Ã—Ã‘Â˜Ã”#Ã Âˆr   c                 Ã³Â°  Â• [        5       n[        S5      U l        U R                  R                  R	                  U R
                  5        U R                  R                  S5        UR                  U R                  5        [        S5      U l        U R                  R                  R	                  U R                  5        U R                  R                  S5        UR                  U R                  5        UR                  5         [        S5      nUR                  R	                  U R                  5        UR                  U5        UR                  U5        g)u0   ÃÂ¡ÃÂ¾ÃÂ·ÃÂ´ÃÂ°ÃÂµÃ‘Â‚ ÃÂºÃÂ½ÃÂ¾ÃÂ¿ÃÂºÃÂ¸ Ã‘ÂƒÃÂ¿Ã‘Â€ÃÂ°ÃÂ²ÃÂ»ÃÂµÃÂ½ÃÂ¸Ã‘Âu   Ã¢ÂÂ® ÃÂŸÃ‘Â€ÃÂµÃÂ´Ã‘Â‹ÃÂ´Ã‘ÂƒÃ‘Â‰ÃÂ¸ÃÂ¹Fu   ÃÂ¡ÃÂ»ÃÂµÃÂ´Ã‘ÂƒÃ‘ÂÃ‘Â‰ÃÂ¸ÃÂ¹ Ã¢ÂÂ­u   ÃÂ—ÃÂ°ÃÂºÃ‘Â€Ã‘Â‹Ã‘Â‚Ã‘ÂŒN)r   r   Ãšprev_btnÃšclickedÃšconnectÃšprevious_frameÃš
setEnabledrq   Ãšnext_btnÃš
next_frameÃš
addStretchÃš
safe_closerr   )r   rz   Ãšbutton_layoutÃš	close_btns       r   ry   Ãš'ComparisonDialog.create_control_buttonsÃ†   sÃ°   Â€ Ã¤#Â›ÂˆÃ¤#Ã$>Ã“?ÂˆÂŒÃ˜ÂÂ‰Ã—Ã‘Ã—%Ã‘%Â dÃ—&9Ã‘&9Ã”:Ã˜ÂÂ‰Ã— Ã‘ Â Ã”'Ã˜Ã—Ã‘Â Â§Â¡Ã”.Ã¤#Ã$<Ã“=ÂˆÂŒÃ˜ÂÂ‰Ã—Ã‘Ã—%Ã‘%Â dÂ§oÂ¡oÃ”6Ã˜ÂÂ‰Ã— Ã‘ Â Ã”'Ã˜Ã—Ã‘Â Â§Â¡Ã”.Ã Ã— Ã‘ Ã”"Ã¤Ã 0Ã“1Âˆ	Ã˜Ã—Ã‘Ã—!Ã‘!Â $Â§/Â¡/Ã”2Ã˜Ã—Ã‘Â 	Ã”*Ã Ã—Ã‘Â˜Ã•'r   c                 Ã³*  Â• [        U R                  S5      U l        U R                  R                  R	                  U R
                  5        U R                  R                  R	                  U R                  5        U R                  R                  5         g)uI   ÃÂ—ÃÂ°ÃÂ¿Ã‘ÂƒÃ‘ÂÃÂºÃÂ°ÃÂµÃ‘Â‚ ÃÂ±ÃÂµÃÂ·ÃÂ¾ÃÂ¿ÃÂ°Ã‘ÂÃÂ½ÃÂ¾ÃÂµ ÃÂ¸ÃÂ·ÃÂ²ÃÂ»ÃÂµÃ‘Â‡ÃÂµÃÂ½ÃÂ¸ÃÂµ ÃÂºÃÂ°ÃÂ´Ã‘Â€ÃÂ¾ÃÂ²rS   N)	r   r   Ãšextraction_threadrD   rÂ•   Ãšupdate_progressrM   Ãšon_frames_extractedÃšstartÂ©r   s    r   r#   ÃšComparisonDialog.extract_framesÃœ   si   Â€ Ã¤!:Â¸4Ã—;KÃ‘;KÃˆRÃ“!PÂˆÃ”Ã˜Ã—Ã‘Ã—.Ã‘.Ã—6Ã‘6Â°tÃ—7KÃ‘7KÃ”LÃ˜Ã—Ã‘Ã—/Ã‘/Ã—7Ã‘7Â¸Ã—8PÃ‘8PÃ”QÃ˜Ã—Ã‘Ã—$Ã‘$Ã•&r   c                 Ã³p   Â• U R                   R                  U5        U R                  R                  U5        g)u#   ÃÂÃÂ±ÃÂ½ÃÂ¾ÃÂ²ÃÂ»Ã‘ÂÃÂµÃ‘Â‚ ÃÂ¿Ã‘Â€ÃÂ¾ÃÂ³Ã‘Â€ÃÂµÃ‘ÂÃ‘ÂN)rv   ÃšsetValuerx   ÃšsetText)r   rO   Ãšmessages      r   rÂ¡   Ãš ComparisonDialog.update_progressÃ£   s*   Â€ Ã Ã—Ã‘Ã—"Ã‘"Â 8Ã”,Ã˜Ã—Ã‘Ã—!Ã‘!Â 'Ã•*r   c                 Ã³f  Â• Xl         X l        U R                  R                  S5        U R                  R                  S5        U R                  5         U R                  R                  S5        U R                  R                  S5        U R                  S5        [        R                  " 5         S ng)u:   ÃÂÃÂ±Ã‘Â€ÃÂ°ÃÂ±ÃÂ°Ã‘Â‚Ã‘Â‹ÃÂ²ÃÂ°ÃÂµÃ‘Â‚ ÃÂ¸ÃÂ·ÃÂ²ÃÂ»ÃÂµÃ‘Â‡ÃÂµÃÂ½ÃÂ½Ã‘Â‹ÃÂµ ÃÂºÃÂ°ÃÂ´Ã‘Â€Ã‘Â‹Fu-   ÃÂšÃÂ°ÃÂ´Ã‘Â€Ã‘Â‹ Ã‘ÂƒÃ‘ÂÃÂ¿ÃÂµÃ‘ÂˆÃÂ½ÃÂ¾ ÃÂ¸ÃÂ·ÃÂ²ÃÂ»ÃÂµÃ‘Â‡ÃÂµÃÂ½Ã‘Â‹!Tr   c                 Ã³Ãª  Â• SSK Jn  U" 5       n[        U R                  5       GH%  u  p4X@R                  ;   d  M  U[        U R                  5      :  d  M2   UR                  U5      n[        R                  R                  U5      S-  nS[        R                  R                  U5       SUS SUR                  SS	5       S
UR                  SS	5       SUR                  SS5      S SUR                  SS5      S SUR                  SS5       SU 3nU R                  U   (       a!  U R                  U   R                  U5        GM%  GM(     g! [         a  n[        SU 35         SnAGMJ  SnAff = f)u7   ÃÂÃÂ±ÃÂ½ÃÂ¾ÃÂ²ÃÂ»Ã‘ÂÃÂµÃ‘Â‚ ÃÂ¸ÃÂ½Ã‘Â„ÃÂ¾Ã‘Â€ÃÂ¼ÃÂ°Ã‘Â†ÃÂ¸Ã‘Â ÃÂ¾ Ã‘Â„ÃÂ°ÃÂ¹ÃÂ»ÃÂ°Ã‘Â…r   r    i   u   Ã°ÂŸÂ“Â ÃÂ¤ÃÂ°ÃÂ¹ÃÂ»: u   
        Ã°ÂŸÂ“Â ÃÂ ÃÂ°ÃÂ·ÃÂ¼ÃÂµÃ‘Â€: z.2fu*    MB
        Ã°ÂŸÂÂÃ¯Â¸Â ÃÂ ÃÂ°ÃÂ·Ã‘Â€ÃÂµÃ‘ÂˆÃÂµÃÂ½ÃÂ¸ÃÂµ: ÃšwidthzN/AÃšxÃšheightu*   
        Ã¢ÂÂ±Ã¯Â¸Â ÃÂ”ÃÂ»ÃÂ¸Ã‘Â‚ÃÂµÃÂ»Ã‘ÂŒÃÂ½ÃÂ¾Ã‘ÂÃ‘Â‚Ã‘ÂŒ: Ãšdurationz.1fu    Ã‘ÂÃÂµÃÂº
        Ã°ÂŸÂ“ÂŠ FPS: Ãšfpsu*   
        Ã°ÂŸÂ–Â¼Ã¯Â¸Â ÃÂ’Ã‘ÂÃÂµÃÂ³ÃÂ¾ ÃÂºÃÂ°ÃÂ´Ã‘Â€ÃÂ¾ÃÂ²: Ãštotal_framesu   
        Ã°ÂŸÂ“Â‚ ÃÂŸÃ‘ÂƒÃ‘Â‚Ã‘ÂŒ: uM   ÃÂÃ‘ÂˆÃÂ¸ÃÂ±ÃÂºÃÂ° ÃÂ¿Ã‘Â€ÃÂ¸ ÃÂ¾ÃÂ±ÃÂ½ÃÂ¾ÃÂ²ÃÂ»ÃÂµÃÂ½ÃÂ¸ÃÂ¸ ÃÂ¸ÃÂ½Ã‘Â„ÃÂ¾Ã‘Â€ÃÂ¼ÃÂ°Ã‘Â†ÃÂ¸ÃÂ¸ ÃÂ¾ Ã‘Â„ÃÂ°ÃÂ¹ÃÂ»ÃÂµ: N)r"   r!   rF   r   rc   r0   rÂ…   Ãšget_video_inforH   rI   ÃšgetsizerJ   r4   ÃšsetPlainTextr$   r%   )	r   r!   r'   r:   r&   Ãš
video_infoÃš	file_sizeÃš	info_textr(   s	            r   Ãšupdate_file_infoÃš>ComparisonDialog.on_frames_extracted.<locals>.update_file_infoÃ½   sh  Â€ Ã¥?Ã™&Ã“(ÂˆIÃ¤!*Â¨4Ã—+;Ã‘+;Ã—!<Â‘ÂÃ˜Ã—!1Ã‘!1Ã•1Â°aÂ¼#Â¸dÂ¿oÂ¹oÃ“:NÃ•6NÃ°sÃ %.Ã—%=Ã‘%=Â¸jÃ“%IÂ˜
Ãœ$&Â§GÂ¡GÂ§OÂ¡OÂ°JÃ“$?Ã€;Ã‘$OÂ˜	Ã (7Â¼Â¿Â¹Ã—8HÃ‘8HÃˆÃ“8TÃ7UÃ° VÃ˜%Â cÂ˜?Ã° +'Ã˜'1Â§~Â¡~Â°gÂ¸uÃ“'EÃ&FÃ€aÃˆ
ÃÃ‰ÃW_ÃafÃ“HgÃGhÃ° i*Ã˜*4Â¯.Â©.Â¸Ã€QÃ“*GÃˆÃ)LÃ° MÃ˜Â—>Â‘>Â %Â¨Ã“+Â¨CÃ0Ã° 1*Ã˜*4Â¯.Â©.Â¸ÃˆÃ“*KÃ)LÃ° MÃ˜"Â|Ã°%'Â˜	Ã°  ÂŸ?Â™?Â¨1Ã—-Ã˜ ÂŸOÂ™OÂ¨AÃ‘.Ã—;Ã‘;Â¸IÃ—FÃ² .Ã² "=Ã¸Ã´" %Ã³ sÃœÃ mÃnoÃmpÃqÃ—rÃ“rÃ»Ã°sÃºs   ÃC/EÃ…
E2Ã…E-Ã…-E2N)rc   rd   rv   rw   rx   rÂ¨   rÂ¹   rÂ“   rÂ—   rÂ˜   Ãš
show_framerK   rL   )r   rc   rd   rÂ¹   s       r   rÂ¢   Ãš$ComparisonDialog.on_frames_extractedÃ¨   sÂŠ   Â€ Ã &Ã”Ã˜"4Ã”Ã Ã—Ã‘Ã—$Ã‘$Â UÃ”+Ã˜Ã—Ã‘Ã—!Ã‘!Ã"QÃ”RÃ° 	Ã—Ã‘Ã”Ã° 	ÂÂ‰Ã— Ã‘ Â Ã”&Ã˜ÂÂ‰Ã— Ã‘ Â Ã”&Ã° 	ÂÂ‰Â˜Ã”Ã´ 	Â
ÂŠ
ÂŒÃ³	sr   c                 Ã³Ã¦  Â•  Xl         [        U R                  R                  5        Vs/ s H  n[	        U5      PM     sn5      nSUS-    SU 3n[        [	        U R                  5      5       HR  nU[	        U R                  5      :  d  M  U R                  U   (       d  M4  U R                  U   R                  U5        MT     U[	        U R                  5      :  aS  [        U S5      (       aB  U R                  U   nSUS 3nU R                   H  nU(       d  M  UR                  U5        M     [        U R                  5       H  u  pYXÂR                  ;   d  M  U[	        U R                  U	   5      :  d  M4  U[	        U R                  5      :  d  MO  U R                  U	   U   n
U R                  XÂ R                  U   5        MÂ     gs  snf ! [         a  n[!        SU 35         SnAgSnAff = f)	uA   ÃÂŸÃÂ¾ÃÂºÃÂ°ÃÂ·Ã‘Â‹ÃÂ²ÃÂ°ÃÂµÃ‘Â‚ ÃÂºÃÂ°ÃÂ´Ã‘Â€ Ã‘Â ÃÂ·ÃÂ°Ã‘Â‰ÃÂ¸Ã‘Â‚ÃÂ¾ÃÂ¹ ÃÂ¾Ã‘Â‚ ÃÂ¾Ã‘ÂˆÃÂ¸ÃÂ±ÃÂ¾ÃÂºu
   ÃÂšÃÂ°ÃÂ´Ã‘Â€: rB   Ãš/r   u   ÃÂ¡Ã‘Â…ÃÂ¾ÃÂ¶ÃÂµÃ‘ÂÃ‘Â‚Ã‘ÂŒ: z.1%u7   ÃÂÃ‘ÂˆÃÂ¸ÃÂ±ÃÂºÃÂ° ÃÂ¿Ã‘Â€ÃÂ¸ ÃÂ¾Ã‘Â‚ÃÂ¾ÃÂ±Ã‘Â€ÃÂ°ÃÂ¶ÃÂµÃÂ½ÃÂ¸ÃÂ¸ ÃÂºÃÂ°ÃÂ´Ã‘Â€ÃÂ°: N)re   r/   rc   Ãšvaluesr0   r1   r   rÂƒ   rÂ¨   rd   rÂ†   r   rF   rÂ‚   Ãšsafe_display_framer$   r%   )r   Ãšframe_indexrP   Ãš
max_framesrÂ   r:   Ãš
similarityÃšsimilarity_textÃšlabelr&   Ãšframer(   s               r   rÂ»   ÃšComparisonDialog.show_frame  sÂ¹  Â€ Ã°	QÃ˜'2Ã”$Ã´ Â¸Ã—8HÃ‘8HÃ—8OÃ‘8OÃ”8QÃ“RÃ’8QÂ¨fÂœcÂ &ÂkÃ‘8QÃ‘RÃ“SÂˆJÃ˜%Â kÂ°AÂ¡oÃ%6Â°aÂ¸
Â°|ÃDÂˆJÃ¤Âœ3Â˜tÃ—/Ã‘/Ã“0Ã–1ÂÃ˜Â”sÂ˜4Ã—1Ã‘1Ã“2Ã•2Â°tÃ—7MÃ‘7MÃˆaÃ—7PÃ‘7PÃ˜Ã—*Ã‘*Â¨1Ã‘-Ã—5Ã‘5Â°jÃ–AÃ± 2Ã°
 ÂœcÂ $Ã—"9Ã‘"9Ã“:Ã“:ÃœÂ˜DÃ"5Ã—6Ã‘6Ã !Ã—4Ã‘4Â°[Ã‘AÂ
Ã˜$6Â°zÃ€#Ã6FÃ"GÂÃ !Ã—3Ã”3ÂEÃŸÂuÃ˜ÂŸÂ™Â oÃ–6Ã± 4Ã´
 "+Â¨4Ã—+;Ã‘+;Ã–!<Â‘ÂÃ˜Ã—"2Ã‘"2Ã•2Ã˜#Â¤cÂ¨$Ã—*:Ã‘*:Â¸:Ã‘*FÃ“&GÃ•GÃ˜ÂœCÂ Ã— 1Ã‘ 1Ã“2Ã•2Ã˜ Ã—,Ã‘,Â¨ZÃ‘8Â¸Ã‘EÂEÃ˜Ã—+Ã‘+Â¨EÃ—3DÃ‘3DÃ€QÃ‘3GÃ–HÃ² "=Ã¹Ã²' SÃ¸Ã´4 Ã³ 	QÃœÃKÃˆAÃˆ3ÃOÃ—PÃ‘PÃ»Ã°	QÃºsM   Â‚'G Â©G	Â¾A
G Ã‚G Ã‚"A5G Ã„<G Ã…G Ã…9G Ã†4G Ã‡	G Ã‡
G0Ã‡G+Ã‡+G0c                 Ã³>  Â•  Uc  UR                  S5        g[        R                  " U[        R                  5      nUR                  u  pEnXe-  n[        UR                  XTU[
        R                  R                  5      n[        R                  " U5      n	U	R                  SS[        R                  R                  [        R                  R                   5      n
UR#                  U
5        g! [$         a'  nUR                  S['        U5       35         SnAgSnAff = f)u6   ÃÂ‘ÃÂµÃÂ·ÃÂ¾ÃÂ¿ÃÂ°Ã‘ÂÃÂ½ÃÂ¾ÃÂµ ÃÂ¾Ã‘Â‚ÃÂ¾ÃÂ±Ã‘Â€ÃÂ°ÃÂ¶ÃÂµÃÂ½ÃÂ¸ÃÂµ ÃÂºÃÂ°ÃÂ´Ã‘Â€ÃÂ°Nu   ÃÂšÃÂ°ÃÂ´Ã‘Â€ ÃÂ½ÃÂµ ÃÂ´ÃÂ¾Ã‘ÂÃ‘Â‚Ã‘ÂƒÃÂ¿ÃÂµÃÂ½rÂ€   rÂ   u   ÃÂÃ‘ÂˆÃÂ¸ÃÂ±ÃÂºÃÂ°: )rÂ¨   Ãšcv2ÃšcvtColorÃšCOLOR_BGR2RGBÃšshaper   ÃšdataÃšFormatÃšFormat_RGB888r   Ãš	fromImageÃšscaledr   ÃšAspectRatioModeÃšKeepAspectRatioÃšTransformationModeÃšSmoothTransformationÃš	setPixmapr$   rY   )r   rÃ†   rÃ…   Ãš	frame_rgbÃšhÃšwÃšchÃšbytes_per_lineÃšq_imgÃšpixmapÃšscaled_pixmapr(   s               r   rÃ€   Ãš#ComparisonDialog.safe_display_frame9  sÃ¤   Â€ Ã°	5Ã˜Â‰}Ã˜Â—Â‘Ã>Ã”?Ã˜Ã´ ÂŸÂšÂ UÂ¬CÃ—,=Ã‘,=Ã“>ÂˆIÃ° !Â—Â‘Â‰HÂˆAÂ"Ã˜Â™VÂˆNÃ´ Â˜9ÂŸ>Â™>Â¨1Â°Ã„Ã‡ÃÃ—A\Ã‘A\Ã“]ÂˆEÃ´ Ã—&Ã’&Â uÃ“-ÂˆFÃ˜"ÂŸMÂ™MÂ¨#Â¨sÂ´BÃ—4FÃ‘4FÃ—4VÃ‘4VÃœ*,Ã—*?Ã‘*?Ã—*TÃ‘*TÃ³VÂˆMÃ° ÂOÂ‰OÂ˜MÃ•*Ã¸Ã¤Ã³ 	5Ã˜ÂMÂ‰MÂ˜NÂ¬3Â¨qÂ«6Â¨(Ã3Ã—4Ã‘4Ã»Ã°	5Ãºs   Â‚C+ Â—CC+ Ãƒ+
DÃƒ5DÃ„Dc                 Ã³Ã¬   Â• [        U R                  R                  5        Vs/ s H  n[        U5      PM     sn5      nU R                  US-
  :  a  U R                  U R                  S-   5        ggs  snf )u   ÃÂ¡ÃÂ»ÃÂµÃÂ´Ã‘ÂƒÃ‘ÂÃ‘Â‰ÃÂ¸ÃÂ¹ ÃÂºÃÂ°ÃÂ´Ã‘Â€rB   N)r/   rc   rÂ¿   r0   re   rÂ»   )r   rP   rÃ‚   s      r   rÂ™   ÃšComparisonDialog.next_frameT  sd   Â€ Ã¤Â°DÃ—4DÃ‘4DÃ—4KÃ‘4KÃ”4MÃ“NÃ’4MÂ¨&Âœ#Â˜fÂ+Ã‘4MÃ‘NÃ“OÂˆ
Ã˜Ã—#Ã‘#Â jÂ°1Â¡nÃ“4Ã˜ÂOÂ‰OÂ˜DÃ—4Ã‘4Â°qÃ‘8Ã•9Ã° 5Ã¹Ã² Os   Â¢A1c                 Ã³b   Â• U R                   S:Â”  a  U R                  U R                   S-
  5        gg)u   ÃÂŸÃ‘Â€ÃÂµÃÂ´Ã‘Â‹ÃÂ´Ã‘ÂƒÃ‘Â‰ÃÂ¸ÃÂ¹ ÃÂºÃÂ°ÃÂ´Ã‘Â€r   rB   N)re   rÂ»   rÂ¤   s    r   rÂ–   ÃšComparisonDialog.previous_frameZ  s,   Â€ Ã Ã—#Ã‘#Â aÃ“'Ã˜ÂOÂ‰OÂ˜DÃ—4Ã‘4Â°qÃ‘8Ã•9Ã° (r   c                 Ã³Ãª  Â•  [        U S5      (       aS  U R                  R                  5       (       a4  U R                  R                  5         U R                  R	                  5         U R
                  R                  5         U R                  R                  5         [        R                  " 5         U R                  5         g! [         a(  n[        SU 35        U R                  5          SnAgSnAff = f)u%   ÃÂ‘ÃÂµÃÂ·ÃÂ¾ÃÂ¿ÃÂ°Ã‘ÂÃÂ½ÃÂ¾ÃÂµ ÃÂ·ÃÂ°ÃÂºÃ‘Â€Ã‘Â‹Ã‘Â‚ÃÂ¸ÃÂµrÂ    u&   ÃÂÃ‘ÂˆÃÂ¸ÃÂ±ÃÂºÃÂ° ÃÂ¿Ã‘Â€ÃÂ¸ ÃÂ·ÃÂ°ÃÂºÃ‘Â€Ã‘Â‹Ã‘Â‚ÃÂ¸ÃÂ¸: N)rÂ†   rÂ    Ãš	isRunningÃš	terminateÃšwaitrc   Ãšclearrd   rK   rL   Ãšcloser$   r%   )r   r(   s     r   rÂ›   ÃšComparisonDialog.safe_close_  sÂ²   Â€ Ã°	Ã¤ÂtÃ0Ã—1Ã‘1Â°dÃ—6LÃ‘6LÃ—6VÃ‘6VÃ—6XÃ‘6XÃ˜Ã—&Ã‘&Ã—0Ã‘0Ã”2Ã˜Ã—&Ã‘&Ã—+Ã‘+Ã”-Ã° Ã—Ã‘Ã—"Ã‘"Ã”$Ã˜Ã—#Ã‘#Ã—)Ã‘)Ã”+Ã´ ÂJÂŠJÂŒLÃ ÂJÂ‰JÂLÃ¸Ã¤Ã³ 	ÃœÃ:Â¸1Â¸#Ã>Ã”?Ã˜ÂJÂ‰JÂLÂ‰LÃ»Ã°	Ãºs   Â‚B=C  Ãƒ 
C2Ãƒ
C-Ãƒ-C2c                 Ã³D   Â• U R                  5         UR                  5         g)u.   ÃÂÃÂ±Ã‘Â€ÃÂ°ÃÂ±ÃÂ¾Ã‘Â‚Ã‘Â‡ÃÂ¸ÃÂº ÃÂ·ÃÂ°ÃÂºÃ‘Â€Ã‘Â‹Ã‘Â‚ÃÂ¸Ã‘Â ÃÂ¾ÃÂºÃÂ½ÃÂ°N)rÂ›   Ãšaccept)r   Ãševents     r   Ãš
closeEventÃšComparisonDialog.closeEventt  s   Â€ Ã ÂÂ‰Ã”Ã˜ÂÂ‰Âr   )re   rÂ    rÂ…   rÂƒ   rÂ‚   rd   rc   rt   rÂ˜   rÂ“   rv   ru   r   rx   r   r   )rT   rU   rV   rW   rX   r   rh   rs   ry   r#   rÂ¡   rÂ¢   rÂ»   rÃ€   rÂ™   rÂ–   rÂ›   rÃ®   r\   r]   r^   s   @r   r`   r`   \   sR   Ã¸Â† Ã™RÃ·Ã²!,Ã²F4Ã²l(Ã²,'Ã²+Ã²
,sÃ²\!QÃ²F5Ã²6:Ã²:Ã²
Ã·*Ã° r   r`   )rH   rK   rÃ‰   ÃšnumpyÃšnpÃšPyQt6.QtWidgetsr   r   r   r   r   r   r	   r
   r   ÃšPyQt6.QtCorer   r   r   ÃšPyQt6.QtGuir   r   r   r`   Â© r   r   Ãš<module>rÃ¶      sH   Ã°Ã› 	Ã› 	Ã› 
Ã› Ã·Ã· Ãµ Ã· 1Ã‘ 0ÃŸ 'Ã´L/Â Ã´ L/Ã´^[ÂwÃµ [r   


test_output\__init__.py




test_output\debug_memory.py

import os
import sys
import tracemalloc
import gc

# ĞĞ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ¿ÑƒÑ‚Ğ¸
current_dir = os.path.dirname(os.path.abspath(__file__))
src_path = os.path.join(current_dir, 'src')
sys.path.insert(0, src_path)


def debug_memory_usage():
    """ĞÑ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸"""
    tracemalloc.start()

    print("ğŸ§  Ğ—ĞĞŸĞ£Ğ¡Ğš Ğ”Ğ˜ĞĞ“ĞĞĞ¡Ğ¢Ğ˜ĞšĞ˜ ĞŸĞĞœĞ¯Ğ¢Ğ˜")
    print("=" * 50)

    try:
        from src.core.frame_extractor import FrameExtractor
        from src.algorithms.comparison_manager import ComparisonManager

        # Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²
        extractor = FrameExtractor()
        comparator = ComparisonManager()

        print("âœ… ĞœĞ¾Ğ´ÑƒĞ»Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ñ‹ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾")

        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ğ¼ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸ Ğ´Ğ¾ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ñ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²
        snapshot1 = tracemalloc.take_snapshot()

        # Ğ¢ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğµ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²
        test_video = input("Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿ÑƒÑ‚ÑŒ Ğº Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ¼Ñƒ Ğ²Ğ¸Ğ´ĞµĞ¾: ").strip('"\'')

        if os.path.exists(test_video):
            print(f"ğŸ” Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµĞ¼ 10 ĞºĞ°Ğ´Ñ€Ğ¾Ğ² Ğ¸Ğ· {os.path.basename(test_video)}...")
            frames = extractor.extract_frames(test_video, 10)
            print(f"âœ… Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¾ {len(frames)} ĞºĞ°Ğ´Ñ€Ğ¾Ğ²")

            # ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ğ¼ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸ Ğ¿Ğ¾ÑĞ»Ğµ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ñ
            snapshot2 = tracemalloc.take_snapshot()

            # Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ¼ ÑĞ½Ğ¸Ğ¼ĞºĞ¸ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸
            top_stats = snapshot2.compare_to(snapshot1, 'lineno')
            print("\nğŸ“Š Ğ˜Ğ—ĞœĞ•ĞĞ•ĞĞ˜Ğ¯ Ğ’ ĞŸĞĞœĞ¯Ğ¢Ğ˜:")
            for stat in top_stats[:10]:
                print(stat)

            # Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²
            if len(frames) >= 2:
                print("\nğŸ” Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²...")
                result = comparator.compare_images(frames[0], frames[1])
                print(f"âœ… Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¾: {result}")

        else:
            print("âŒ Ğ¢ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹ Ñ„Ğ°Ğ¹Ğ» Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½")

    except Exception as e:
        print(f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ°: {e}")
        import traceback
        traceback.print_exc()

    finally:
        # ĞŸÑ€Ğ¸Ğ½ÑƒĞ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ°
        gc.collect()
        tracemalloc.stop()
        print("\nğŸ§¹ ĞŸĞ°Ğ¼ÑÑ‚ÑŒ Ğ¾Ñ‡Ğ¸Ñ‰ĞµĞ½Ğ°")


if __name__ == "__main__":
    debug_memory_usage()


test_output\simple_working_test.py

"""
ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ğ¹ Ñ€Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ğ¹ Ñ‚ĞµÑÑ‚, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾ Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ
"""
import os
import sys


def setup_imports():
    """ĞĞ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ¿ÑƒÑ‚Ğ¸ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ°"""
    current_dir = os.path.dirname(os.path.abspath(__file__))
    src_path = os.path.join(current_dir, 'src')

    if src_path not in sys.path:
        sys.path.insert(0, src_path)

    return src_path


def test_basic_functionality():
    """Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµÑ‚ Ğ±Ğ°Ğ·Ğ¾Ğ²ÑƒÑ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Ğ±ĞµĞ· ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¾Ğ²"""
    print("ğŸ§ª Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ±Ğ°Ğ·Ğ¾Ğ²ÑƒÑ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ...")

    setup_imports()

    try:
        # Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ Ğ¼Ğ¾Ğ´ÑƒĞ»Ğ¸
        from core.file_scanner import FileScanner
        from core.frame_extractor import FrameExtractor

        print("âœ… Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ Ğ¼Ğ¾Ğ´ÑƒĞ»Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ñ‹ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾")

        # Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ FileScanner
        scanner = FileScanner()
        test_dir = os.path.dirname(__file__)
        videos = scanner.find_video_files(test_dir)
        print(f"âœ… FileScanner: ĞĞ°Ğ¹Ğ´ĞµĞ½Ğ¾ {len(videos)} Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ² Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ¹ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ğ¸")

        # Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ FrameExtractor
        extractor = FrameExtractor()
        print("âœ… FrameExtractor ÑĞ¾Ğ·Ğ´Ğ°Ğ½ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾")

        # Ğ•ÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ñ‹, Ñ‚ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²
        if videos:
            test_video = videos[0]
            print(f"ğŸ”„ Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ°Ğ´Ñ€Ğ¾Ğ² Ğ¸Ğ·: {os.path.basename(test_video)}")

            frames = extractor.extract_frames(test_video, 3)
            print(f"âœ… Ğ£ÑĞ¿ĞµÑˆĞ½Ğ¾ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¾ {len(frames)} ĞºĞ°Ğ´Ñ€Ğ¾Ğ²")
        else:
            print("â„¹ï¸ Ğ’Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ° Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ñ‹")

        return True

    except Exception as e:
        print(f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ² Ğ±Ğ°Ğ·Ğ¾Ğ²Ğ¾Ğ¹ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸: {e}")
        return False


def test_algorithms_separately():
    """Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµÑ‚ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ñ‹ Ğ¿Ğ¾ Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸"""
    print("\nğŸ§ª Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ñ‹ Ğ¿Ğ¾ Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸...")

    setup_imports()

    try:
        from algorithms.histogram_comparator import HistogramComparator
        from algorithms.phash_comparator import PHashComparator

        print("âœ… ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ñ‹ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ñ‹ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾")

        # Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğµ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ
        import cv2
        import numpy as np

        # ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ğµ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğµ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ 1
        img1 = np.ones((100, 100, 3), dtype=np.uint8) * 255  # Ğ‘ĞµĞ»Ñ‹Ğ¹ ĞºĞ²Ğ°Ğ´Ñ€Ğ°Ñ‚

        # ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ğµ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğµ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ 2
        img2 = np.ones((100, 100, 3), dtype=np.uint8) * 128  # Ğ¡ĞµÑ€Ñ‹Ğ¹ ĞºĞ²Ğ°Ğ´Ñ€Ğ°Ñ‚

        # Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ³Ğ¸ÑÑ‚Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹
        hist_comp = HistogramComparator()
        hist_score = hist_comp.compare(img1, img2)
        print(f"âœ… HistogramComparator: ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ = {hist_score:.2%}")

        # Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ pHash
        phash_comp = PHashComparator()
        phash_score = phash_comp.compare(img1, img2)
        print(f"âœ… PHashComparator: ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ = {phash_score:.2%}")

        return True

    except Exception as e:
        print(f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ² Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ°Ñ…: {e}")
        return False


def test_video_comparator_directly():
    """ĞŸÑ€ÑĞ¼Ğ¾Ğµ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ VideoComparator"""
    print("\nğŸ§ª ĞŸÑ€ÑĞ¼Ğ¾Ğµ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ VideoComparator...")

    setup_imports()

    try:
        # ĞŸÑ€ÑĞ¼Ğ¾Ğ¹ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚ Ñ Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¼ Ğ¿ÑƒÑ‚ĞµĞ¼
        import src.core.video_comparator as vc_module
        comparator = vc_module.VideoComparator()
        print("âœ… VideoComparator ÑĞ¾Ğ·Ğ´Ğ°Ğ½ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾!")
        return True

    except Exception as e:
        print(f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ² VideoComparator: {e}")

        # ĞŸÑ€Ğ¾Ğ±ÑƒĞµĞ¼ Ğ°Ğ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ ÑĞ¿Ğ¾ÑĞ¾Ğ±
        try:
            from src.core.video_comparator import VideoComparator
            comparator = VideoComparator()
            print("âœ… VideoComparator ÑĞ¾Ğ·Ğ´Ğ°Ğ½ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ (Ğ°Ğ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ ÑĞ¿Ğ¾ÑĞ¾Ğ±)!")
            return True
        except Exception as e2:
            print(f"âŒ ĞĞ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ ÑĞ¿Ğ¾ÑĞ¾Ğ± Ñ‚Ğ¾Ğ¶Ğµ Ğ½Ğµ ÑÑ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ»: {e2}")
            return False


if __name__ == "__main__":
    print("ğŸ¬ VideoDuplicate Cleaner - ĞšĞ¾Ğ¼Ğ¿Ğ»ĞµĞºÑĞ½Ñ‹Ğ¹ Ñ‚ĞµÑÑ‚")
    print("=" * 60)

    results = []

    results.append(("Ğ‘Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ", test_basic_functionality()))
    results.append(("ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ñ‹ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ", test_algorithms_separately()))
    results.append(("VideoComparator", test_video_comparator_directly()))

    print("\n" + "=" * 60)
    print("ğŸ“Š Ğ˜Ğ¢ĞĞ“Ğ˜ Ğ¢Ğ•Ğ¡Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ¯:")

    all_passed = True
    for test_name, passed in results:
        status = "âœ… ĞŸĞ ĞĞ™Ğ”Ğ•Ğ" if passed else "âŒ ĞĞ• ĞŸĞ ĞĞ™Ğ”Ğ•Ğ"
        print(f"  {test_name}: {status}")
        if not passed:
            all_passed = False

    if all_passed:
        print("\nğŸ‰ Ğ’Ğ¡Ğ• Ğ¢Ğ•Ğ¡Ğ¢Ğ« ĞŸĞ ĞĞ™Ğ”Ğ•ĞĞ« Ğ£Ğ¡ĞŸĞ•Ğ¨ĞĞ!")
    else:
        print("\nğŸ’¥ ĞĞ•ĞšĞĞ¢ĞĞ Ğ«Ğ• Ğ¢Ğ•Ğ¡Ğ¢Ğ« ĞĞ• ĞŸĞ ĞĞ™Ğ”Ğ•ĞĞ«!")

        print("\nğŸ”§ Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ¾ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ:")
        print("1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñƒ Ğ¿Ğ°Ğ¿Ğ¾Ğº Ğ¸ Ñ„Ğ°Ğ¹Ğ»Ñ‹ __init__.py")
        print("2. Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ĞµÑÑŒ, Ñ‡Ñ‚Ğ¾ Ğ²ÑĞµ Ñ„Ğ°Ğ¹Ğ»Ñ‹ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‚")
        print("3. ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ PyCharm")
        print("4. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ, Ñ‡Ñ‚Ğ¾ Ğ² Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°Ñ… Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ° Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ ÑƒĞºĞ°Ğ·Ğ°Ğ½ Python interpreter")


test_output\stress_test.py

import os
import sys
import threading
import time

# ĞĞ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ¿ÑƒÑ‚Ğ¸
current_dir = os.path.dirname(os.path.abspath(__file__))
src_path = os.path.join(current_dir, 'src')
sys.path.insert(0, src_path)


def stress_test():
    """Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµÑ‚ ÑÑ‚Ğ°Ğ±Ğ¸Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Ğ¿Ñ€Ğ¸ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ĞºÑ€Ğ°Ñ‚Ğ½Ğ¾Ğ¼ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğ¸ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²"""
    print("ğŸ”¥ Ğ—ĞĞŸĞ£Ğ¡Ğš Ğ¡Ğ¢Ğ Ğ•Ğ¡Ğ¡-Ğ¢Ğ•Ğ¡Ğ¢Ğ")
    print("=" * 50)

    from src.core.frame_extractor import FrameExtractor
    from src.algorithms.comparison_manager import ComparisonManager

    extractor = FrameExtractor()
    comparator = ComparisonManager()

    test_video = input("Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿ÑƒÑ‚ÑŒ Ğº Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ¼Ñƒ Ğ²Ğ¸Ğ´ĞµĞ¾: ").strip('"\'')

    if not os.path.exists(test_video):
        print("âŒ Ğ¢ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹ Ñ„Ğ°Ğ¹Ğ» Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½")
        return

    print(f"ğŸ” Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ 10 ĞºĞ°Ğ´Ñ€Ğ¾Ğ² (10 Ñ†Ğ¸ĞºĞ»Ğ¾Ğ²)...")

    for i in range(10):
        print(f"Ğ¦Ğ¸ĞºĞ» {i + 1}/10...")
        try:
            # Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµĞ¼ ĞºĞ°Ğ´Ñ€Ñ‹
            frames = extractor.extract_frames(test_video, 10)
            print(f"  âœ… Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¾ {len(frames)} ĞºĞ°Ğ´Ñ€Ğ¾Ğ²")

            # Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ ĞºĞ°Ğ´Ñ€Ñ‹
            if len(frames) >= 2:
                result = comparator.compare_images(frames[0], frames[1])
                print(f"  âœ… Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¾: {result.get('overall', 0):.3f}")

            # Ğ˜Ğ¼Ğ¸Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñƒ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ°
            time.sleep(0.5)

        except Exception as e:
            print(f"  âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ² Ñ†Ğ¸ĞºĞ»Ğµ {i + 1}: {e}")
            break

    print("ğŸ‰ Ğ¡Ñ‚Ñ€ĞµÑÑ-Ñ‚ĞµÑÑ‚ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½!")


if __name__ == "__main__":
    stress_test()


test_output\test_comparison.py

import os
import sys

# ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ Ğ¿ÑƒÑ‚ÑŒ Ğº src
current_dir = os.path.dirname(os.path.abspath(__file__))
src_path = os.path.join(current_dir, 'src')
sys.path.insert(0, src_path)

try:
    # Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ°Ğ±ÑĞ¾Ğ»ÑÑ‚Ğ½Ñ‹Ğµ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ñ‹ Ñ‡ĞµÑ€ĞµĞ· Ğ¿Ğ°ĞºĞµÑ‚ src
    from src.core.video_comparator import VideoComparator
    from src.core.file_scanner import FileScanner

    print("âœ… Ğ˜Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ñ‹ ÑƒÑĞ¿ĞµÑˆĞ½Ñ‹!")
except ImportError as e:
    print(f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ°: {e}")
    print("ğŸ”„ ĞŸÑ€Ğ¾Ğ±ÑƒĞµĞ¼ Ğ°Ğ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ ÑĞ¿Ğ¾ÑĞ¾Ğ± Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ°...")

    # ĞĞ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ ÑĞ¿Ğ¾ÑĞ¾Ğ±
    try:
        from core.video_comparator import VideoComparator
        from core.file_scanner import FileScanner

        print("âœ… Ğ˜Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ñ‹ ÑƒÑĞ¿ĞµÑˆĞ½Ñ‹ (Ğ°Ğ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ ÑĞ¿Ğ¾ÑĞ¾Ğ±)!")
    except ImportError as e2:
        print(f"âŒ ĞĞ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚ Ñ‚Ğ¾Ğ¶Ğµ Ğ½Ğµ ÑÑ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ»: {e2}")
        sys.exit(1)


def test_video_comparison():
    """Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµÑ‚ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²"""
    print("ğŸ¬ Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ğ²Ğ¸Ğ´ĞµĞ¾")

    # Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ ĞºĞ¾Ğ¼Ğ¿Ğ°Ñ€Ğ°Ñ‚Ğ¾Ñ€
    comparator = VideoComparator()

    # ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ¿ÑƒÑ‚Ğ¸ Ğº Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğ¼ Ğ²Ğ¸Ğ´ĞµĞ¾
    print("\n=== ĞŸĞ•Ğ Ğ’ĞĞ• Ğ’Ğ˜Ğ”Ğ•Ğ ===")
    video1 = input("Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿ÑƒÑ‚ÑŒ Ğº Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¼Ñƒ Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ñƒ: ").strip('"\'')

    if not os.path.exists(video1):
        print("âŒ ĞŸĞµÑ€Ğ²Ñ‹Ğ¹ Ñ„Ğ°Ğ¹Ğ» Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½!")
        return

    print("\n=== Ğ’Ğ¢ĞĞ ĞĞ• Ğ’Ğ˜Ğ”Ğ•Ğ ===")
    video2 = input("Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿ÑƒÑ‚ÑŒ ĞºĞ¾ Ğ²Ñ‚Ğ¾Ñ€Ğ¾Ğ¼Ñƒ Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ñƒ: ").strip('"\'')

    if not os.path.exists(video2):
        print("âŒ Ğ’Ñ‚Ğ¾Ñ€Ğ¾Ğ¹ Ñ„Ğ°Ğ¹Ğ» Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½!")
        return

    print(f"\nğŸ”„ Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼:\n  1. {os.path.basename(video1)}\n  2. {os.path.basename(video2)}")

    # Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ²Ğ¸Ğ´ĞµĞ¾
    result = comparator.compare_videos(video1, video2)

    # Ğ’Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ğ¼ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹
    print("\nğŸ“Š Ğ Ğ•Ğ—Ğ£Ğ›Ğ¬Ğ¢ĞĞ¢Ğ« Ğ¡Ğ ĞĞ’ĞĞ•ĞĞ˜Ğ¯:")
    print(f"ğŸ¯ ĞĞ±Ñ‰Ğ°Ñ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ: {result['similarity']:.2%}")

    if 'error' in result:
        print(f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ°: {result['error']}")
        return

    print(f"ğŸ“¹ Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¾ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²: {result['frames_extracted']['video1']} Ğ¸ {result['frames_extracted']['video2']}")

    print("\nğŸ” Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ¿Ğ¾ ĞºĞ°Ğ´Ñ€Ğ°Ğ¼:")
    for i, comparison in enumerate(result['frame_comparisons']):
        print(f"  ĞšĞ°Ğ´Ñ€ {i + 1}: ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ {comparison['similarity']:.2%}")
        for algo_name, algo_score in comparison['algorithm_details'].items():
            if algo_name != 'overall':
                print(f"    - {algo_name}: {algo_score:.2%}")

    print(f"\nâš–ï¸ Ğ’ĞµÑĞ° Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ¾Ğ²:")
    for algo_name, weight in result['algorithm_weights'].items():
        print(f"  - {algo_name}: {weight:.0%}")


def test_multiple_videos():
    """Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¿Ğ¾Ğ¸ÑĞº Ğ¿Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ñ… Ğ²Ğ¸Ğ´ĞµĞ¾ Ğ² Ğ¿Ğ°Ğ¿ĞºĞµ"""
    print("\nğŸ” Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾Ğ¸ÑĞºĞ° Ğ¿Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ñ… Ğ²Ğ¸Ğ´ĞµĞ¾ Ğ² Ğ¿Ğ°Ğ¿ĞºĞµ")

    folder = input("Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿ÑƒÑ‚ÑŒ Ğº Ğ¿Ğ°Ğ¿ĞºĞµ Ñ Ğ²Ğ¸Ğ´ĞµĞ¾: ").strip('"\'')

    if not os.path.exists(folder):
        print("âŒ ĞŸĞ°Ğ¿ĞºĞ° Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ°!")
        return

    scanner = FileScanner()
    video_files = scanner.find_video_files(folder)

    if not video_files:
        print("âŒ Ğ’ Ğ¿Ğ°Ğ¿ĞºĞµ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²!")
        return

    print(f"ğŸ“ ĞĞ°Ğ¹Ğ´ĞµĞ½Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²: {len(video_files)}")

    # Ğ—Ğ°Ğ¿Ñ€Ğ°ÑˆĞ¸Ğ²Ğ°ĞµĞ¼ Ğ¿Ğ¾Ñ€Ğ¾Ğ³ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸
    try:
        threshold = float(input("Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿Ğ¾Ñ€Ğ¾Ğ³ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸ (0.1-1.0, Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ 0.7): ") or "0.7")
        threshold = max(0.1, min(1.0, threshold))
    except:
        threshold = 0.7

    print(f"ğŸ¯ ĞŸĞ¾Ñ€Ğ¾Ğ³ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸: {threshold:.0%}")

    # Ğ˜Ñ‰ĞµĞ¼ Ğ¿Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ğµ Ğ²Ğ¸Ğ´ĞµĞ¾
    comparator = VideoComparator()
    similar_pairs = comparator.find_similar_videos(video_files, threshold)

    print(f"\nğŸ“Š ĞĞĞ™Ğ”Ğ•ĞĞ ĞŸĞĞ¥ĞĞ–Ğ˜Ğ¥ ĞŸĞĞ : {len(similar_pairs)}")

    for i, (video1, video2, similarity, details) in enumerate(similar_pairs):
        print(f"\n{i + 1}. {os.path.basename(video1)} <-> {os.path.basename(video2)}")
        print(f"   Ğ¡Ñ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ: {similarity:.2%}")
        print(f"   Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸: {len(details['frame_comparisons'])} ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğ¹ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²")


if __name__ == "__main__":
    print("ğŸ¬ VideoDuplicate Cleaner - Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ¾Ğ² ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ")

    while True:
        print("\n" + "=" * 50)
        print("Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ñ‚Ğ¸Ğ¿ Ñ‚ĞµÑÑ‚Ğ°:")
        print("1 - Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ñ‚ÑŒ Ğ´Ğ²Ğ° ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ñ‹Ñ… Ğ²Ğ¸Ğ´ĞµĞ¾")
        print("2 - ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ¿Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ğµ Ğ²Ğ¸Ğ´ĞµĞ¾ Ğ² Ğ¿Ğ°Ğ¿ĞºĞµ")
        print("q - Ğ’Ñ‹Ñ…Ğ¾Ğ´")
        print("=" * 50)

        choice = input("Ğ’Ğ°Ñˆ Ğ²Ñ‹Ğ±Ğ¾Ñ€: ").strip()

        if choice == '1':
            test_video_comparison()
        elif choice == '2':
            test_multiple_videos()
        elif choice.lower() in ['q', 'quit', 'exit']:
            print("ğŸ‘‹ Ğ”Ğ¾ ÑĞ²Ğ¸Ğ´Ğ°Ğ½Ğ¸Ñ!")
            break
        else:
            print("âŒ ĞĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€, Ğ¿Ğ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ ÑĞ½Ğ¾Ğ²Ğ°")


test_output\test_enhanced_comparison.py

import os
import sys

# ĞĞ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ¿ÑƒÑ‚Ğ¸
current_dir = os.path.dirname(os.path.abspath(__file__))
src_path = os.path.join(current_dir, 'src')
sys.path.insert(0, src_path)


def test_enhanced_features():
    """Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµÑ‚ ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ½Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ"""
    print("ğŸ§ª Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ñ Ğ¿Ñ€Ğ¾Ñ†ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸")

    # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼, Ñ‡Ñ‚Ğ¾ Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ¼Ğ¾Ğ´ÑƒĞ»Ğ¸ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€ÑƒÑÑ‚ÑÑ
    try:
        from src.gui.comparison_dialog import ComparisonDialog
        from src.algorithms.comparison_manager import ComparisonManager
        print("âœ… Ğ’ÑĞµ Ğ¼Ğ¾Ğ´ÑƒĞ»Ğ¸ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹")

        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğµ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸
        manager = ComparisonManager()
        print("âœ… ComparisonManager ÑĞ¾Ğ·Ğ´Ğ°Ğ½ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾")

        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼, Ñ‡Ñ‚Ğ¾ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ĞºĞ°Ğ´Ñ€Ğ¾Ğ² ÑƒĞ²ĞµĞ»Ğ¸Ñ‡ĞµĞ½Ğ¾ Ğ´Ğ¾ 10
        from src.core.frame_extractor import FrameExtractor
        extractor = FrameExtractor()
        print("âœ… FrameExtractor ÑĞ¾Ğ·Ğ´Ğ°Ğ½, ĞºĞ°Ğ´Ñ€Ñ‹ Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ: 10")

        return True

    except Exception as e:
        print(f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ°: {e}")
        return False


def check_frame_count():
    """ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¸Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµĞ¼Ñ‹Ñ… ĞºĞ°Ğ´Ñ€Ğ¾Ğ²"""
    print("\nğŸ” ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ° ĞºĞ°Ğ´Ñ€Ğ¾Ğ²:")

    from src.gui.comparison_dialog import FrameExtractionThread

    # Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ mock-Ğ¾Ğ±ÑŠĞµĞºÑ‚ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸
    class MockThread:
        def __init__(self):
            self.num_frames = 10

    # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼, Ñ‡Ñ‚Ğ¾ Ğ² Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ 10 ĞºĞ°Ğ´Ñ€Ğ¾Ğ²
    print("âœ… Ğ’ ComparisonDialog Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ 10 ĞºĞ°Ğ´Ñ€Ğ¾Ğ² Ğ´Ğ»Ñ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ")


if __name__ == "__main__":
    print("ğŸ¬ VideoDuplicate Cleaner - Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ½Ñ‹Ñ… Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¹")
    print("=" * 60)

    if test_enhanced_features():
        check_frame_count()
        print("\nğŸ‰ Ğ’ÑĞµ ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‚ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾!")
        print("\nğŸ“‹ Ğ§Ñ‚Ğ¾ Ğ±Ñ‹Ğ»Ğ¾ ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ¾:")
        print("   â€¢ ĞšĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ³Ñ€ÑƒĞ¿Ğ¿ Ñ‚ĞµĞ¿ĞµÑ€ÑŒ Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ÑÑ‚ ÑÑ€ĞµĞ´Ğ½ÑÑ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ")
        print("   â€¢ Ğ’ side-by-side ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğ¸ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶Ğ°ĞµÑ‚ÑÑ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ ĞºĞ°Ğ´Ñ€Ğ°")
        print("   â€¢ Ğ£Ğ²ĞµĞ»Ğ¸Ñ‡ĞµĞ½Ğ¾ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ÑÑ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼Ñ‹Ñ… ĞºĞ°Ğ´Ñ€Ğ¾Ğ² Ñ 3 Ğ´Ğ¾ 10")
        print("   â€¢ Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ° Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ğ½Ğ¾Ğ¼ĞµÑ€Ğµ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ³Ğ¾ ĞºĞ°Ğ´Ñ€Ğ°")
    else:
        print("\nğŸ’¥ Ğ¢Ñ€ĞµĞ±ÑƒÑÑ‚ÑÑ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ!")


test_output\test_frame_extraction.py

import os
import sys

# Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ src Ğ² Ğ¿ÑƒÑ‚ÑŒ Ğ´Ğ»Ñ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ°
sys.path.append(os.path.join(os.path.dirname(__file__), 'src'))

from core.frame_extractor import FrameExtractor


def get_video_path_from_user():
    """ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ Ğ¿ÑƒÑ‚ÑŒ Ğº Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ñƒ Ğ¾Ñ‚ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ°Ğ¼Ğ¸"""
    while True:
        print("\n" + "=" * 50)
        print("Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿ÑƒÑ‚ÑŒ Ğº Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ñƒ Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ")
        print("ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµĞ¼Ñ‹Ğµ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ñ‹: .mp4, .avi, .mov, .mkv, .wmv")
        print("Ğ˜Ğ»Ğ¸ Ğ²Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ 'q' Ğ´Ğ»Ñ Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ°")
        print("=" * 50)

        user_input = input("ĞŸÑƒÑ‚ÑŒ Ğº Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ñƒ: ").strip()

        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ğ½Ğµ Ñ…Ğ¾Ñ‡ĞµÑ‚ Ğ»Ğ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ²Ñ‹Ğ¹Ñ‚Ğ¸
        if user_input.lower() in ['q', 'quit', 'exit']:
            return None

        # ĞÑ‡Ğ¸Ñ‰Ğ°ĞµĞ¼ Ğ¿ÑƒÑ‚ÑŒ Ğ¾Ñ‚ ĞºĞ°Ğ²Ñ‹Ñ‡ĞµĞº ĞµÑĞ»Ğ¸ Ğ¾Ğ½Ğ¸ ĞµÑÑ‚ÑŒ
        cleaned_path = user_input.strip('"\'')

        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ»Ğ¸ Ñ„Ğ°Ğ¹Ğ»
        if not os.path.exists(cleaned_path):
            print(f"âŒ ĞĞ¨Ğ˜Ğ‘ĞšĞ: Ğ¤Ğ°Ğ¹Ğ» Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½: {cleaned_path}")
            print("ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ:")
            print("1. ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ Ğ»Ğ¸ ÑƒĞºĞ°Ğ·Ğ°Ğ½ Ğ¿ÑƒÑ‚ÑŒ")
            print("2. Ğ¡ÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ»Ğ¸ Ñ„Ğ°Ğ¹Ğ»")
            print("3. ĞĞµÑ‚ Ğ»Ğ¸ Ğ¾Ğ¿ĞµÑ‡Ğ°Ñ‚Ğ¾Ğº Ğ² Ğ¸Ğ¼ĞµĞ½Ğ¸ Ñ„Ğ°Ğ¹Ğ»Ğ°")
            continue

        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ñ‡Ñ‚Ğ¾ ÑÑ‚Ğ¾ Ñ„Ğ°Ğ¹Ğ», Ğ° Ğ½Ğµ Ğ¿Ğ°Ğ¿ĞºĞ°
        if not os.path.isfile(cleaned_path):
            print(f"âŒ ĞĞ¨Ğ˜Ğ‘ĞšĞ: Ğ­Ñ‚Ğ¾ Ğ¿Ğ°Ğ¿ĞºĞ°, Ğ° Ğ½Ğµ Ñ„Ğ°Ğ¹Ğ»: {cleaned_path}")
            continue

        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ğµ Ñ„Ğ°Ğ¹Ğ»Ğ°
        file_ext = os.path.splitext(cleaned_path)[1].lower()
        supported_formats = {'.mp4', '.avi', '.mov', '.mkv', '.wmv'}

        if file_ext not in supported_formats:
            print(f"âŒ ĞĞ¨Ğ˜Ğ‘ĞšĞ: ĞĞµĞ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµĞ¼Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚: {file_ext}")
            print(f"âœ… ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµĞ¼Ñ‹Ğµ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ñ‹: {', '.join(supported_formats)}")
            continue

        # Ğ’ÑĞµ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ¿Ñ€Ğ¾Ğ¹Ğ´ĞµĞ½Ñ‹
        print(f"âœ… Ğ¤Ğ°Ğ¹Ğ» Ğ½Ğ°Ğ¹Ğ´ĞµĞ½: {cleaned_path}")
        return cleaned_path


def suggest_common_locations():
    """ĞŸÑ€ĞµĞ´Ğ»Ğ°Ğ³Ğ°ĞµÑ‚ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ğµ Ğ¼ĞµÑÑ‚Ğ° Ğ¿Ğ¾Ğ¸ÑĞºĞ° Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²"""
    common_locations = [
        os.path.expanduser("~/Videos"),
        os.path.expanduser("~/Downloads"),
        "D:/",
        "C:/Users/Public/Videos",
        "C:/Videos",
    ]

    print("\nğŸ’¡ Ğ¡Ğ¾Ğ²ĞµÑ‚: Ğ¿Ğ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ Ğ¿Ğ¾Ğ¸ÑĞºĞ°Ñ‚ÑŒ Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ² ÑÑ‚Ğ¸Ñ… Ğ¿Ğ°Ğ¿ĞºĞ°Ñ…:")
    for location in common_locations:
        if os.path.exists(location):
            print(f"   ğŸ“ {location}")


def test_frame_extraction():
    """ĞÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ñ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²"""
    print("ğŸ¬ VideoDuplicate Cleaner - Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ñ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²")

    # Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ ÑĞºĞ·ĞµĞ¼Ğ¿Ğ»ÑÑ€ FrameExtractor
    extractor = FrameExtractor()

    # ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ¿ÑƒÑ‚ÑŒ Ğ¾Ñ‚ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
    video_path = get_video_path_from_user()

    if not video_path:
        print("ğŸ‘‹ Ğ’Ñ‹Ñ…Ğ¾Ğ´ Ğ¸Ğ· Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹.")
        suggest_common_locations()
        return

    try:
        # ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾
        print("\nğŸ“Š ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾...")
        video_info = extractor.get_video_info(video_path)

        if not video_info:
            print("âŒ ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğµ")
            print("Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¸Ñ‡Ğ¸Ğ½Ñ‹:")
            print("1. Ğ¤Ğ°Ğ¹Ğ» Ğ¿Ğ¾Ğ²Ñ€ĞµĞ¶Ğ´ĞµĞ½")
            print("2. ĞĞµĞ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµĞ¼Ñ‹Ğ¹ ĞºĞ¾Ğ´ĞµĞº")
            print("3. ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ Ğ¿Ñ€Ğ°Ğ² Ğ´Ğ»Ñ Ñ‡Ñ‚ĞµĞ½Ğ¸Ñ Ñ„Ğ°Ğ¹Ğ»Ğ°")
            return

        # Ğ’Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ğ¼ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾
        print("âœ… Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾:")
        print(f"   ğŸ“ Ğ Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ: {video_info.get('width')}x{video_info.get('height')}")
        print(f"   â±ï¸ Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ: {video_info.get('duration', 0):.1f} ÑĞµĞºÑƒĞ½Ğ´")
        print(f"   ğŸï¸ FPS: {video_info.get('fps', 0):.1f}")
        print(f"   ğŸ–¼ï¸ Ğ’ÑĞµĞ³Ğ¾ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²: {video_info.get('total_frames', 0)}")

        # Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµĞ¼ ĞºĞ°Ğ´Ñ€Ñ‹
        print("\nğŸ¯ Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµĞ¼ 10 ĞºĞ°Ğ´Ñ€Ğ¾Ğ²...")
        frames = extractor.extract_frames(video_path, 10)

        print(f"âœ… Ğ£ÑĞ¿ĞµÑˆĞ½Ğ¾ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¾ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²: {len(frames)}")

        if frames:
            # ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¼ ĞºĞ°Ğ´Ñ€Ğµ
            first_frame = frames[0]
            print(f"ğŸ“ Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾ ĞºĞ°Ğ´Ñ€Ğ°: {first_frame.shape}")

            # ĞŸÑ€ĞµĞ´Ğ»Ğ°Ğ³Ğ°ĞµĞ¼ ÑĞ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ ĞºĞ°Ğ´Ñ€Ñ‹
            print("\nğŸ’¾ Ğ¥Ğ¾Ñ‚Ğ¸Ñ‚Ğµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ½Ñ‹Ğµ ĞºĞ°Ğ´Ñ€Ñ‹ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸?")
            save_choice = input("Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ ĞºĞ°Ğ´Ñ€Ñ‹ Ğ² Ğ¿Ğ°Ğ¿ĞºÑƒ 'test_output'? (y/n): ").strip().lower()

            if save_choice == 'y':
                os.makedirs('', exist_ok=True)
                saved_paths = extractor.extract_and_save_frames(video_path, 'test_output', 10)
                print(f"âœ… Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¾ {len(saved_paths)} ĞºĞ°Ğ´Ñ€Ğ¾Ğ² Ğ² Ğ¿Ğ°Ğ¿ĞºÑƒ 'test_output'")
                print("ğŸ“ Ğ’Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ¿Ğ°Ğ¿ĞºÑƒ 'test_output' Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¿Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ½Ñ‹Ğµ ĞºĞ°Ğ´Ñ€Ñ‹")

            # ĞŸÑ€ĞµĞ´Ğ»Ğ°Ğ³Ğ°ĞµĞ¼ Ğ¿Ñ€Ğ¾Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¹ Ñ„Ğ°Ğ¹Ğ»
            print("\nğŸ”„ Ğ¥Ğ¾Ñ‚Ğ¸Ñ‚Ğµ Ğ¿Ñ€Ğ¾Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¹ Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»?")
            another_test = input("ĞŸÑ€Ğ¾Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¹ Ñ„Ğ°Ğ¹Ğ»? (y/n): ").strip().lower()
            if another_test == 'y':
                test_frame_extraction()
            else:
                print("ğŸ‰ Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¾!")
        else:
            print("âŒ ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ÑŒ Ğ½Ğ¸ Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ°Ğ´Ñ€Ğ°")
            suggest_common_locations()

    except Exception as e:
        print(f"ğŸ’¥ ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ¾ÑˆĞ»Ğ° Ğ½ĞµĞ¿Ñ€ĞµĞ´Ğ²Ğ¸Ğ´ĞµĞ½Ğ½Ğ°Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°: {e}")
        print("ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, ÑĞ¾Ğ¾Ğ±Ñ‰Ğ¸Ñ‚Ğµ Ğ¾Ğ± ÑÑ‚Ğ¾Ğ¹ Ğ¾ÑˆĞ¸Ğ±ĞºĞµ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ°Ğ¼")


def quick_test():
    """Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ñ‚ĞµÑÑ‚ Ñ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ğ¾Ğ¼ Ğ¿ÑƒÑ‚Ğ¸ (Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸)"""
    print("\nâš¡ Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ñ‚ĞµÑÑ‚ (Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¾Ğ²)")

    # ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¿ÑƒÑ‚Ğ¸ - Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾ Ñ€Ğ°ÑĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸
    # test_path = r"D:\example\test_video.mp4"

    # ĞĞ¾ Ğ»ÑƒÑ‡ÑˆĞµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ Ğ²Ğ²Ğ¾Ğ´
    test_path = input("Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹ Ğ¿ÑƒÑ‚ÑŒ: ").strip('"\'')

    if test_path and os.path.exists(test_path):
        extractor = FrameExtractor()
        frames = extractor.extract_frames(test_path, 3)
        print(f"Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¾ {len(frames)} ĞºĞ°Ğ´Ñ€Ğ¾Ğ²")
    else:
        print("Ğ¤Ğ°Ğ¹Ğ» Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½")


if __name__ == "__main__":
    # ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ Ñ‚ĞµÑÑ‚
    test_frame_extraction()


test_output\test_imports.py

"""
ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ğ¹ Ñ‚ĞµÑÑ‚ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¾Ğ²
"""
import os
import sys

def test_imports():
    print("ğŸ§ª Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¾Ğ²...")

    # Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ src Ğ² Ğ¿ÑƒÑ‚ÑŒ
    current_dir = os.path.dirname(os.path.abspath(__file__))
    src_path = os.path.join(current_dir, 'src')
    sys.path.insert(0, src_path)

    tests = [
        ("core", "FileScanner"),
        ("core", "FrameExtractor"),
        ("core", "VideoComparator"),
        ("algorithms", "BaseComparator"),
        ("algorithms", "HistogramComparator"),
        ("algorithms", "PHashComparator"),
        ("algorithms", "ComparisonManager"),
    ]

    all_passed = True

    for package_name, class_name in tests:
        try:
            # Ğ˜Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ²ĞµÑÑŒ Ğ¿Ğ°ĞºĞµÑ‚
            module = __import__(package_name, fromlist=[class_name])
            # ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ ĞºĞ»Ğ°ÑÑ Ğ¸Ğ· Ğ¼Ğ¾Ğ´ÑƒĞ»Ñ
            cls = getattr(module, class_name)
            # ĞŸÑ€Ğ¾Ğ±ÑƒĞµĞ¼ ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ÑĞºĞ·ĞµĞ¼Ğ¿Ğ»ÑÑ€ (ĞºÑ€Ğ¾Ğ¼Ğµ BaseComparator, Ñ‚Ğ°Ğº ĞºĞ°Ğº Ğ¾Ğ½ Ğ°Ğ±ÑÑ‚Ñ€Ğ°ĞºÑ‚Ğ½Ñ‹Ğ¹)
            if class_name != "BaseComparator":
                instance = cls()
                print(f"âœ… {package_name}.{class_name} - Ğ£Ğ¡ĞŸĞ•Ğ¥ (ÑĞ¾Ğ·Ğ´Ğ°Ğ½ ÑĞºĞ·ĞµĞ¼Ğ¿Ğ»ÑÑ€)")
            else:
                print(f"âœ… {package_name}.{class_name} - Ğ£Ğ¡ĞŸĞ•Ğ¥ (Ğ°Ğ±ÑÑ‚Ñ€Ğ°ĞºÑ‚Ğ½Ñ‹Ğ¹ ĞºĞ»Ğ°ÑÑ)")
        except Exception as e:
            print(f"âŒ {package_name}.{class_name} - ĞĞ¨Ğ˜Ğ‘ĞšĞ: {e}")
            all_passed = False

    if all_passed:
        print("\nğŸ‰ Ğ’ÑĞµ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ñ‹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‚ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾!")
    else:
        print("\nğŸ’¥ ĞĞµĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ñ‹ Ğ½Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‚!")

    return all_passed

if __name__ == "__main__":
    test_imports()


test_output\test_optimized_comparison.py

import os
import sys
import time

# ĞĞ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ¿ÑƒÑ‚Ğ¸
current_dir = os.path.dirname(os.path.abspath(__file__))
src_path = os.path.join(current_dir, 'src')
sys.path.insert(0, src_path)

from core.optimized_comparator import OptimizedVideoComparator
from core.file_scanner import FileScanner


def test_optimized_comparison():
    """Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½ÑƒÑ Ğ²ĞµÑ€ÑĞ¸Ñ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ"""
    print("ğŸš€ Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ĞĞŸĞ¢Ğ˜ĞœĞ˜Ğ—Ğ˜Ğ ĞĞ’ĞĞĞĞĞ™ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ")

    # Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ ĞºĞ¾Ğ¼Ğ¿Ğ°Ñ€Ğ°Ñ‚Ğ¾Ñ€
    comparator = OptimizedVideoComparator()

    # ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ¿Ğ°Ğ¿ĞºÑƒ Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
    folder = input("Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿ÑƒÑ‚ÑŒ Ğº Ğ¿Ğ°Ğ¿ĞºĞµ Ñ Ğ²Ğ¸Ğ´ĞµĞ¾: ").strip('"\'')

    if not os.path.exists(folder):
        print("âŒ ĞŸĞ°Ğ¿ĞºĞ° Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ°!")
        return

    scanner = FileScanner()
    video_files = scanner.find_video_files(folder)

    if not video_files:
        print("âŒ Ğ’ Ğ¿Ğ°Ğ¿ĞºĞµ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²!")
        return

    print(f"ğŸ“ ĞĞ°Ğ¹Ğ´ĞµĞ½Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²: {len(video_files)}")

    # Ğ—Ğ°Ğ¿Ñ€Ğ°ÑˆĞ¸Ğ²Ğ°ĞµĞ¼ Ğ¿Ğ¾Ñ€Ğ¾Ğ³ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸
    try:
        threshold = float(input("Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿Ğ¾Ñ€Ğ¾Ğ³ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸ (0.1-1.0, Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ 0.7): ") or "0.7")
        threshold = max(0.1, min(1.0, threshold))
    except:
        threshold = 0.7

    print(f"ğŸ¯ ĞŸĞ¾Ñ€Ğ¾Ğ³ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸: {threshold:.0%}")
    print("â±ï¸ Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº...")

    start_time = time.time()

    # Ğ˜Ñ‰ĞµĞ¼ Ğ¿Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ğµ Ğ²Ğ¸Ğ´ĞµĞ¾
    similar_pairs = comparator.find_similar_videos_optimized(video_files, threshold)

    end_time = time.time()
    execution_time = end_time - start_time

    print(f"\nâœ… ĞŸĞ¾Ğ¸ÑĞº Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½ Ğ·Ğ° {execution_time:.1f} ÑĞµĞºÑƒĞ½Ğ´")
    print(f"ğŸ“Š ĞĞ°Ğ¹Ğ´ĞµĞ½Ğ¾ Ğ¿Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ñ… Ğ¿Ğ°Ñ€: {len(similar_pairs)}")

    for i, (video1, video2, similarity, details) in enumerate(similar_pairs):
        print(f"\n{i + 1}. {os.path.basename(video1)} <-> {os.path.basename(video2)}")
        print(f"   Ğ¡Ñ…Ğ¾Ğ¶ĞµÑÑ‚ÑŒ: {similarity:.2%}")

        if 'type' in details:
            print(f"   Ğ¢Ğ¸Ğ¿: {details['type']}")
        else:
            print(f"   Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸: {len(details['frame_comparisons'])} ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğ¹ ĞºĞ°Ğ´Ñ€Ğ¾Ğ²")


def compare_with_old_version():
    """Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ ÑĞ¾ ÑÑ‚Ğ°Ñ€Ğ¾Ğ¹ Ğ²ĞµÑ€ÑĞ¸ĞµĞ¹"""
    print("\nğŸ” Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸")

    from core.video_comparator import VideoComparator

    folder = input("Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿ÑƒÑ‚ÑŒ Ğº Ğ¿Ğ°Ğ¿ĞºĞµ Ñ Ğ²Ğ¸Ğ´ĞµĞ¾ (Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ°): ").strip('"\'')

    if not os.path.exists(folder):
        print("âŒ ĞŸĞ°Ğ¿ĞºĞ° Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ°!")
        return

    scanner = FileScanner()
    video_files = scanner.find_video_files(folder)

    if len(video_files) > 20:
        print(f"âš ï¸ Ğ¡Ğ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² ({len(video_files)}). Ğ‘ĞµÑ€ĞµĞ¼ Ğ¿ĞµÑ€Ğ²Ñ‹Ğµ 20 Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ°.")
        video_files = video_files[:20]

    print(f"ğŸ“ Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ½Ğ° {len(video_files)} Ñ„Ğ°Ğ¹Ğ»Ğ°Ñ…")

    # Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ ÑÑ‚Ğ°Ñ€ÑƒÑ Ğ²ĞµÑ€ÑĞ¸Ñ
    print("\nğŸ§ª Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¡Ğ¢ĞĞ Ğ£Ğ® Ğ²ĞµÑ€ÑĞ¸Ñ...")
    old_comparator = VideoComparator()
    start_time = time.time()
    old_results = old_comparator.find_similar_videos(video_files, 0.7)
    old_time = time.time() - start_time

    print(f"â±ï¸ Ğ¡Ñ‚Ğ°Ñ€Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ: {old_time:.1f} ÑĞµĞº, Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾ Ğ¿Ğ°Ñ€: {len(old_results)}")

    # Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ½Ğ¾Ğ²ÑƒÑ Ğ²ĞµÑ€ÑĞ¸Ñ
    print("\nğŸ§ª Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ ĞĞĞ’Ğ£Ğ® Ğ²ĞµÑ€ÑĞ¸Ñ...")
    new_comparator = OptimizedVideoComparator()
    start_time = time.time()
    new_results = new_comparator.find_similar_videos_optimized(video_files, 0.7)
    new_time = time.time() - start_time

    print(f"â±ï¸ ĞĞ¾Ğ²Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ: {new_time:.1f} ÑĞµĞº, Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾ Ğ¿Ğ°Ñ€: {len(new_results)}")

    print(f"\nğŸ“ˆ Ğ£ÑĞºĞ¾Ñ€ĞµĞ½Ğ¸Ğµ: {old_time / new_time:.1f}x")

    # Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹
    old_pairs = set((min(v1, v2), max(v1, v2)) for v1, v2, _, _ in old_results)
    new_pairs = set((min(v1, v2), max(v1, v2)) for v1, v2, _, _ in new_results)

    common_pairs = old_pairs & new_pairs
    only_old = old_pairs - new_pairs
    only_new = new_pairs - old_pairs

    print(f"\nğŸ“Š Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²:")
    print(f"  ĞĞ±Ñ‰Ğ¸Ğµ Ğ¿Ğ°Ñ€Ñ‹: {len(common_pairs)}")
    print(f"  Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ² ÑÑ‚Ğ°Ñ€Ğ¾Ğ¹ Ğ²ĞµÑ€ÑĞ¸Ğ¸: {len(only_old)}")
    print(f"  Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ² Ğ½Ğ¾Ğ²Ğ¾Ğ¹ Ğ²ĞµÑ€ÑĞ¸Ğ¸: {len(only_new)}")


if __name__ == "__main__":
    print("ğŸ¬ VideoDuplicate Cleaner - ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğµ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ")

    while True:
        print("\n" + "=" * 50)
        print("Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ñ‚Ğ¸Ğ¿ Ñ‚ĞµÑÑ‚Ğ°:")
        print("1 - ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº Ğ² Ğ¿Ğ°Ğ¿ĞºĞµ")
        print("2 - Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ ÑÑ‚Ğ°Ñ€Ğ¾Ğ¹ Ğ¸ Ğ½Ğ¾Ğ²Ğ¾Ğ¹ Ğ²ĞµÑ€ÑĞ¸Ğ¸")
        print("q - Ğ’Ñ‹Ñ…Ğ¾Ğ´")
        print("=" * 50)

        choice = input("Ğ’Ğ°Ñˆ Ğ²Ñ‹Ğ±Ğ¾Ñ€: ").strip()

        if choice == '1':
            test_optimized_comparison()
        elif choice == '2':
            compare_with_old_version()
        elif choice.lower() in ['q', 'quit', 'exit']:
            print("ğŸ‘‹ Ğ”Ğ¾ ÑĞ²Ğ¸Ğ´Ğ°Ğ½Ğ¸Ñ!")
            break
        else:
            print("âŒ ĞĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€, Ğ¿Ğ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ ÑĞ½Ğ¾Ğ²Ğ°")


test_output\test_side_by_side.py

import os
import sys

# ĞĞ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ¿ÑƒÑ‚Ğ¸
current_dir = os.path.dirname(os.path.abspath(__file__))
src_path = os.path.join(current_dir, 'src')
sys.path.insert(0, src_path)

from src.gui.comparison_dialog import ComparisonDialog
from PyQt6.QtWidgets import QApplication


def test_side_by_side():
    """Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµÑ‚ side-by-side ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ"""
    app = QApplication(sys.argv)

    print("ğŸ¬ Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Side-by-Side ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ")

    # Ğ—Ğ°Ğ¿Ñ€Ğ°ÑˆĞ¸Ğ²Ğ°ĞµĞ¼ Ğ¿ÑƒÑ‚Ğ¸ Ğº Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ğ°Ğ¼
    video1 = input("Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿ÑƒÑ‚ÑŒ Ğº Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¼Ñƒ Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ñƒ: ").strip('"\'')
    video2 = input("Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿ÑƒÑ‚ÑŒ ĞºĞ¾ Ğ²Ñ‚Ğ¾Ñ€Ğ¾Ğ¼Ñƒ Ğ²Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ»Ñƒ: ").strip('"\'')

    if not os.path.exists(video1) or not os.path.exists(video2):
        print("âŒ ĞĞ´Ğ¸Ğ½ Ğ¸Ğ· Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½!")
        return

    # Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ¸ Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ
    dialog = ComparisonDialog([video1, video2])
    dialog.show()

    print("âœ… Ğ”Ğ¸Ğ°Ğ»Ğ¾Ğ³ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚. Ğ—Ğ°ĞºÑ€Ğ¾Ğ¹Ñ‚Ğµ ĞµĞ³Ğ¾ Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ñ‚ÑŒ Ñ‚ĞµÑÑ‚.")

    app.exec()


if __name__ == "__main__":
    test_side_by_side()


utils\__init__.py




utils\memory_monitor.py

import psutil
import os
import gc


class MemoryMonitor:
    """ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸"""

    @staticmethod
    def get_memory_usage():
        """Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸ Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ğ¼ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ¼ Ğ² MB"""
        process = psutil.Process(os.getpid())
        return process.memory_info().rss / 1024 / 1024

    @staticmethod
    def log_memory_usage(label=""):
        """Ğ›Ğ¾Ğ³Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸"""
        usage = MemoryMonitor.get_memory_usage()
        print(f"ğŸ§  Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸ {label}: {usage:.2f} MB")

    @staticmethod
    def force_cleanup():
        """ĞŸÑ€Ğ¸Ğ½ÑƒĞ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ° Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸"""
        gc.collect()
        print("ğŸ§¹ Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ° Ğ¿Ñ€Ğ¸Ğ½ÑƒĞ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ° Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸")


__pycache__\__init__.cpython-313.pyc

Ñƒ
    Ñi    Ğ³                   Ñƒ   â€¢ g )NÂ© r   Ñƒ    Ğª?F:\Programs\PythonProject\VideoDuplicateCleaner\src\__init__.pyĞª<module>r      s   Ñr   


